(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){

require('./main.css');
const createWebPlayer = require('@securebroadcast/sbtwebplayer');
const SESSION_KEY='SESSION_ID';
var currentTimeInVideo = 0;
var urlParameters = "";
var localData = "";
var projectDuration;
var isFirstPLay = false;

//const baseUrl = "http://localhost:3000/dev/";
const baseUrl =  "https://1y0yuxp5wc.execute-api.eu-west-1.amazonaws.com/prod/";
// const baseUrl = "https://api.vml.technology/uat/";

//MARK: Networking
const callService = async (url, options, method, body) => {

    headers = {};
    headers['Authorization'] = getVariableFromLocalStorage(SESSION_KEY);
    headers['X-Host-Domain'] = (window.location != window.parent.location) ? document.referrer : document.location.href;

    try {
        return await fetch(url, {
        method: method,
        options,
        body: body,
        headers
        });
    } catch (e) {
        rg4js('send', 'callService: ' + e);
    }
};

const parseJson = async response => {

    try {
        return response.json()
    } catch (e) {
        rg4js('send', 'parseJson: ' + e);
    }

    return {};
};

//MARK: API Requests

const getVML = async (url, options, body) => {
    const response = await callService(url, options, 'GET', body);
    const json = await parseJson(response);
    setVariableInLocalStorage(SESSION_KEY, json.session);
    projectDuration = json.duration;
    delete json.session;
    return json;
};


const logAnalytics = async(event, timeInVideo, metaData) => {

    var projectId = getProjectID()
    var url = baseUrl + "analytics/"

    var body = {
        projectId: projectId,
        event:event,
        player_time: timeInVideo,
        meta_data: metaData
    };

    webkit.messageHandlers.appCallback.postMessage(JSON.stringify(body));
    const response = await callService(url, null, 'POST', JSON.stringify(body));
    const json = await parseJson(response);
    setVariableInLocalStorage(SESSION_KEY, json.session);
};

//MARK: URL Helpers

function getProjectID() {
    var vars = {};

    // local data parameter takes precidence
    if (this.localData.vml_id != undefined) {
        return this.localData.vml_id;
    }

    // Host window parameter used as a backup if not passed in with local data
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    if (vars.id != undefined) {
        return vars.id;
    }

    return vars.id;
}

function getParametersFromUrl() {
    var url;
    if (window.location.href.includes('?')) {
        url = window.location.href + "&" + this.urlParameters;
    } else {
        url = window.location.href + "?" + this.urlParameters;
    }

    // There are no URL parameters
    if (!url.includes("?")) {
        return "";
    }

    var urlParameters = url.substring(url.indexOf("?"));
    return urlParameters;
}

//MARK: Session helpers

function getVariableFromLocalStorage(key) {
   return window.localStorage.getItem(key);
}

function setVariableInLocalStorage(key, value) {
    window.localStorage.setItem(key, value);
}

//MARK: Player callback functions

function onPlay(currentTime) {
    currentTimeInVideo = currentTime;
    if (!isFirstPLay) {
        logAnalytics("PLAY_CLICK", currentTime, null);
        isFirstPLay = true;
    }
}

function onPause(currentTime) {
    currentTimeInVideo = currentTime;
    logAnalytics("PAUSE_CLICK", currentTime, null);
}

function onProgress(currentTime) {
    currentTimeInVideo = currentTime;
    var currentPercent = (currentTimeInVideo / projectDuration) * 100;
    logAnalytics("PLAYING", currentPercent, null);
}

function onFullScreenToggle(isFullScreen) {
    if (isFullScreen) {
        logAnalytics("FULL_SCREEN_ON", currentTimeInVideo, null);
    } else {
        logAnalytics("FULL_SCREEN_OFF", currentTimeInVideo, null);
    }
}

function onVideoEnd() {
    logAnalytics("COMPLETE", currentTimeInVideo, null);
}

function onReady(totalDuration) {
    logAnalytics("READY", 0.0, null);
}

function onElementClicked(id, clickTime) {
    logAnalytics("ELEMENT_CLICKED", clickTime, id);
}


// The ID sent to the VML service can come from the host window or the parent window (if embedded in iFrame)
// The host window takes precidence over the parent window. If there is no ID in the host, we look at the parent
// All of the parents URL paramenters are sent to the VML service (not host as this is built to be embedded in sites as an iframe)
// The main usecase for this service to look at the parent window for the ID and not the iFrame is so we can dynamically set the video to be displayed
// The most common use case is for the host (iFrame) to contain the ID and have its data personalised from the host url parameters


const getService = async ({ url, options }) => getVML(baseUrl + "vml/" + getProjectID() + getParametersFromUrl(), { options, method: 'GET' });

window.initPlayer = function(initData) {
    
    this.urlParameters = initData.urlParameters
    this.localData = initData.localData

    createWebPlayer({
        attachTo: "video",
        service: getService,
        projectId: 1,
        onPlay: onPlay,
        onPause: onPause,
        onFullScreenToggle: onFullScreenToggle,
        onVideoEnd: onVideoEnd,
        progressInterval: 3,
        onReady: onReady,
        onProgress: onProgress,
        onElementClicked: onElementClicked,
        data: initData.localData,
    })
};


},{"./main.css":2,"@securebroadcast/sbtwebplayer":3}],2:[function(require,module,exports){
var css = ".webplayer-styles_videoContainer__2mHcM,\n.webplayer-styles_videoLayerElementContainer__1t0PF {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  max-width: 100%;\n  max-height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  overflow: hidden;\n}\n.webplayer-styles_videoLayerElementContainer__1t0PF {\n  z-index: 98;\n}\n.styles_root__2yUun {\n  position: relative;\n  background-color: #000;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  user-select: none;\n  width: 100%;\n  height: 100%;\n}\n.styles_fullScreen__2Bof3 {\n  top: 0!important;\n  left: 0!important;\n  position: absolute!important;\n  width: 100%!important;\n  height: 100%!important;\n  z-index: 200;\n}\n.fake_fullscreen {\n  bottom: 0!important;\n  right: 0!important;\n  top: 0!important;\n  left: 0!important;\n  position: fixed!important;\n}\n.styles_sizer__a4fA6 {\n  width: 100%;\n  height: 100%;\n}\n.styles_fullScreen__23imI {\n  position: absolute!important;\n  height: 100%!important;\n  width: 100%!important;\n}\n.styles_video__16wgh::-webkit-media-controls {\n  display: none!important;\n}\n.styles_root__Doaxf {\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  overflow: hidden;\n  position: absolute;\n  z-index: 200;\n}\n.styles_img__2kLAC {\n  width: 100%;\n}\n.styles_root__2UBKF {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 500;\n}\n.styles_root__2UBKF.styles_controlsShowing__2XUFE {\n  z-index: 200;\n}\n.styles_root__1n21M {\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n  position: absolute;\n  z-index: 400;\n}\n.styles_overlay__1vhIs {\n  z-index: 150;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  color: #000;\n  opacity: .4;\n}\n.styles_root__1n21M.styles_mobile__11Clo {\n  height: 50%;\n  margin-top: 45px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n  -ms-flex-pack: justify;\n  justify-content: space-between;\n}\n.styles_left__30H9O {\n  height: 100%;\n  width: 20%;\n  float: left;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  -webkit-appearance: none;\n}\n.styles_root__1n21M.styles_mobile__11Clo .styles_left__30H9O {\n  float: none;\n}\n.styles_centre__BIiDC {\n  height: 100%;\n  width: 60%;\n  float: left;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  -webkit-appearance: none;\n  position: relative;\n}\n.styles_root__1n21M.styles_mobile__11Clo .styles_centre__BIiDC {\n  float: none;\n}\n.styles_right__PJId5 {\n  height: 100%;\n  width: 20%;\n  float: left;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n  -webkit-appearance: none;\n}\n.styles_root__1n21M.styles_mobile__11Clo .styles_right__PJId5 {\n  float: none;\n}\n.styles_root__2SYF6 {\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  background: -webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(1%,transparent),color-stop(17%,transparent),to(rgba(0,0,0,.4)));\n  background: linear-gradient(180deg,transparent 0,transparent 1%,transparent 17%,rgba(0,0,0,.4));\n  z-index: 260;\n}\n.styles_invisible__2uK5s {\n  display: none;\n}\n.styles_root__2SYF6.styles_mobile__2-r9_ {\n  top: 0;\n  width: 100%;\n  height: 100%;\n}\n.styles_root2__2BK34 {\n  left: 0;\n  bottom: 0;\n  right: 0;\n  top: 0;\n  padding-bottom: 4px;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n.styles_root2__2BK34.styles_mobile__2-r9_ {\n  width: 100%;\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: column;\n  flex-direction: column;\n}\n.styles_inner__UEWWh,\n.styles_root2__2BK34.styles_mobile__2-r9_ {\n  -webkit-box-pack: justify;\n  -ms-flex-pack: justify;\n  justify-content: space-between;\n}\n.styles_inner__UEWWh {\n  display: -webkit-inline-box;\n  display: -ms-inline-flexbox;\n  display: inline-flex;\n  margin-left: 4px;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  padding-left: 12px;\n  padding-right: 24px;\n}\n.styles_display__3_RB0 {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n.styles_mobileControlsRow__2sEeM {\n  text-align: right;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n}\n.styles_mobileProgressBarArea__131Uk {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.styles_fadeIn__3k3S4 {\n  -webkit-animation: styles_fadeIn__3k3S4 .3s linear forwards;\n  animation: styles_fadeIn__3k3S4 .3s linear forwards;\n}\n@-webkit-keyframes styles_fadeIn__3k3S4 {\n  0% {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n    z-index: 262;\n  }\n}\n@keyframes styles_fadeIn__3k3S4 {\n  0% {\n    opacity: 0;\n  }\n\n  to {\n    opacity: 1;\n    z-index: 262;\n  }\n}\n.styles_fadeOut__2jZKR {\n  -webkit-animation: styles_fadeOut__2jZKR .3s linear forwards;\n  animation: styles_fadeOut__2jZKR .3s linear forwards;\n}\n@-webkit-keyframes styles_fadeOut__2jZKR {\n  0% {\n    opacity: 1;\n  }\n\n  to {\n    opacity: 0;\n    z-index: 260;\n  }\n}\n@keyframes styles_fadeOut__2jZKR {\n  0% {\n    opacity: 1;\n  }\n\n  to {\n    opacity: 0;\n    z-index: 260;\n  }\n}\n.styles_root__1CWL- {\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  top: 0;\n  display: none;\n  z-index: 200;\n}\n.styles_visible__2g5qd {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n}\n.styles_errorMessage__3eiyc {\n  background-color: #fff;\n  color: #000;\n  padding: 10px;\n  border-radius: 5px;\n}\n.styles_root__33X8H {\n  display: none;\n  background-color: transparent;\n  background-image: -webkit-gradient(linear,left bottom,left top,color-stop(24%,transparent),color-stop(25%,hsla(0,0%,100%,.5)),color-stop(26%,hsla(0,0%,100%,.5)),color-stop(27%,transparent),color-stop(74%,transparent),color-stop(75%,hsla(0,0%,100%,.5)),color-stop(76%,hsla(0,0%,100%,.5)),color-stop(77%,transparent),to(transparent)),-webkit-gradient(linear,left top,right top,color-stop(24%,transparent),color-stop(29%,hsla(0,0%,100%,.5)),color-stop(26%,hsla(0,0%,100%,.05)),color-stop(27%,transparent),color-stop(74%,transparent),color-stop(75%,hsla(0,0%,100%,.5)),color-stop(76%,hsla(0,0%,100%,.5)),color-stop(77%,transparent),to(transparent));\n  background-image: linear-gradient(0deg,transparent 24%,hsla(0,0%,100%,.5) 25%,hsla(0,0%,100%,.5) 26%,transparent 27%,transparent 74%,hsla(0,0%,100%,.5) 75%,hsla(0,0%,100%,.5) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,hsla(0,0%,100%,.5) 29%,hsla(0,0%,100%,.05) 0,transparent 27%,transparent 74%,hsla(0,0%,100%,.5) 75%,hsla(0,0%,100%,.5) 76%,transparent 77%,transparent);\n  z-index: 199;\n}\n.styles_root__33X8H,\n.styles_root__34iVl {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.styles_root__34iVl {\n  background: #000;\n  opacity: .4;\n  z-index: 250;\n}\n.styles_root__2ku8q {\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  position: absolute;\n  pointer-events: none;\n  z-index: 201;\n}\n.styles_root__vQYBO {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.styles_root__vQYBO.styles_noPointer__1UOqn {\n  pointer-events: none;\n  z-index: auto;\n}\n.styles_root__Vfmc2 {\n  font-size: 30px;\n  color: #fff;\n  background: #000;\n  -ms-flex-pack: distribute;\n  justify-content: space-around;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n  -ms-flex-direction: row;\n  flex-direction: row;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  width: 100px;\n  height: 100px;\n  border-radius: 50%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  opacity: 0;\n  position: absolute;\n}\n.styles_fadeInAndOut__1rjqp {\n  -webkit-animation: styles_fadeInOut__3r7Nz .6s linear forwards;\n  animation: styles_fadeInOut__3r7Nz .6s linear forwards;\n}\n@-webkit-keyframes styles_fadeInOut__3r7Nz {\n  0% {\n    -webkit-transform: scale(.5);\n    transform: scale(.5);\n    opacity: 0;\n  }\n\n  55% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n\n  to {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n}\n@keyframes styles_fadeInOut__3r7Nz {\n  0% {\n    -webkit-transform: scale(.5);\n    transform: scale(.5);\n    opacity: 0;\n  }\n\n  55% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n\n  to {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n}\n.styles_fadeInDelayed__39F41 {\n  -webkit-animation: styles_fadeInDelayed__39F41 .8s linear forwards;\n  animation: styles_fadeInDelayed__39F41 .8s linear forwards;\n}\n@-webkit-keyframes styles_fadeInDelayed__39F41 {\n  0% {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n\n  50% {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n\n  to {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n}\n@keyframes styles_fadeInDelayed__39F41 {\n  0% {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n\n  50% {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n\n  to {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n}\n.styles_fadeIn__1ORSm {\n  -webkit-animation: styles_fadeIn__1ORSm .3s linear forwards;\n  animation: styles_fadeIn__1ORSm .3s linear forwards;\n}\n@-webkit-keyframes styles_fadeIn__1ORSm {\n  0% {\n    -webkit-transform: scale(.5);\n    transform: scale(.5);\n    opacity: 0;\n  }\n\n  to {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n}\n@keyframes styles_fadeIn__1ORSm {\n  0% {\n    -webkit-transform: scale(.5);\n    transform: scale(.5);\n    opacity: 0;\n  }\n\n  to {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n}\n.styles_fadeOut__ucpjX {\n  -webkit-animation: styles_fadeOut__ucpjX .3s linear forwards;\n  animation: styles_fadeOut__ucpjX .3s linear forwards;\n}\n@-webkit-keyframes styles_fadeOut__ucpjX {\n  0% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n\n  to {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n}\n@keyframes styles_fadeOut__ucpjX {\n  0% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n    opacity: .5;\n  }\n\n  to {\n    -webkit-transform: scale(1.5);\n    transform: scale(1.5);\n    opacity: 0;\n  }\n}\n.styles_root__3qXyw {\n  background-color: rgba(0,0,0,.5);\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  height: 100%;\n  width: 100%;\n  position: absolute;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n  -ms-flex-pack: center;\n  justify-content: center;\n}\n.styles_spinner__ZW4uJ {\n  width: 50px;\n  height: 40px;\n  text-align: center;\n  font-size: 10px;\n  -ms-flex-item-align: center;\n  align-self: center;\n}\n.styles_spinner__ZW4uJ>div {\n  background-color: #fff;\n  height: 100%;\n  width: 6px;\n  margin: 0 1px 0 0;\n  display: inline-block;\n  -webkit-animation: styles_sk-stretchdelay__2XTHN 1.2s ease-in-out infinite;\n  animation: styles_sk-stretchdelay__2XTHN 1.2s ease-in-out infinite;\n}\n.styles_spinner__ZW4uJ .styles_rect2__2KUBX {\n  -webkit-animation-delay: -1.1s;\n  animation-delay: -1.1s;\n}\n.styles_spinner__ZW4uJ .styles_rect3__3d1iK {\n  -webkit-animation-delay: -1s;\n  animation-delay: -1s;\n}\n.styles_spinner__ZW4uJ .styles_rect4__39qQA {\n  -webkit-animation-delay: -.9s;\n  animation-delay: -.9s;\n}\n.styles_spinner__ZW4uJ .styles_rect5__O38zr {\n  -webkit-animation-delay: -.8s;\n  animation-delay: -.8s;\n}\n@-webkit-keyframes styles_sk-stretchdelay__2XTHN {\n  0%, 40%, to {\n    -webkit-transform: scaleY(.4);\n    transform: scaleY(.4);\n  }\n\n  20% {\n    -webkit-transform: scaleY(1);\n    transform: scaleY(1);\n  }\n}\n@keyframes styles_sk-stretchdelay__2XTHN {\n  0%, 40%, to {\n    -webkit-transform: scaleY(.4);\n    transform: scaleY(.4);\n  }\n\n  20% {\n    -webkit-transform: scaleY(1);\n    transform: scaleY(1);\n  }\n}\n.styles_handle__342EU {\n  position: absolute;\n  padding: 0;\n  background-color: #fff;\n  height: 10px;\n  width: 10px;\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  border-radius: 50%;\n  bottom: -3px;\n  margin-left: -4px;\n  -webkit-box-shadow: 1px 1px 8px #444;\n  box-shadow: 1px 1px 8px #444;\n  opacity: 1;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  z-index: 200;\n  cursor: pointer;\n}\n.styles_handle__342EU:hover,\n.styles_handleHover__13ddH {\n  height: 15px;\n  width: 15px;\n  bottom: -5px;\n  margin-left: -7px;\n  cursor: pointer;\n}\n.styles_innerProgressBar__17mj_ {\n  background-color: #c4a571;\n  width: 0;\n  bottom: 0;\n  border-top-left-radius: 2px;\n  border-bottom-left-radius: 2px;\n  height: 100%;\n}\n.styles_innerProgressBar__17mj_,\n.styles_progressBar__3NvWY {\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  z-index: 200;\n}\n.styles_progressBar__3NvWY {\n  background-color: #798da5;\n  height: 4px;\n  position: relative;\n  margin-left: 15px;\n  margin-right: 20px;\n  margin-bottom: 32px;\n  border-radius: 4px;\n  cursor: pointer;\n}\n.styles_progressBar__3NvWY.styles_mobile__3J9BG {\n  margin-bottom: 0;\n}\n.styles_progressBarContainer__1x6ob {\n  padding-bottom: 10px;\n}\n.styles_progressBarContainer__1x6ob.styles_mobile__3J9BG {\n  padding-top: 20px;\n  padding-left: 10px;\n  padding-right: 10px;\n}\n.styles_progressBarContainer__1x6ob:hover .styles_progressBar__3NvWY {\n  height: 6px;\n  margin-bottom: 31px;\n}\n.styles_progressBarContainer__1x6ob:hover .styles_progressBar__3NvWY.styles_mobile__3J9BG {\n  margin-bottom: 5px;\n}\n.styles_progressBarHover__xIS4R .styles_progressBar__3NvWY {\n  height: 6px;\n  margin-bottom: 31px;\n}\n.styles_progressBarHover__xIS4R .styles_progressBar__3NvWY.styles_mobile__3J9BG {\n  margin-bottom: 5px;\n}\n.styles_progressBarContainer__1x6ob:hover .styles_progressBar__3NvWY :nth-child(2) {\n  height: 15px;\n  width: 15px;\n  bottom: -5px;\n  margin-left: -7px;\n}\n.styles_root__2Kbw9 {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  margin: 0;\n  padding: 0;\n  background: 0;\n  color: #e6e6e6;\n  border: 0;\n  height: 44px;\n  width: 44px;\n  z-index: 200;\n}\n.styles_root__2Kbw9:hover {\n  cursor: pointer;\n}\n.styles_root__2Kbw9 img {\n  height: 17px;\n  z-index: 200;\n}\n.styles_root__2NmxH {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  margin: 0;\n  padding: 0;\n  background: none;\n  color: #e6e6e6;\n  border: 0;\n  width: 44px;\n  height: 44px;\n  z-index: 200;\n}\n.styles_root__2NmxH:hover {\n  cursor: pointer;\n}\n.styles_root__2NmxH img {\n  height: 18px;\n  z-index: 200;\n}\n.styles_root__XFMj- {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  margin: 0;\n  padding: 0;\n  background: 0;\n  color: #e6e6e6;\n  border: 0;\n  height: 44px;\n  width: 44px;\n  z-index: 200;\n}\n.styles_root__XFMj-:hover {\n  cursor: pointer;\n}\n.styles_root__XFMj- img {\n  height: 17px;\n  z-index: 200;\n}\n.styles_root__1dw90 {\n  padding-left: 10px;\n  padding-right: 10px;\n  -webkit-tap-highlight-color: transparent;\n  color: #e6e6e6;\n  font-size: 14px;\n  font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,Roboto,Arial,sans-serif;\n  display: -webkit-inline-box;\n  display: -ms-inline-flexbox;\n  display: inline-flex;\n  line-height: 40px;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  z-index: 200;\n}\n.styles_currentTime__-6Xh1 {\n  text-align: right;\n  padding-right: 3px;\n}\n.styles_duration__1FWMW {\n  text-align: right;\n  padding-left: 3px;\n}\n.styles_root__1AJvc {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  margin: 0;\n  padding: 0;\n  background: 0;\n  color: #e6e6e6;\n  border: 0;\n  height: 44px;\n  width: 44px;\n  z-index: 200;\n}\n.styles_root__1AJvc:hover {\n  cursor: pointer;\n}\n.styles_root__1AJvc img {\n  height: 17px;\n  z-index: 200;\n}\n.styles_hide__1vXoU {\n  display: none;\n}\n.styles_root__1St-T {\n  -webkit-box-sizing: border-box;\n  box-sizing: border-box;\n  width: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -ms-flex-align: center;\n  align-items: center;\n  -webkit-box-pack: justify;\n  -ms-flex-pack: justify;\n  justify-content: space-between;\n  padding-left: 20px;\n  padding-right: 30px;\n  padding-bottom: 0;\n  -webkit-tap-highlight-color: transparent;\n  color: #e6e6e6;\n  font-size: 14px;\n  font-family: -apple-system,BlinkMacSystemFont,Helvetica Neue,Roboto,Arial,sans-serif;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  z-index: 200;\n  margin-bottom: -10px;\n}\nbody {\n  background-color: black;\n}\n.videoFrame {\n  width: 100vw;\n  height: 56.25vw;\n  /* height:width ratio = 9/16 = .5625  */\n  /* background: pink; */\n  max-height: 100vh;\n  max-width: 177.78vh;\n  /* 16/9 = 1.778 */\n  margin: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  /* vertical center */\n  left: 0;\n  right: 0;\n  /* horizontal center */\n}\n"; (require("browserify-css").createStyle(css, { "href": "client/main.css" }, { "insertAt": "bottom" })); module.exports = css;
},{"browserify-css":4}],3:[function(require,module,exports){
(function (global){(function (){
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,i,n,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(i,n)}function _asyncToGenerator(o){return function(){var e=this,s=arguments;return new Promise(function(t,r){var i=o.apply(e,s);function n(e){asyncGeneratorStep(i,t,r,n,a,"next",e)}function a(e){asyncGeneratorStep(i,t,r,n,a,"throw",e)}n(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,r){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return r&&_setPrototypeOf(n,r.prototype),n}).apply(null,arguments)}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],0<=t.indexOf(r)||(n[r]=e[r]);return n}function _objectWithoutProperties(e,t){if(null==e)return{};var r,i,n=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _createSuper(i){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(i);if(n){var r=_getPrototypeOf(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var i=_superPropBase(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(r):n.value}})(e,t,r||e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw a}}return r}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n,a=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,n=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw n}}}}function _initializerDefineProperty(e,t,r,i){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0})}function _applyDecoratedDescriptor(r,i,e,t,n){var a={};return Object.keys(t).forEach(function(e){a[e]=t[e]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=e.slice().reverse().reduce(function(e,t){return t(r,i,e)||e},a),n&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(n):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(r,i,a),a=null),a}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var ContentRect_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.ContentRect=function(e){if("getBBox"in e){var t=e.getBBox();return Object.freeze({height:t.height,left:0,top:0,width:t.width})}var r=window.getComputedStyle(e);return Object.freeze({height:parseFloat(r.height||"0"),left:parseFloat(r.paddingLeft||"0"),top:parseFloat(r.paddingTop||"0"),width:parseFloat(r.width||"0")})}});unwrapExports(ContentRect_1);var ContentRect_2=ContentRect_1.ContentRect,ResizeObservation_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=(Object.defineProperty(i.prototype,"broadcastWidth",{get:function(){return this.$$broadcastWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"broadcastHeight",{get:function(){return this.$$broadcastHeight},enumerable:!0,configurable:!0}),i.prototype.isActive=function(){var e=ContentRect_1.ContentRect(this.target);return!!e&&(e.width!==this.broadcastWidth||e.height!==this.broadcastHeight)},i);function i(e){this.target=e,this.$$broadcastWidth=this.$$broadcastHeight=0}t.ResizeObservation=r});unwrapExports(ResizeObservation_1);var ResizeObservation_2=ResizeObservation_1.ResizeObservation,ResizeObserverEntry_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});function r(e){this.target=e,this.contentRect=ContentRect_1.ContentRect(e)}t.ResizeObserverEntry=r});unwrapExports(ResizeObserverEntry_1);var ResizeObserverEntry_2=ResizeObserverEntry_1.ResizeObserverEntry,ResizeObserver_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=[],i=(n.prototype.observe=function(e){var t=a("observe",e);if(t)throw TypeError(t);0<s(this.$$observationTargets,e)||(this.$$observationTargets.push(new ResizeObservation_1.ResizeObservation(e)),f())},n.prototype.unobserve=function(e){var t=a("unobserve",e);if(t)throw TypeError(t);var r=s(this.$$observationTargets,e);r<0||(this.$$observationTargets.splice(r,1),p())},n.prototype.disconnect=function(){this.$$observationTargets=[],this.$$activeTargets=[]},n);function n(e){this.$$observationTargets=[],this.$$activeTargets=[],this.$$skippedTargets=[];var t=function(e){if(void 0===e)return"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.";if("function"!=typeof e)return"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function."}(e);if(t)throw TypeError(t);this.$$callback=e,r.push(this)}function a(e,t){return void 0===t?"Failed to execute '"+e+"' on 'ResizeObserver': 1 argument required, but only 0 present.":t instanceof window.Element?void 0:"Failed to execute '"+e+"' on 'ResizeObserver': parameter 1 is not of type 'Element'."}function s(e,t){for(var r=0;r<e.length;r+=1)if(e[r].target===t)return r;return-1}t.ResizeObserver=i;function o(i){r.forEach(function(r){r.$$activeTargets=[],r.$$skippedTargets=[],r.$$observationTargets.forEach(function(e){if(e.isActive()){var t=d(e.target);i<t?r.$$activeTargets.push(e):r.$$skippedTargets.push(e)}})})}function l(){var n=1/0;return r.forEach(function(e){if(e.$$activeTargets.length){var i=[];e.$$activeTargets.forEach(function(e){var t=new ResizeObserverEntry_1.ResizeObserverEntry(e.target);i.push(t),e.$$broadcastWidth=t.contentRect.width,e.$$broadcastHeight=t.contentRect.height;var r=d(e.target);r<n&&(n=r)}),e.$$callback(i,e),e.$$activeTargets=[]}}),n}function u(){var e,t=0;for(o(t);r.some(function(e){return!!e.$$activeTargets.length});)t=l(),o(t);r.some(function(e){return!!e.$$skippedTargets.length})&&(e=new window.ErrorEvent("ResizeLoopError",{message:"ResizeObserver loop completed with undelivered notifications."}),window.dispatchEvent(e))}var c,d=function(e){for(var t=0;e.parentNode;)e=e.parentNode,t+=1;return t},f=function(){c||h()},h=function(){c=window.requestAnimationFrame(function(){u(),h()})},p=function(){c&&!r.some(function(e){return!!e.$$observationTargets.length})&&(window.cancelAnimationFrame(c),c=void 0)};t.install=function(){return window.ResizeObserver=i}});unwrapExports(ResizeObserver_1);var _pointerEvents,_mouseEvents,_touchEvents,_eventTypes,ResizeObserver_2=ResizeObserver_1.ResizeObserver,ResizeObserver_3=ResizeObserver_1.install,startEvent="start",moveEvent="move",endEvent="end",mousemove="mousemove",mouseleave="mouseleave",mouseout="mouseout",pointerEvents=(_defineProperty(_pointerEvents={},startEvent,"pointerdown"),_defineProperty(_pointerEvents,moveEvent,"pointermove"),_defineProperty(_pointerEvents,endEvent,"pointerup"),_pointerEvents),mouseEvents=(_defineProperty(_mouseEvents={},startEvent,"mousedown"),_defineProperty(_mouseEvents,moveEvent,"mousemove"),_defineProperty(_mouseEvents,endEvent,"mouseup"),_mouseEvents),touchEvents=(_defineProperty(_touchEvents={},startEvent,"touchstart"),_defineProperty(_touchEvents,moveEvent,"touchmove"),_defineProperty(_touchEvents,endEvent,"touchend"),_touchEvents),eventTypes=(_defineProperty(_eventTypes={},startEvent,startEvent),_defineProperty(_eventTypes,moveEvent,moveEvent),_defineProperty(_eventTypes,endEvent,endEvent),_eventTypes),getEvents=function(e){return e in eventTypes?[mouseEvents[e],touchEvents[e]]:[e]},filterEvents=function(t){return function(e){3!==e.which&&2!==e.which&&t(e)}},applyEvents=function(t,e,r){var i=[];return e.forEach(function(e){t.addEventListener(e,r,{passive:!1}),i.push(function(){return t.removeEventListener(e,r)})}),i},addEventListeners=function(u,e){var c=[],t=Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1],a=filterEvents(n),s=getEvents(i);if(s)for(var o=applyEvents(u,s,a),l=0;l<o.length;l++)c.push(o[l]);else u.addEventListener(i,a),c.push(function(){return u.removeEventListener(i,a)});return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,a))},{});return window.addEventListener("removeAllPlayerEvents",function e(){!function(){for(var e=0;e<c.length;e++)c[e]()}(),window.removeEventListener("removeAllPlayerEvents",e)}),t},removeEvents=function(t,e,r){e.forEach(function(e){t.removeEventListener(e,r,!1)})},removeEventListeners=function(a,e){Object.entries(e).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1],n=getEvents(r);n?removeEvents(a,n,i):a.removeEventListener(r,i,!1)})},PLAYING="PLAYING",PAUSED="PAUSED",LOADING$1="LOADING",READY="READY",INITIALISING="INITIALISING",SKIPPING="SKIPPING",REWINDING="REWINDING",SEEKING="SEEKING",SEEKED="SEEKED",PLAYBACK_ERROR="PLAYBACK_ERROR",LOADING_ERROR="LOADING_ERROR",LAYER_LOADING="LAYER_LOADING",NOT_USED="NOT_USED",isSafariMobile=function(){var e=window.navigator.userAgent,t=!!e.match(/iPad/i)||!!e.match(/iPhone/i),r=!!e.match(/WebKit/i);return t&&r&&!e.match(/CriOS/i)},isMobileOrTablet=function(){return void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")},isSafari=function(){var e=window.navigator.userAgent;return e.toLowerCase().includes("safari")&&!e.toLowerCase().includes("chome")&&window.navigator.vendor.toLowerCase().includes("apple")},browserDetection={isSafariMobile:isSafariMobile(),isMobileOrTablet:isMobileOrTablet(),isSafari:isSafari()},moveEventListener=null,endEventListener=null,calculateCurrentTime=function(e,t){return e*t},getCurrentTime=function(e,t,r,i){var n,a=0;e.clientX?n=e.clientX:e.changedTouches&&(n=e.changedTouches[0].clientX);var s=n-r.offsetLeft-i;return 0<s&&(a=calculateCurrentTime(t,s/r.offsetWidth)),t<a?t:a},createMoveEvent=function(t,r,i){return function(e){e.preventDefault(),e.stopPropagation(),r.currentState===SEEKING&&(t.cancelAnimation(),t.setCurrentTime(getCurrentTime(e,r.duration,i,t.getVideoPlayerContainerOffsetLeft())))}},createUpEvent=function(o,l,u,c,d){return function(e){var t,r=l.state,i=l.duration,n=l.previousState,a=l.update;if(e.preventDefault(),e.stopPropagation(),r!==SEEKED){var s=getCurrentTime(e,i,u,o.getVideoPlayerContainerOffsetLeft());o.setCurrentTime(s),s<i&&n===PLAYING?o.play():n!==LAYER_LOADING&&a({state:d===READY?PAUSED:d})}removeEventListeners(document,(_defineProperty(t={},moveEvent,moveEventListener),_defineProperty(t,endEvent,endEventListener),t)),c()}},createControlsEventListeners=function(){return function(e){var o=e.store,l=e.playerEngine;return{container:function(){return _defineProperty({mousemove:function(){o.updateIsMouseOnControls(!0)},mouseout:function(){o.updateIsMouseOnControls(!1)}},endEvent,function(e){browserDetection.isMobileOrTablet||o.state===SEEKING||(e.preventDefault(),e.stopPropagation())})},playButton:function(){return _defineProperty({},endEvent,function(e){o.state!==LOADING$1&&(l.getActions().toggle(),o.updateIsMouseOnControls(!0)),e.preventDefault(),e.stopPropagation()})},progressBar:function(n,a,s){return _defineProperty({},startEvent,function(e){var t;if(o.controls.showControls){e.preventDefault(),e.stopPropagation();var r=o.currentState;l.getActions().cancelAnimation(),o.update({state:SEEKING});var i=addEventListeners(document,(_defineProperty(t={},moveEvent,createMoveEvent(l.getActions(),o,n)),_defineProperty(t,endEvent,createUpEvent(l.getActions(),o,n,s,r)),t));moveEventListener=i[moveEvent],endEventListener=i[endEvent],a()}})},fullScreenButton:function(){return{click:function(){l.getActions().toggleFullScreen(),o.currentState===PLAYING&&o.setShowControlsTimeout()}}},mutedButton:function(){return{click:function(){l.getActions().toggleMuted(),o.currentState===PLAYING&&o.setShowControlsTimeout()}}},subtitlesButton:function(){return{click:function(){l.getActions().toggleSubtitles(),o.currentState===PLAYING&&o.setShowControlsTimeout()}}}}}},documentElement=document,isFakeFullScreen=!1,fakeFullscreen=function(e){e.classList.add("fake_fullscreen"),isFakeFullScreen=!0},exitFakeFullscreen=function(e){isFakeFullScreen=!1,e.classList.remove("fake_fullscreen")},request=function(e,t,r){var i=2<arguments.length&&void 0!==r&&r;try{if(e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():fakeFullscreen(e),i)try{screen.orientation.lock("landscape-primary")}catch(e){}t()}catch(e){}},exit=function(e,t){documentElement.exitFullscreen?documentElement.exitFullscreen():documentElement.webkitExitFullscreen?documentElement.webkitExitFullscreen():documentElement.mozCancelFullScreen?documentElement.mozCancelFullScreen():documentElement.msExitFullscreen?documentElement.msExitFullscreen():exitFakeFullscreen(e);try{screen.orientation.lock("natural")}catch(e){}t()},isFullScreen=function(){return!!(documentElement.fullscreenElement||documentElement.webkitFullscreenElement||documentElement.mozFullScreenElement||documentElement.msFullscreenElement||isFakeFullScreen)},createFullScreenHandler=function(r,i,n){return function(e){var t=isFullScreen();t?(r.setFullScreen(),i.setFullScreen()):(r.removeFullScreen(),i.removeFullScreen()),n.updateMeasurements({isFullScreen:t})}},createGlobalEventListeners=function(){return function(e){var t=e.videoController,r=e.videoPlayerContainer,i=e.videoPlayerEngine,n=e.store,a=e.pauseOnBlur,s=void 0!==a&&a,o=e.useKeyboardEvents,l=void 0===o||o,u=createFullScreenHandler(t,r,n),c={keyup:function(e){32===e.which&&i.getActions().toggle()}},d={resize:function(){n.updateMeasurements({isFullScreen:isFullScreen()})},fullscreenchange:u,webkitfullscreenchange:u,mozfullscreenchange:u,MSFullscreenChange:u,blur:s?function(){i.getActions().pause()}:function(){}};return l?_objectSpread2(_objectSpread2({},d),c):d}},createOverlayControlsEventListeners=function(){return function(e){var t=e.store,r=e.playerEngine,i=e.controlCapabilities;return{left:{click:function(){var e=t.controls.showControls;browserDetection.isMobileOrTablet&&!e?t.setShowControlsTimeout():browserDetection.isMobileOrTablet&&e&&t.setShowControlsTimeout(1)}},centre:{click:function(){browserDetection.isMobileOrTablet&&!t.controls.showControls?t.setShowControlsTimeout():i.allowPlay?r.getActions().toggle():t.setShowControlsTimeout(1)}},right:{click:function(){var e=t.controls.showControls;browserDetection.isMobileOrTablet&&!e?t.setShowControlsTimeout():browserDetection.isMobileOrTablet&&e&&t.setShowControlsTimeout(1)}}}}},createVideoEventListeners=function(){return function(e){var t=e.store,r=e.videoPlayerEngine,i=e.onReady;return{canplay:function(e){t.state===INITIALISING&&(t.update({state:READY,isFullScreen:!1,startTime:0,currentTime:0,videoState:"SEEKED"}),t.updateMeasurements({originalVideoWidth:e.target.videoWidth,originalVideoHeight:e.target.videoHeight,isFullScreen:isFullScreen()}),i&&i({totalDuration:t.duration.toFixed(2),actions:_objectSpread2({},r.getActions())}))},resize:function(){t.updateMeasurements({isFullScreen:isFullScreen()})},seeked:function(){t.update({videoState:"SEEKED"})}}}},isElementInDOM=function(e){return document.body.contains(e)},convertStyleMapToInlineStyles=function(e,t){var r=1<arguments.length&&void 0!==t?t:{},i=Object.entries(_objectSpread2(_objectSpread2({},r),e)).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return Array.isArray(n)?"".concat(e).concat(n.map(function(e){return"".concat(i,":").concat(e,";")}).join("")):"".concat(e).concat(i,":").concat(n,";")},"");if("string"!=typeof i)throw Error("Layer styles should be a string!");return i},documentElement$1=document,createDOMElement=function(e){var t=e.elementName,r=e.styles,i=e.eventListeners,n=e.className,a=e.attributes,s=e.textContent,o=_objectWithoutProperties(e,["elementName","styles","eventListeners","className","attributes","textContent"]);if("string"===t)return documentElement$1.createTextNode(s||"");var l=documentElement$1.createElement(t);if(r&&l.setAttribute("style",convertStyleMapToInlineStyles(r)),i&&addEventListeners(l,i),n){var u=n.split(" ");0<u.length?u.forEach(function(e){return l.classList.add(e)}):l.classList.add(n)}return a&&Object.entries(a).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];l.setAttribute(r,i)}),s&&(l.textContent=s),0<Object.keys(o).length&&Object.entries(o).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];l[r]=i}),l},isErrorState=function(e){return[PLAYBACK_ERROR,LOADING_ERROR].includes(e)},mouseCoords=createDOMElement({elementName:"div"}),showMouseCoords=function(e,t){var r=t.x,i=t.y;mouseCoords.innerHTML="".concat(r,", ").concat(i),mouseCoords.setAttribute("style",convertStyleMapToInlineStyles({left:"".concat(r,"px"),top:"".concat(i+20,"px"),position:"absolute","background-color":"white",padding:"3px","border-radius":"5%"})),isElementInDOM(mouseCoords)||e.currentTarget.appendChild(mouseCoords)},removeMouseCoords=function(){isElementInDOM(mouseCoords)&&mouseCoords.remove()},createVideoPlayerContainerEventListeners=function(){return function(e){var t,r=e.store,i=e.playerEngine,n=e.disableAllControls,a=e.controlCapabilities;return _defineProperty(t={end:function(){isErrorState(r.currentState)||n||browserDetection.isMobileOrTablet||!a.allowPlay||r.currentState===LOADING$1||r.currentState===SEEKING||(i.getActions().toggle(),r.setShowControlsTimeout())}},mousemove,function(e){browserDetection.isMobileOrTablet||r.currentState===SEEKING?browserDetection.isMobileOrTablet&&(e.stopPropagation(),e.preventDefault()):(r.setShowControlsTimeout(),r.showMouseCoords&&showMouseCoords(e,{x:e.pageX-e.currentTarget.offsetLeft,y:e.pageY-e.currentTarget.offsetTop}))}),_defineProperty(t,mouseout,function(){browserDetection.isMobileOrTablet||r.setShowControlsTimeout(),r.useMouseCoords&&removeMouseCoords()}),_defineProperty(t,mouseleave,function(e){e.preventDefault(),e.stopPropagation(),r.updateIsMouseOnControls(!1),r.currentState===SEEKING&&r.update({state:SEEKED})}),t}},createLoaderEventListeners=function(){return function(e){var t=e.store;return{click:function(){t.currentState===LOADING$1&&t.previousState===PLAYING&&t.update({previousState:PAUSED})}}}},linkRequests=[],handleLinkClick=function(e,t,r){var i=e.getAttribute("data-href"),n=e.getAttribute("data-method"),a=e.getAttribute("data-params"),s=e.getAttribute("data-headers"),o=s?JSON.parse(s):void 0;if(n&&i)if("OPEN"!==n&&"LEGACY"!==n){var l={url:i,method:n};if(!linkRequests.find(function(e){return e.url===l.url&&e.method===l.method})){if(linkRequests.push(l),"GET"===n)return void fetch(i,{headers:o});if("POST"===n||"PUT"===n)return void fetch(i,{method:n,body:a,headers:o})}}else{try{t.getActions().pause(),r.setShowControlsTimeout()}catch(e){}window.open(i)}},createLinkEventListeners=function(){return function(e){var i=e.store,n=e.playerEngine,a=e.onElementClicked;return{end:function(e){if(e.stopPropagation(),e.preventDefault(),a){var t=e.currentTarget.getAttribute("data-layer-id"),r=t.slice(t.lastIndexOf(".")+1);a(r,i.currentTime)}handleLinkClick(e.currentTarget,n,i)}}}},handleTriggerEvent=function(e,t){if("click"===e.getAttribute("data-triggerevent")){var r=e.getAttribute("data-triggerstate");t.layerStates.addLayerState(r)}},createTriggerEventListeners=function(){return function(e){var i=e.store,n=e.playerEngine,a=e.onElementClicked;return{end:function(e){if(e.stopPropagation(),e.preventDefault(),a){var t=e.currentTarget.getAttribute("data-layer-id"),r=t.slice(t.lastIndexOf(".")+1);a(r,i.currentTime)}handleTriggerEvent(e.currentTarget,i),handleLinkClick(e.currentTarget,n,i)}}}},createLayerContainerEventListeners=function(){return function(e){var t=e.store;return _defineProperty({},endEvent,function(e){browserDetection.isMobileOrTablet&&!t.controls.showControls&&(e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),t.setShowControlsTimeout())})}},eventListeners=function(){return{createControlsEventListeners:createControlsEventListeners(),createWindowEventListeners:createGlobalEventListeners(),createOverlayControlsEventListeners:createOverlayControlsEventListeners(),createVideoEventListeners:createVideoEventListeners(),createVideoPlayerContainerEventListeners:createVideoPlayerContainerEventListeners(),createLoaderEventListeners:createLoaderEventListeners(),createLinkEventListeners:createLinkEventListeners(),createTriggerEventListeners:createTriggerEventListeners(),createLayerContainerEventListeners:createLayerContainerEventListeners()}},handler=function(e){return function(t){return e.some(function(e){return e(t)})}},logger=function(e){var t=e.useLogger,r=void 0!==t&&t,i=e.label,n=e.collapsed,a=void 0!==n&&n;return function(e,t){(r||window.useVideoEngineLogger)&&(a?console.groupCollapsed("".concat(i," - ").concat(e)):console.group("".concat(i," - ").concat(e)),console.log(t),console.groupEnd())}},hasHandled=!0,hasNotHandled=!1,handlePlayFromEnd=function(e){var o=e.logger,l=e.videoController,u=e.store,c=e.animation,d=e.update;return function(e){var t=e.currentTime,r=e.duration,i=e.isVideoInTimeRange,n=e.isVideoReady,a=e.hasVideo;if(r<=t){if(o("handlePlayFromEnd",{currentTime:t,duration:r,isVideoInTimeRange:i,isVideoReady:n}),a&&r<=t&&l.setCurrentTime(0),a&&i)l.playVideo().then(function(e){u.update({state:PLAYING,currentTime:e,startTime:Date.now()-1e3*e}),c.continueAnimation(d)});else{var s=r<=t?0:t;u.update({state:PLAYING,currentTime:s,startTime:Date.now()-1e3*s}),c.startAnimation(d)}return hasHandled}return hasNotHandled}},adjustStateTimes=function(e,t){var r=e+t;return{currentTime:r,startTime:Date.now()-1e3*r}},handlePlayVideo=function(e){var a=e.logger,s=e.videoController,o=e.store,l=e.animation,u=e.update;return function(e){var r=e.currentTime,i=e.videoStartOffsetTime,t=e.isVideoInTimeRange,n=e.isVideoReady;return t&&n&&s.playVideo().then(function(e){var t=adjustStateTimes(e,i);return o.update(_objectSpread2({state:PLAYING},t)),a("handlePlayVideo",{currentTime:r,videoStartOffsetTime:i,adjustedStateTimes:t}),l.startAnimation(u),hasHandled}),hasNotHandled}},handlePlayLoadingVideo=function(e){var i=e.logger,n=e.store,a=e.animation,s=e.update;return function(e){var t=e.isVideoInTimeRange,r=e.isVideoReady;return t&&!r?(n.update({state:LOADING$1}),i("handlePlayLoadingVideo",{isVideoInTimeRange:t,isVideoReady:r}),a.startAnimation(s),hasHandled):hasNotHandled}},handlePlayWithoutVideo=function(e){var a=e.logger,s=e.store,o=e.animation,l=e.update;return function(e){var t=e.state,r=e.currentTime,i=e.isVideoInTimeRange;if(i||t===LAYER_LOADING)return hasNotHandled;var n=Date.now()-1e3*r;return a("handlePlayWithoutVideo",{currentTime:r,startTime:n,isVideoInTimeRange:i}),s.update({state:PLAYING,startTime:n}),o.startAnimation(l),hasHandled}},createPlay=function(e){var a=e.onPlay,s=e.videoController,o=e.store,t=e.animation,r=e.update,i=e.useLogger,n=logger({useLogger:i,label:"VideoPlayerEngine - play"}),l=null,u=!1;return l={videoController:s,store:o,animation:t,update:r,logger:n},function(){var e=o.currentState,t=o.currentTime,r=o.duration,i=o.videoStartOffsetTime;if(e!==INITIALISING&&e!==LOADING$1&&e!==PLAYING){var n=Promise.resolve();(e===READY&&0<i||!u)&&(n=s.preloadVideo(),u=!0),n.then(function(){a(o.currentTime>=o.duration?0:o.currentTime),handler([handlePlayFromEnd(l),handlePlayVideo(l),handlePlayLoadingVideo(l),handlePlayWithoutVideo(l)])(_objectSpread2({currentState:e,currentTime:t,duration:r,videoStartOffsetTime:i},s.getVideoData(t)))})}o.setShowControlsTimeout()}},handleAutoLoop=function(e){var o=e.logger,l=e.animation,u=e.store,c=e.videoController,d=e.update;return function(e){var t=e.autoLoop,r=e.duration,i=e.currentTime,n=e.hasVideo,a=e.isVideoInTimeRange;if(t&&r<=i){if(o("handleAutoLoop",{autoLoop:t,duration:r,currentTime:i}),n&&r<=i&&c.setCurrentTime(0),n&&a)c.playVideo().then(function(e){u.update({state:PLAYING,currentTime:e,startTime:Date.now()-1e3*e}),l.continueAnimation(d)});else{var s=r<=i?0:i;u.update({state:PLAYING,currentTime:s,startTime:Date.now()-1e3*s}),l.startAnimation(d)}return hasHandled}return hasNotHandled}},handleFinished=function(e){var i=e.logger,n=e.store,a=e.videoController;return function(e){var t=e.currentTime,r=e.duration;return r<=t?(i("handleFinished",{currentTime:t,duration:r}),a.pauseVideo(),n.update({state:PAUSED,currentTime:r}),a.onVideoEnd(),hasHandled):hasNotHandled}},handleLoadingState=function(e){var s=e.videoController,o=e.store,l=e.animation,u=e.update,c=e.logger;return function(e){var t=e.isVideoReady,r=e.isVideoInTimeRange,i=e.currentTime,n=e.state;if(t||!r||n===SEEKING||n===LAYER_LOADING)return t||r||n===PLAYING?hasNotHandled:(l.continueAnimation(u),hasHandled);var a=Date.now()-1e3*i;return c("handleLoadingState",{isVideoReady:t,isVideoInTimeRange:r,startTime:a}),s.pauseVideo(),s.setCurrentTime(i),o.setLoadingStartTime(),o.update({state:LOADING$1,startTime:a}),l.continueAnimation(u),hasHandled}},handlePlayVideo$1=function(e){var l=e.store,t=e.videoController,u=e.logger,c=e.animation,d=e.update;return function(e){var r=e.isVideoInTimeRange,i=e.isVideoPlaying,n=e.isVideoReady,a=e.videoStartOffsetTime,s=e.state,o=e.hasVideoEnded;return!i&&r&&n&&s===PLAYING&&!o?(t.playVideo().then(function(e){var t=adjustStateTimes(e,a);u("handlePlayVideo",_objectSpread2({isVideoPlaying:i,isVideoInTimeRange:r,isVideoReady:n,state:s,hasVideoEnded:o},t)),l.update(_objectSpread2({state:PLAYING},t)),c.continueAnimation(d)}),hasHandled):hasNotHandled}},handlePlayVideoAfterLoading=function(e){var o=e.videoController,l=e.logger,u=e.store,c=e.animation,d=e.update;return function(e){e.currentTime;var r=e.isVideoInTimeRange,i=e.isVideoPlaying,n=e.isVideoReady,a=e.videoStartOffsetTime,s=e.state,t=e.previousState;return!i&&r&&n&&s!==PAUSED&&s!==SEEKING&&s!==LAYER_LOADING&&s===LOADING$1&&t!==PAUSED&&t!==SEEKING?(o.playVideo().then(function(e){var t=adjustStateTimes(e,a);l("handlePlayVideoAfterLoading",_objectSpread2({isVideoPlaying:i,isVideoInTimeRange:r,isVideoReady:n,state:s},t)),u.update(_objectSpread2({state:PLAYING},t)),c.continueAnimation(d)}),hasHandled):r&&i&&!n||t!==PAUSED&&t!==SEEKING||s!==LOADING$1?r||t!==PLAYING||s!==LOADING$1?s===LAYER_LOADING?(c.continueAnimation(d),hasHandled):hasNotHandled:(u.update({state:PLAYING}),c.continueAnimation(d),hasHandled):(u.update({state:t===PAUSED?PAUSED:PLAYING}),c.continueAnimation(d),hasHandled)}},handlePlayingState=function(e){var o=e.store,l=e.logger,u=e.animation,c=e.update;return function(e){var t=e.state,r=e.videoCurrentTime,i=e.videoStartOffsetTime,n=e.isVideoPlaying,a=e.startTime;if(t!==PLAYING)return hasNotHandled;var s={};return s=n?_objectSpread2({},adjustStateTimes(r,i)):{currentTime:(Date.now()-a)/1e3},o.update(s),l("handlePlayingState",_objectSpread2({state:t,isVideoPlaying:n,videoStartOffsetTime:i,startTime:a},s)),u.continueAnimation(c),hasHandled}},createUpdate=function(e){function l(e){var t=e.currentTime,r=e.duration,i=_objectWithoutProperties(e,["currentTime","duration"]);if(t<=r){d("handleCurrentTimeLessThanOrEqualDuration",{currentTime:t,duration:r});var n=t/s;return o<n&&1<n-o?(a(t),o=Math.floor(n)):n<o&&(o=0),handler([handlePlayVideoAfterLoading(f),handlePlayVideo$1(f),handleLoadingState(f),handlePlayingState(f)])(_objectSpread2({currentTime:t,duration:r},i))}return hasNotHandled}function t(){var e=c.currentTime,t=c.duration,r=c.autoLoop,i=c.state,n=c.previousState,a=c.startTime,s=c.videoStartOffsetTime,o=_objectSpread2({loadingStartTime:c.loadingStartTime,currentTime:e,startTime:a,duration:t,autoLoop:r,state:i,previousState:n,videoStartOffsetTime:s},u.getVideoData(e));d("update",o),handler([handleAutoLoop(f),handleFinished(f),l])(o)}var a=e.onProgress,s=e.progressInterval,u=e.videoController,c=e.store,r=e.animation,i=e.useLogger,d=logger({useLogger:i,label:"VideoPlayerEngine - update"}),f=null,o=0;return f={logger:d,videoController:u,store:c,animation:r,update:t},t},animation=function e(){var t=null;return{cancelAnimation:function(){return null!==t&&(cancelAnimationFrame(e),!(t=null))},startAnimation:function(e){t=requestAnimationFrame(e)},continueAnimation:function(e){t=requestAnimationFrame(e)},isAnimationRunning:function(){return null!==t},animation:t}},createVideoPlayerEngine=function(){function n(){var e=c.currentState;y(),e===PLAYING&&(c.update({state:PAUSED,startTime:Date.now()}),p.onPause(c.currentTime)),c.clearShowControlsTimeout()}function e(){(c.currentState!==PLAYING?g:n)()}function t(e,t){var r=1<arguments.length&&void 0!==t&&t;request(f.getElement(),e,r)}function r(e){exit(f.getElement(),e)}function i(){c.isFullScreen?r(function(){p.onFullScreenToggle(!1),c.updateMeasurements({isFullScreen:!1})}):t(function(){p.onFullScreenToggle(!0),c.updateMeasurements({isFullScreen:!0})},c.mobileLandscapeOnFullscreen)}function a(e){var t,r=parseFloat(e);if(0<=r&&r<c.duration){var i=c.currentState;i===PLAYING&&n(),d.setCurrentTime(e),c.update({state:(t=i)===READY?PAUSED:t,currentTime:e}),i===PLAYING&&g()}}function s(){return f.getOffsetLeft()}function o(){var e=!c.muted;c.update({muted:e}),d.setMuted(e)}function l(){var e=!c.showSubtitles;c.update({showSubtitles:e})}var u=null,c=null,d=null,f=null,h=3,p={onPlay:function(){return null},onPause:function(){return null},onFullScreenToggle:function(){return null},onProgress:function(){return null}},g=function(){},m=function(){},y=function(){c.currentState!==PAUSED&&u.isAnimationRunning()&&(u.cancelAnimation(),d.pauseVideo())};return{setProps:function(e){c=e.store,d=e.videoController,f=e.videoPlayerContainer,h=e.progressInterval,e.onPlay&&(p.onPlay=e.onPlay),e.onProgress&&(p.onProgress=e.onProgress),e.onPause&&(p.onPause=e.onPause),e.onFullScreenToggle&&(p.onFullScreenToggle=e.onFullScreenToggle),u=animation(),m=createUpdate({onProgress:p.onProgress,progressInterval:h,videoController:d,store:c,animation:u,useLogger:e.useLogger}),g=createPlay({onPlay:p.onPlay,videoController:d,store:c,animation:u,update:m,useLogger:e.useLogger})},getActions:function(){return{play:g,toggle:e,pause:n,setCurrentTime:a,requestFullScreen:t,exitFullScreen:r,toggleFullScreen:i,getVideoPlayerContainerOffsetLeft:s,cancelAnimation:y,toggleMuted:o,toggleSubtitles:l}}}},runtime_1=createCommonjsModule(function(e){var t=function(s){var l,e=Object.prototype,c=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,r,i){var a,s,o,l,n=t&&t.prototype instanceof y?t:y,u=Object.create(n.prototype),c=new w(i||[]);return u._invoke=(a=e,s=r,o=c,l=f,function(e,t){if(l===p)throw new Error("Generator is already running");if(l===g){if("throw"===e)throw t;return C()}for(o.method=e,o.arg=t;;){var r=o.delegate;if(r){var i=M(r,o);if(i){if(i===m)continue;return i}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(l===f)throw l=g,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);l=p;var n=d(a,s,o);if("normal"===n.type){if(l=o.done?g:h,n.arg===m)continue;return{value:n.arg,done:o.done}}"throw"===n.type&&(l=g,o.method="throw",o.arg=n.arg)}}),u}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}s.wrap=o;var f="suspendedStart",h="suspendedYield",p="executing",g="completed",m={};function y(){}function a(){}function u(){}var v={};v[n]=function(){return this};var b=Object.getPrototypeOf,S=b&&b(b(E([])));S&&S!==e&&c.call(S,n)&&(v=S);var T=u.prototype=y.prototype=Object.create(v);function _(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function I(l,u){var t;this._invoke=function(r,i){function e(){return new u(function(e,t){!function t(e,r,i,n){var a=d(l[e],l,r);if("throw"!==a.type){var s=a.arg,o=s.value;return o&&"object"==typeof o&&c.call(o,"__await")?u.resolve(o.__await).then(function(e){t("next",e,i,n)},function(e){t("throw",e,i,n)}):u.resolve(o).then(function(e){s.value=e,i(s)},function(e){return t("throw",e,i,n)})}n(a.arg)}(r,i,e,t)})}return t=t?t.then(e,e):e()}}function M(e,t){var r=e.iterator[t.method];if(r===l){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=l,M(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var n=i.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=l),t.delegate=null,m):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function E(t){if(t){var e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(c.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=l,e.done=!0,e};return i.next=i}}return{next:C}}function C(){return{value:l,done:!0}}return a.prototype=T.constructor=u,u.constructor=a,u[i]=a.displayName="GeneratorFunction",s.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===a||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,u):(e.__proto__=u,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(T),e},s.awrap=function(e){return{__await:e}},_(I.prototype),I.prototype[r]=function(){return this},s.AsyncIterator=I,s.async=function(e,t,r,i,n){void 0===n&&(n=Promise);var a=new I(o(e,t,r,i),n);return s.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(T),T[i]="Generator",T[n]=function(){return this},T.toString=function(){return"[object Generator]"},s.keys=function(r){var i=[];for(var e in r)i.push(e);return i.reverse(),function e(){for(;i.length;){var t=i.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},s.values=E,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(D),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var i=this;function e(e,t){return a.type="throw",a.arg=r,i.next=e,t&&(i.method="next",i.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t],a=n.completion;if("root"===n.tryLoc)return e("end");if(n.tryLoc<=this.prev){var s=c.call(n,"catchLoc"),o=c.call(n,"finallyLoc");if(s&&o){if(this.prev<n.catchLoc)return e(n.catchLoc,!0);if(this.prev<n.finallyLoc)return e(n.finallyLoc)}else if(s){if(this.prev<n.catchLoc)return e(n.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return e(n.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&c.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var n=i;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var a=n?n.completion:{};return a.type=e,a.arg=t,n?(this.method="next",this.next=n.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;D(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=l),m}},s}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}),regenerator=runtime_1,createVideoController=function(e){function t(){return!l||!l.paused()&&!l.ended()}function r(){return!l||3<l.readyState()}function i(){return!!l}function n(){return!!l.hasEnded()}function a(e){if(u<=e){if(l){var t=l.duration();if(t&&0<t)return l.currentTime()<=t&&e<=t+u}return e<c&&u<=e}return!1}function s(){l&&t()&&l.pause()}function o(){return l?l.currentTime():0}var l,u,c,d=function(){var e=_asyncToGenerator(regenerator.mark(function e(){return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l&&!t())return e.abrupt("return",l.play());e.next=2;break;case 2:return e.abrupt("return",Promise.resolve(0));case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return{isVideoReady:r,isVideoInTimeRange:a,preloadVideo:function(){return l?l.preload():Promise.resolve()},playVideo:d,pauseVideo:s,setCurrentTime:function(e){var t=e-u;t<0&&(t=0),l&&l.setCurrentTime(t,e)},updateCurrentTime:function(e){var t=e-u;if(t<0&&(t=0),l){var r=l.paused();s(),l.setCurrentTime(t,e),r||l.play()}},getCurrentTime:o,setFullScreen:function(){l&&l.setFullScreen()},removeFullScreen:function(){l&&l.removeFullScreen()},isVideoPlaying:t,hasVideo:i,hasVideoEnded:n,getVideoData:function(e){return i()?{isVideoInTimeRange:a(e),isVideoPlaying:t(),isVideoReady:r(),videoCurrentTime:o(),hasVideoEnded:n(),hasVideo:i()}:{}},reloadVideo:function(){var e=l.currentTime(),t=e+u;return l.load(),l.setCurrentTime(e,t),d()},setMuted:function(e){l.setMuted(e)},onVideoEnd:e,setProps:function(e){l=e.video,u=e.startOffsetTime,e.endOffsetTime,c=e.videoDurationFromJson}}},documentElement$2=document,attachToDOM=function(e,t){("string"==typeof e?documentElement$2.getElementById(e):e).appendChild(t)},createLoadingPromise=function(){var t=null;return{resolve:function(){t?t():t=Promise.resolve()},promise:new Promise(function(e){t=e})}},extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=a.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}var OBFUSCATED_ERROR="An invariant failed, however the error is obfuscated because this is a production build.",EMPTY_ARRAY=[];Object.freeze(EMPTY_ARRAY);var EMPTY_OBJECT={};function getNextId(){return++globalState.mobxGuid}function fail(e){throw invariant(!1,e),"X"}function invariant(e,t){if(!e)throw new Error("[mobx] "+(t||OBFUSCATED_ERROR))}function once(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}Object.freeze(EMPTY_OBJECT);var noop=function(){};function unique(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),t}function isObject(e){return null!==e&&"object"==typeof e}function isPlainObject(e){if(null===e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||null===t}function addHiddenProp(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function addHiddenFinalProp(e,t,r){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function isPropertyConfigurable(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!r||!1!==r.configurable&&!1!==r.writable}function createInstanceofPredicate(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(e){return isObject(e)&&!0===e[r]}}function isES6Map(e){return e instanceof Map}function isES6Set(e){return e instanceof Set}function getPlainObjectKeys(t){var r=new Set;for(var e in t)r.add(e);return Object.getOwnPropertySymbols(t).forEach(function(e){Object.getOwnPropertyDescriptor(t,e).enumerable&&r.add(e)}),Array.from(r)}function stringifyKey(e){return e&&e.toString?e.toString():new String(e).toString()}function getMapLikeKeys(e){return isPlainObject(e)?Object.keys(e):Array.isArray(e)?e.map(function(e){return __read(e,1)[0]}):isES6Map(e)||isObservableMap(e)?Array.from(e.keys()):fail("Cannot get keys from '"+e+"'")}function toPrimitive(e){return null===e?null:"object"==typeof e?""+e:e}var $mobx=Symbol("mobx administration"),Atom=function(){function e(e){void 0===e&&(e="Atom@"+getNextId()),this.name=e,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=new Set,this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=IDerivationState.NOT_TRACKING}return e.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(e){return e()})},e.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(e){return e()})},e.prototype.reportObserved=function(){return reportObserved(this)},e.prototype.reportChanged=function(){startBatch(),propagateChanged(this),endBatch()},e.prototype.toString=function(){return this.name},e}(),isAtom=createInstanceofPredicate("Atom",Atom);function createAtom(e,t,r){void 0===t&&(t=noop),void 0===r&&(r=noop);var i=new Atom(e);return t!==noop&&onBecomeObserved(i,t),r!==noop&&onBecomeUnobserved(i,r),i}function identityComparer(e,t){return e===t}function structuralComparer(e,t){return deepEqual(e,t)}function shallowComparer(e,t){return deepEqual(e,t,1)}function defaultComparer(e,t){return Object.is(e,t)}var comparer={identity:identityComparer,structural:structuralComparer,default:defaultComparer,shallow:shallowComparer},mobxDidRunLazyInitializersSymbol=Symbol("mobx did run lazy initializers"),mobxPendingDecorators=Symbol("mobx pending decorators"),enumerableDescriptorCache={},nonEnumerableDescriptorCache={};function createPropertyInitializerDescriptor(t,e){var r=e?enumerableDescriptorCache:nonEnumerableDescriptorCache;return r[t]||(r[t]={configurable:!0,enumerable:e,get:function(){return initializeInstance(this),this[t]},set:function(e){initializeInstance(this),this[t]=e}})}function initializeInstance(e){var t,r;if(!0!==e[mobxDidRunLazyInitializersSymbol]){var i=e[mobxPendingDecorators];if(i){addHiddenProp(e,mobxDidRunLazyInitializersSymbol,!0);var n=__spread(Object.getOwnPropertySymbols(i),Object.keys(i));try{for(var a=__values(n),s=a.next();!s.done;s=a.next()){var o=i[s.value];o.propertyCreator(e,o.prop,o.descriptor,o.decoratorTarget,o.decoratorArguments)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}}}}function createPropDecorator(s,o){return function(){function e(e,t,r,i){if(!0===i)return o(e,t,r,e,a),null;if(!Object.prototype.hasOwnProperty.call(e,mobxPendingDecorators)){var n=e[mobxPendingDecorators];addHiddenProp(e,mobxPendingDecorators,__assign({},n))}return e[mobxPendingDecorators][t]={prop:t,propertyCreator:o,descriptor:r,decoratorTarget:e,decoratorArguments:a},createPropertyInitializerDescriptor(t,s)}var a;return quacksLikeADecorator(arguments)?(a=EMPTY_ARRAY,e.apply(null,arguments)):(a=Array.prototype.slice.call(arguments),e)}}function quacksLikeADecorator(e){return(2===e.length||3===e.length)&&("string"==typeof e[1]||"symbol"==typeof e[1])||4===e.length&&!0===e[3]}function deepEnhancer(e,t,r){return isObservable(e)?e:Array.isArray(e)?observable.array(e,{name:r}):isPlainObject(e)?observable.object(e,void 0,{name:r}):isES6Map(e)?observable.map(e,{name:r}):isES6Set(e)?observable.set(e,{name:r}):e}function shallowEnhancer(e,t,r){return null==e||isObservableObject(e)||isObservableArray(e)||isObservableMap(e)||isObservableSet(e)?e:Array.isArray(e)?observable.array(e,{name:r,deep:!1}):isPlainObject(e)?observable.object(e,void 0,{name:r,deep:!1}):isES6Map(e)?observable.map(e,{name:r,deep:!1}):isES6Set(e)?observable.set(e,{name:r,deep:!1}):fail(!1)}function referenceEnhancer(e){return e}function refStructEnhancer(e,t,r){return deepEqual(e,t)?t:e}function createDecoratorForEnhancer(s){invariant(s);var e=createPropDecorator(!0,function(e,t,r,i,n){var a=r?r.initializer?r.initializer.call(e):r.value:void 0;asObservableObject(e).addObservableProp(t,a,s)}),t=e;return t.enhancer=s,t}var defaultCreateObservableOptions={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function asCreateObservableOptions(e){return null==e?defaultCreateObservableOptions:"string"==typeof e?{name:e,deep:!0,proxy:!0}:e}Object.freeze(defaultCreateObservableOptions);var deepDecorator=createDecoratorForEnhancer(deepEnhancer),shallowDecorator=createDecoratorForEnhancer(shallowEnhancer),refDecorator=createDecoratorForEnhancer(referenceEnhancer),refStructDecorator=createDecoratorForEnhancer(refStructEnhancer);function getEnhancerFromOptions(e){return e.defaultDecorator?e.defaultDecorator.enhancer:!1===e.deep?referenceEnhancer:deepEnhancer}function createObservable(e,t,r){if("string"==typeof t||"symbol"==typeof t)return deepDecorator.apply(null,arguments);if(isObservable(e))return e;var i=isPlainObject(e)?observable.object(e,t,r):Array.isArray(e)?observable.array(e,t):isES6Map(e)?observable.map(e,t):isES6Set(e)?observable.set(e,t):e;if(i!==e)return i;fail(!1)}var observableFactories={box:function(e,t){2<arguments.length&&incorrectlyUsedAsDecorator("box");var r=asCreateObservableOptions(t);return new ObservableValue(e,getEnhancerFromOptions(r),r.name,!0,r.equals)},array:function(e,t){2<arguments.length&&incorrectlyUsedAsDecorator("array");var r=asCreateObservableOptions(t);return createObservableArray(e,getEnhancerFromOptions(r),r.name)},map:function(e,t){2<arguments.length&&incorrectlyUsedAsDecorator("map");var r=asCreateObservableOptions(t);return new ObservableMap(e,getEnhancerFromOptions(r),r.name)},set:function(e,t){2<arguments.length&&incorrectlyUsedAsDecorator("set");var r=asCreateObservableOptions(t);return new ObservableSet(e,getEnhancerFromOptions(r),r.name)},object:function(e,t,r){"string"==typeof t&&incorrectlyUsedAsDecorator("object");var i=asCreateObservableOptions(r);if(!1===i.proxy)return extendObservable({},e,t,i);var n=getDefaultDecoratorFromObjectOptions(i),a=createDynamicObservableObject(extendObservable({},void 0,void 0,i));return extendObservableObjectWithProperties(a,e,t,n),a},ref:refDecorator,shallow:shallowDecorator,deep:deepDecorator,struct:refStructDecorator},observable=createObservable;function incorrectlyUsedAsDecorator(e){fail("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}Object.keys(observableFactories).forEach(function(e){return observable[e]=observableFactories[e]});var IDerivationState,TraceMode,computedDecorator=createPropDecorator(!1,function(e,t,r,i,n){var a=r.get,s=r.set,o=n[0]||{};asObservableObject(e).addComputedProp(e,t,__assign({get:a,set:s,context:e},o))}),computedStructDecorator=computedDecorator({equals:comparer.structural}),computed=function(e,t,r){if("string"==typeof t)return computedDecorator.apply(null,arguments);if(null!==e&&"object"==typeof e&&1===arguments.length)return computedDecorator.apply(null,arguments);var i="object"==typeof t?t:{};return i.get=e,i.set="function"==typeof t?t:i.set,i.name=i.name||e.name||"",new ComputedValue(i)};computed.struct=computedStructDecorator,function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"}(IDerivationState=IDerivationState||{}),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(TraceMode=TraceMode||{});var CaughtException=function(e){this.cause=e};function isCaughtException(e){return e instanceof CaughtException}function shouldCompute(e){switch(e.dependenciesState){case IDerivationState.UP_TO_DATE:return!1;case IDerivationState.NOT_TRACKING:case IDerivationState.STALE:return!0;case IDerivationState.POSSIBLY_STALE:for(var t=allowStateReadsStart(!0),r=untrackedStart(),i=e.observing,n=i.length,a=0;a<n;a++){var s=i[a];if(isComputedValue(s)){if(globalState.disableErrorBoundaries)s.get();else try{s.get()}catch(e){return untrackedEnd(r),allowStateReadsEnd(t),!0}if(e.dependenciesState===IDerivationState.STALE)return untrackedEnd(r),allowStateReadsEnd(t),!0}}return changeDependenciesStateTo0(e),untrackedEnd(r),allowStateReadsEnd(t),!1}}function checkIfStateModificationsAreAllowed(e){var t=0<e.observers.size;0<globalState.computationDepth&&t&&fail(!1),globalState.allowStateChanges||!t&&"strict"!==globalState.enforceActions||fail(!1)}function trackDerivedFunction(e,t,r){var i=allowStateReadsStart(!0);changeDependenciesStateTo0(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++globalState.runId;var n,a=globalState.trackingDerivation;if(globalState.trackingDerivation=e,!0===globalState.disableErrorBoundaries)n=t.call(r);else try{n=t.call(r)}catch(e){n=new CaughtException(e)}return globalState.trackingDerivation=a,bindDependencies(e),allowStateReadsEnd(i),n}function bindDependencies(e){for(var t=e.observing,r=e.observing=e.newObserving,i=IDerivationState.UP_TO_DATE,n=0,a=e.unboundDepsCount,s=0;s<a;s++){0===(o=r[s]).diffValue&&(o.diffValue=1,n!==s&&(r[n]=o),n++),o.dependenciesState>i&&(i=o.dependenciesState)}for(r.length=n,e.newObserving=null,a=t.length;a--;){0===(o=t[a]).diffValue&&removeObserver(o,e),o.diffValue=0}for(;n--;){var o;1===(o=r[n]).diffValue&&(o.diffValue=0,addObserver(o,e))}i!==IDerivationState.UP_TO_DATE&&(e.dependenciesState=i,e.onBecomeStale())}function clearObserving(e){var t=e.observing;e.observing=[];for(var r=t.length;r--;)removeObserver(t[r],e);e.dependenciesState=IDerivationState.NOT_TRACKING}function untracked(e){var t=untrackedStart();try{return e()}finally{untrackedEnd(t)}}function untrackedStart(){var e=globalState.trackingDerivation;return globalState.trackingDerivation=null,e}function untrackedEnd(e){globalState.trackingDerivation=e}function allowStateReadsStart(e){var t=globalState.allowStateReads;return globalState.allowStateReads=e,t}function allowStateReadsEnd(e){globalState.allowStateReads=e}function changeDependenciesStateTo0(e){if(e.dependenciesState!==IDerivationState.UP_TO_DATE){e.dependenciesState=IDerivationState.UP_TO_DATE;for(var t=e.observing,r=t.length;r--;)t[r].lowestObserverState=IDerivationState.UP_TO_DATE}}var currentActionId=0,nextActionId=1,functionNameDescriptor=Object.getOwnPropertyDescriptor(function(){},"name"),isFunctionNameConfigurable=functionNameDescriptor&&functionNameDescriptor.configurable;function createAction(e,t,r){function i(){return executeAction(e,t,r||this,arguments)}return i.isMobxAction=!0,i}function executeAction(e,t,r,i){var n=_startAction();try{return t.apply(r,i)}catch(e){throw n.error=e}finally{_endAction(n)}}function _startAction(e,t,r){var i=isSpyEnabled(),n=untrackedStart();startBatch();var a={prevDerivation:n,prevAllowStateChanges:allowStateChangesStart(!0),prevAllowStateReads:allowStateReadsStart(!0),notifySpy:i,startTime:0,actionId:nextActionId++,parentActionId:currentActionId};return currentActionId=a.actionId,a}function _endAction(e){currentActionId!==e.actionId&&fail("invalid action stack. did you forget to finish an action?"),currentActionId=e.parentActionId,void 0!==e.error&&(globalState.suppressReactionErrors=!0),allowStateChangesEnd(e.prevAllowStateChanges),allowStateReadsEnd(e.prevAllowStateReads),endBatch(),untrackedEnd(e.prevDerivation),e.notifySpy,globalState.suppressReactionErrors=!1}function allowStateChangesStart(e){var t=globalState.allowStateChanges;return globalState.allowStateChanges=e,t}function allowStateChangesEnd(e){globalState.allowStateChanges=e}var ObservableValue=function(s){function e(e,t,r,i,n){void 0===r&&(r="ObservableValue@"+getNextId()),void 0===i&&(i=!0),void 0===n&&(n=comparer.default);var a=s.call(this,r)||this;return a.enhancer=t,a.name=r,a.equals=n,a.hasUnreportedChange=!1,a.value=t(e,void 0,r),i&&isSpyEnabled(),a}return __extends(e,s),e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.set=function(e){this.value;if((e=this.prepareNewValue(e))!==globalState.UNCHANGED){isSpyEnabled();0,this.setNewValue(e)}},e.prototype.prepareNewValue=function(e){if(checkIfStateModificationsAreAllowed(this),hasInterceptors(this)){var t=interceptChange(this,{object:this,type:"update",newValue:e});if(!t)return globalState.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value,this.name),this.equals(this.value,e)?globalState.UNCHANGED:e},e.prototype.setNewValue=function(e){var t=this.value;this.value=e,this.reportChanged(),hasListeners(this)&&notifyListeners(this,{type:"update",object:this,newValue:e,oldValue:t})},e.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},e.prototype.intercept=function(e){return registerInterceptor(this,e)},e.prototype.observe=function(e,t){return t&&e({object:this,type:"update",newValue:this.value,oldValue:void 0}),registerListener(this,e)},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.value+"]"},e.prototype.valueOf=function(){return toPrimitive(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}(Atom),isObservableValue=createInstanceofPredicate("ObservableValue",ObservableValue),ComputedValue=function(){function e(e){this.dependenciesState=IDerivationState.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=new Set,this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=IDerivationState.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+getNextId(),this.value=new CaughtException(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=TraceMode.NONE,invariant(e.get,"missing option for computed: get"),this.derivation=e.get,this.name=e.name||"ComputedValue@"+getNextId(),e.set&&(this.setter=createAction(this.name+"-setter",e.set)),this.equals=e.equals||(e.compareStructural||e.struct?comparer.structural:comparer.default),this.scope=e.context,this.requiresReaction=!!e.requiresReaction,this.keepAlive=!!e.keepAlive}return e.prototype.onBecomeStale=function(){propagateMaybeChanged(this)},e.prototype.onBecomeObserved=function(){this.onBecomeObservedListeners&&this.onBecomeObservedListeners.forEach(function(e){return e()})},e.prototype.onBecomeUnobserved=function(){this.onBecomeUnobservedListeners&&this.onBecomeUnobservedListeners.forEach(function(e){return e()})},e.prototype.get=function(){this.isComputing&&fail("Cycle detected in computation "+this.name+": "+this.derivation),0!==globalState.inBatch||0!==this.observers.size||this.keepAlive?(reportObserved(this),shouldCompute(this)&&this.trackAndCompute()&&propagateChangeConfirmed(this)):shouldCompute(this)&&(this.warnAboutUntrackedRead(),startBatch(),this.value=this.computeValue(!1),endBatch());var e=this.value;if(isCaughtException(e))throw e.cause;return e},e.prototype.peek=function(){var e=this.computeValue(!1);if(isCaughtException(e))throw e.cause;return e},e.prototype.set=function(e){if(this.setter){invariant(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=!1}}else invariant(!1,!1)},e.prototype.trackAndCompute=function(){var e=this.value,t=this.dependenciesState===IDerivationState.NOT_TRACKING,r=this.computeValue(!0),i=t||isCaughtException(e)||isCaughtException(r)||!this.equals(e,r);return i&&(this.value=r),i},e.prototype.computeValue=function(e){var t;if(this.isComputing=!0,globalState.computationDepth++,e)t=trackDerivedFunction(this,this.derivation,this.scope);else if(!0===globalState.disableErrorBoundaries)t=this.derivation.call(this.scope);else try{t=this.derivation.call(this.scope)}catch(e){t=new CaughtException(e)}return globalState.computationDepth--,this.isComputing=!1,t},e.prototype.suspend=function(){this.keepAlive||(clearObserving(this),this.value=void 0)},e.prototype.observe=function(r,i){var n=this,a=!0,s=void 0;return autorun(function(){var e=n.get();if(!a||i){var t=untrackedStart();r({type:"update",object:n,newValue:e,oldValue:s}),untrackedEnd(t)}a=!1,s=e})},e.prototype.warnAboutUntrackedRead=function(){},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return toPrimitive(this.get())},e.prototype[Symbol.toPrimitive]=function(){return this.valueOf()},e}(),isComputedValue=createInstanceofPredicate("ComputedValue",ComputedValue),MobXGlobals=function(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1},mockGlobal={};function getGlobal(){return"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:mockGlobal}var canMergeGlobalState=!0,isolateCalled=!1,globalState=function(){var e=getGlobal();return 0<e.__mobxInstanceCount&&!e.__mobxGlobals&&(canMergeGlobalState=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==(new MobXGlobals).version&&(canMergeGlobalState=!1),canMergeGlobalState?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new MobXGlobals):(setTimeout(function(){isolateCalled||fail("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new MobXGlobals)}();function isolateGlobalState(){(globalState.pendingReactions.length||globalState.inBatch||globalState.isRunningReactions)&&fail("isolateGlobalState should be called before MobX is running any reactions"),isolateCalled=!0,canMergeGlobalState&&(0==--getGlobal().__mobxInstanceCount&&(getGlobal().__mobxGlobals=void 0),globalState=new MobXGlobals)}function addObserver(e,t){e.observers.add(t),e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function removeObserver(e,t){e.observers.delete(t),0===e.observers.size&&queueForUnobservation(e)}function queueForUnobservation(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,globalState.pendingUnobservations.push(e))}function startBatch(){globalState.inBatch++}function endBatch(){if(0==--globalState.inBatch){runReactions();for(var e=globalState.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,0===r.observers.size&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBecomeUnobserved()),r instanceof ComputedValue&&r.suspend())}globalState.pendingUnobservations=[]}}function reportObserved(e){var t=globalState.trackingDerivation;return null!==t?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,(t.newObserving[t.unboundDepsCount++]=e).isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(0===e.observers.size&&0<globalState.inBatch&&queueForUnobservation(e),!1)}function propagateChanged(t){t.lowestObserverState!==IDerivationState.STALE&&(t.lowestObserverState=IDerivationState.STALE,t.observers.forEach(function(e){e.dependenciesState===IDerivationState.UP_TO_DATE&&(e.isTracing!==TraceMode.NONE&&logTraceInfo(e,t),e.onBecomeStale()),e.dependenciesState=IDerivationState.STALE}))}function propagateChangeConfirmed(t){t.lowestObserverState!==IDerivationState.STALE&&(t.lowestObserverState=IDerivationState.STALE,t.observers.forEach(function(e){e.dependenciesState===IDerivationState.POSSIBLY_STALE?e.dependenciesState=IDerivationState.STALE:e.dependenciesState===IDerivationState.UP_TO_DATE&&(t.lowestObserverState=IDerivationState.UP_TO_DATE)}))}function propagateMaybeChanged(t){t.lowestObserverState===IDerivationState.UP_TO_DATE&&(t.lowestObserverState=IDerivationState.POSSIBLY_STALE,t.observers.forEach(function(e){e.dependenciesState===IDerivationState.UP_TO_DATE&&(e.dependenciesState=IDerivationState.POSSIBLY_STALE,e.isTracing!==TraceMode.NONE&&logTraceInfo(e,t),e.onBecomeStale())}))}function logTraceInfo(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===TraceMode.BREAK){var r=[];printDepTree(getDependencyTree(e),r,1),new Function("debugger;\n/*\nTracing '"+e.name+"'\n\nYou are entering this break point because derivation '"+e.name+"' is being traced and '"+t.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(e instanceof ComputedValue?e.derivation.toString().replace(/[*]\//g,"/"):"")+"\n\nThe dependencies for this derivation are:\n\n"+r.join("\n")+"\n*/\n    ")()}}function printDepTree(e,t,r){1e3<=t.length?t.push("(and many more)"):(t.push(""+new Array(r).join("\t")+e.name),e.dependencies&&e.dependencies.forEach(function(e){return printDepTree(e,t,r+1)}))}var Reaction=function(){function e(e,t,r,i){void 0===e&&(e="Reaction@"+getNextId()),void 0===i&&(i=!1),this.name=e,this.onInvalidate=t,this.errorHandler=r,this.requiresObservable=i,this.observing=[],this.newObserving=[],this.dependenciesState=IDerivationState.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+getNextId(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=TraceMode.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,globalState.pendingReactions.push(this),runReactions())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(startBatch(),this._isScheduled=!1,shouldCompute(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&isSpyEnabled()}catch(e){this.reportExceptionInDerivation(e)}}endBatch()}},e.prototype.track=function(e){if(!this.isDisposed){startBatch(),this._isRunning=!0;var t=trackDerivedFunction(this,e,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&clearObserving(this),isCaughtException(t)&&this.reportExceptionInDerivation(t.cause),endBatch()}},e.prototype.reportExceptionInDerivation=function(t){var r=this;if(this.errorHandler)this.errorHandler(t,this);else{if(globalState.disableErrorBoundaries)throw t;var e="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";globalState.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(e,t),globalState.globalReactionErrorHandlers.forEach(function(e){return e(t,r)})}},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(startBatch(),clearObserving(this),endBatch()))},e.prototype.getDisposer=function(){var e=this.dispose.bind(this);return e[$mobx]=this,e},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(e){void 0===e&&(e=!1),trace(this,e)},e}(),MAX_REACTION_ITERATIONS=100,reactionScheduler=function(e){return e()};function runReactions(){0<globalState.inBatch||globalState.isRunningReactions||reactionScheduler(runReactionsHelper)}function runReactionsHelper(){globalState.isRunningReactions=!0;for(var e=globalState.pendingReactions,t=0;0<e.length;){++t===MAX_REACTION_ITERATIONS&&(console.error("Reaction doesn't converge to a stable state after "+MAX_REACTION_ITERATIONS+" iterations. Probably there is a cycle in the reactive function: "+e[0]),e.splice(0));for(var r=e.splice(0),i=0,n=r.length;i<n;i++)r[i].runReaction()}globalState.isRunningReactions=!1}var isReaction=createInstanceofPredicate("Reaction",Reaction);function setReactionScheduler(t){var r=reactionScheduler;reactionScheduler=function(e){return t(function(){return r(e)})}}function isSpyEnabled(){return!1}function spyReport(e){}function spyReportStart(e){}function spyReportEnd(e){}function spy(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}function dontReassignFields(){fail(!1)}function namedActionDecorator(n){return function(e,t,r){if(r){if(r.value)return{value:createAction(n,r.value),enumerable:!1,configurable:!0,writable:!0};var i=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return createAction(n,i.call(this))}}}return actionFieldDecorator(n).apply(this,arguments)}}function actionFieldDecorator(i){return function(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:function(){},set:function(e){addHiddenProp(this,t,action(i,e))}})}}function boundActionDecorator(e,t,r,i){return!0===i?(defineBoundAction(e,t,r.value),null):r?{configurable:!0,enumerable:!1,get:function(){return defineBoundAction(this,t,r.value||r.initializer.call(this)),this[t]},set:dontReassignFields}:{enumerable:!1,configurable:!0,set:function(e){defineBoundAction(this,t,e)},get:function(){}}}var action=function(e,t,r,i){return 1===arguments.length&&"function"==typeof e?createAction(e.name||"<unnamed action>",e):2===arguments.length&&"function"==typeof t?createAction(e,t):1===arguments.length&&"string"==typeof e?namedActionDecorator(e):!0!==i?namedActionDecorator(t).apply(null,arguments):void addHiddenProp(e,t,createAction(e.name||t,r.value,this))};function defineBoundAction(e,t,r){addHiddenProp(e,t,createAction(t,r.bind(e)))}function autorun(e,t){void 0===t&&(t=EMPTY_OBJECT);var r,i=t&&t.name||e.name||"Autorun@"+getNextId();if(!t.scheduler&&!t.delay)r=new Reaction(i,function(){this.track(s)},t.onError,t.requiresObservable);else{var n=createSchedulerFromOptions(t),a=!1;r=new Reaction(i,function(){a||(a=!0,n(function(){a=!1,r.isDisposed||r.track(s)}))},t.onError,t.requiresObservable)}function s(){e(r)}return r.schedule(),r.getDisposer()}action.bound=boundActionDecorator;var run=function(e){return e()};function createSchedulerFromOptions(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:run}function onBecomeObserved(e,t,r){return interceptHook("onBecomeObserved",e,t,r)}function onBecomeUnobserved(e,t,r){return interceptHook("onBecomeUnobserved",e,t,r)}function interceptHook(e,t,r,i){var n="function"==typeof i?getAtom(t,r):getAtom(t),a="function"==typeof i?i:r,s=e+"Listeners";return n[s]?n[s].add(a):n[s]=new Set([a]),"function"!=typeof n[e]?fail(!1):function(){var e=n[s];e&&(e.delete(a),0===e.size&&delete n[s])}}function configure(e){var t=e.enforceActions,r=e.computedRequiresReaction,i=e.computedConfigurable,n=e.disableErrorBoundaries,a=e.reactionScheduler,s=e.reactionRequiresObservable,o=e.observableRequiresReaction;if(!0===e.isolateGlobalState&&isolateGlobalState(),void 0!==t){var l=void 0;switch(t){case!0:case"observed":l=!0;break;case!1:case"never":l=!1;break;case"strict":case"always":l="strict";break;default:fail("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}globalState.enforceActions=l,globalState.allowStateChanges=!0!==l&&"strict"!==l}void 0!==r&&(globalState.computedRequiresReaction=!!r),void 0!==s&&(globalState.reactionRequiresObservable=!!s),void 0!==o&&(globalState.observableRequiresReaction=!!o,globalState.allowStateReads=!globalState.observableRequiresReaction),void 0!==i&&(globalState.computedConfigurable=!!i),void 0!==n&&(!0===n&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors when `disableErrorBoundaries` is enabled."),globalState.disableErrorBoundaries=!!n),a&&setReactionScheduler(a)}function extendObservable(e,t,r,i){var n=getDefaultDecoratorFromObjectOptions(i=asCreateObservableOptions(i));return initializeInstance(e),asObservableObject(e,i.name,n.enhancer),t&&extendObservableObjectWithProperties(e,t,r,n),e}function getDefaultDecoratorFromObjectOptions(e){return e.defaultDecorator||(!1===e.deep?refDecorator:deepDecorator)}function extendObservableObjectWithProperties(e,t,r,i){var n,a;startBatch();try{var s=getPlainObjectKeys(t);try{for(var o=__values(s),l=o.next();!l.done;l=o.next()){var u=l.value,c=Object.getOwnPropertyDescriptor(t,u);0;var d=r&&u in r?r[u]:c.get?computedDecorator:i;0;var f=d(e,u,c,!0);f&&Object.defineProperty(e,u,f)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}}finally{endBatch()}}function getDependencyTree(e,t){return nodeToDependencyTree(getAtom(e,t))}function nodeToDependencyTree(e){var t={name:e.name};return e.observing&&0<e.observing.length&&(t.dependencies=unique(e.observing).map(nodeToDependencyTree)),t}function _isComputed(e,t){if(null==e)return!1;if(void 0===t)return isComputedValue(e);if(!1===isObservableObject(e))return!1;if(!e[$mobx].values.has(t))return!1;var r=getAtom(e,t);return isComputedValue(r)}function isComputed(e){return 1<arguments.length?fail(!1):_isComputed(e)}function _isObservable(e,t){return null!=e&&(void 0!==t?!!isObservableObject(e)&&e[$mobx].values.has(t):isObservableObject(e)||!!e[$mobx]||isAtom(e)||isReaction(e)||isComputedValue(e))}function isObservable(e){return 1!==arguments.length&&fail(!1),_isObservable(e)}function set(e,t,r){if(2!==arguments.length||isObservableSet(e))if(isObservableObject(e)){var i=e[$mobx];i.values.get(t)?i.write(t,r):i.addObservableProp(t,r,i.defaultEnhancer)}else if(isObservableMap(e))e.set(t,r);else if(isObservableSet(e))e.add(t);else{if(!isObservableArray(e))return fail(!1);"number"!=typeof t&&(t=parseInt(t,10)),invariant(0<=t,"Not a valid index: '"+t+"'"),startBatch(),t>=e.length&&(e.length=t+1),e[t]=r,endBatch()}else{startBatch();var n=t;try{for(var a in n)set(e,a,n[a])}finally{endBatch()}}}function trace(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=!1;"boolean"==typeof e[e.length-1]&&(r=e.pop());var i=getAtomFromArgs(e);if(!i)return fail(!1);i.isTracing===TraceMode.NONE&&console.log("[mobx.trace] '"+i.name+"' tracing enabled"),i.isTracing=r?TraceMode.BREAK:TraceMode.LOG}function getAtomFromArgs(e){switch(e.length){case 0:return globalState.trackingDerivation;case 1:return getAtom(e[0]);case 2:return getAtom(e[0],e[1])}}function transaction(e,t){void 0===t&&(t=void 0),startBatch();try{return e.apply(t)}finally{endBatch()}}function getAdm(e){return e[$mobx]}function isPropertyKey(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e}var objectProxyTraps={has:function(e,t){if(t===$mobx||"constructor"===t||t===mobxDidRunLazyInitializersSymbol)return!0;var r=getAdm(e);return isPropertyKey(t)?r.has(t):t in e},get:function(e,t){if(t===$mobx||"constructor"===t||t===mobxDidRunLazyInitializersSymbol)return e[t];var r=getAdm(e),i=r.values.get(t);if(i instanceof Atom){var n=i.get();return void 0===n&&r.has(t),n}return isPropertyKey(t)&&r.has(t),e[t]},set:function(e,t,r){return!!isPropertyKey(t)&&(set(e,t,r),!0)},deleteProperty:function(e,t){return!!isPropertyKey(t)&&(getAdm(e).remove(t),!0)},ownKeys:function(e){return getAdm(e).keysAtom.reportObserved(),Reflect.ownKeys(e)},preventExtensions:function(e){return fail("Dynamic observable objects cannot be frozen"),!1}};function createDynamicObservableObject(e){var t=new Proxy(e,objectProxyTraps);return e[$mobx].proxy=t}function hasInterceptors(e){return void 0!==e.interceptors&&0<e.interceptors.length}function registerInterceptor(e,t){var r=e.interceptors||(e.interceptors=[]);return r.push(t),once(function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)})}function interceptChange(e,t){var r=untrackedStart();try{for(var i=__spread(e.interceptors||[]),n=0,a=i.length;n<a&&(invariant(!(t=i[n](t))||t.type,"Intercept handlers should return nothing or a change object"),t);n++);return t}finally{untrackedEnd(r)}}function hasListeners(e){return void 0!==e.changeListeners&&0<e.changeListeners.length}function registerListener(e,t){var r=e.changeListeners||(e.changeListeners=[]);return r.push(t),once(function(){var e=r.indexOf(t);-1!==e&&r.splice(e,1)})}function notifyListeners(e,t){var r=untrackedStart(),i=e.changeListeners;if(i){for(var n=0,a=(i=i.slice()).length;n<a;n++)i[n](t);untrackedEnd(r)}}var MAX_SPLICE_SIZE=1e4,arrayTraps={get:function(e,t){return t===$mobx?e[$mobx]:"length"===t?e[$mobx].getArrayLength():"number"==typeof t?arrayExtensions.get.call(e,t):"string"!=typeof t||isNaN(t)?arrayExtensions.hasOwnProperty(t)?arrayExtensions[t]:e[t]:arrayExtensions.get.call(e,parseInt(t))},set:function(e,t,r){return"length"===t&&e[$mobx].setArrayLength(r),"number"==typeof t&&arrayExtensions.set.call(e,t,r),"symbol"==typeof t||isNaN(t)?e[t]=r:arrayExtensions.set.call(e,parseInt(t),r),!0},preventExtensions:function(e){return fail("Observable arrays cannot be frozen"),!1}};function createObservableArray(e,t,r,i){void 0===r&&(r="ObservableArray@"+getNextId()),void 0===i&&(i=!1);var n=new ObservableArrayAdministration(r,t,i);addHiddenFinalProp(n.values,$mobx,n);var a=new Proxy(n.values,arrayTraps);if(n.proxy=a,e&&e.length){var s=allowStateChangesStart(!0);n.spliceWithArray(0,0,e),allowStateChangesEnd(s)}return a}var ObservableArrayAdministration=function(){function e(r,i,e){this.owned=e,this.values=[],this.proxy=void 0,this.lastKnownLength=0,this.atom=new Atom(r||"ObservableArray@"+getNextId()),this.enhancer=function(e,t){return i(e,t,r+"[..]")}}return e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.dehanceValues=function(e){return void 0!==this.dehancer&&0<e.length?e.map(this.dehancer):e},e.prototype.intercept=function(e){return registerInterceptor(this,e)},e.prototype.observe=function(e,t){return void 0===t&&(t=!1),t&&e({object:this.proxy,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),registerListener(this,e)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(e){if("number"!=typeof e||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e!==t)if(t<e){for(var r=new Array(e-t),i=0;i<e-t;i++)r[i]=void 0;this.spliceWithArray(t,0,r)}else this.spliceWithArray(e,t-e)},e.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed.");this.lastKnownLength+=t},e.prototype.spliceWithArray=function(e,t,r){var i=this;checkIfStateModificationsAreAllowed(this.atom);var n=this.values.length;if(void 0===e?e=0:n<e?e=n:e<0&&(e=Math.max(0,n+e)),t=1===arguments.length?n-e:null==t?0:Math.max(0,Math.min(t,n-e)),void 0===r&&(r=EMPTY_ARRAY),hasInterceptors(this)){var a=interceptChange(this,{object:this.proxy,type:"splice",index:e,removedCount:t,added:r});if(!a)return EMPTY_ARRAY;t=a.removedCount,r=a.added}r=0===r.length?r:r.map(function(e){return i.enhancer(e,void 0)});var s=this.spliceItemsIntoValues(e,t,r);return 0===t&&0===r.length||this.notifyArraySplice(e,r,s),this.dehanceValues(s)},e.prototype.spliceItemsIntoValues=function(e,t,r){var i;if(r.length<MAX_SPLICE_SIZE)return(i=this.values).splice.apply(i,__spread([e,t],r));var n=this.values.slice(e,e+t);return this.values=this.values.slice(0,e).concat(r,this.values.slice(e+t)),n},e.prototype.notifyArrayChildUpdate=function(e,t,r){var i=!this.owned&&isSpyEnabled(),n=hasListeners(this),a=n||i?{object:this.proxy,type:"update",index:e,newValue:t,oldValue:r}:null;this.atom.reportChanged(),n&&notifyListeners(this,a)},e.prototype.notifyArraySplice=function(e,t,r){var i=!this.owned&&isSpyEnabled(),n=hasListeners(this),a=n||i?{object:this.proxy,type:"splice",index:e,removed:r,added:t,removedCount:r.length,addedCount:t.length}:null;this.atom.reportChanged(),n&&notifyListeners(this,a)},e}(),arrayExtensions={intercept:function(e){return this[$mobx].intercept(e)},observe:function(e,t){return void 0===t&&(t=!1),this[$mobx].observe(e,t)},clear:function(){return this.splice(0)},replace:function(e){var t=this[$mobx];return t.spliceWithArray(0,t.values.length,e)},toJS:function(){return this.slice()},toJSON:function(){return this.toJS()},splice:function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=this[$mobx];switch(arguments.length){case 0:return[];case 1:return n.spliceWithArray(e);case 2:return n.spliceWithArray(e,t)}return n.spliceWithArray(e,t,r)},spliceWithArray:function(e,t,r){return this[$mobx].spliceWithArray(e,t,r)},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this[$mobx];return r.spliceWithArray(r.values.length,0,e),r.values.length},pop:function(){return this.splice(Math.max(this[$mobx].values.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this[$mobx];return r.spliceWithArray(0,0,e),r.values.length},reverse:function(){var e=this.slice();return e.reverse.apply(e,arguments)},sort:function(e){var t=this.slice();return t.sort.apply(t,arguments)},remove:function(e){var t=this[$mobx],r=t.dehanceValues(t.values).indexOf(e);return-1<r&&(this.splice(r,1),!0)},get:function(e){var t=this[$mobx];if(t){if(e<t.values.length)return t.atom.reportObserved(),t.dehanceValue(t.values[e]);console.warn("[mobx.array] Attempt to read an array index ("+e+") that is out of bounds ("+t.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}},set:function(e,t){var r=this[$mobx],i=r.values;if(e<i.length){checkIfStateModificationsAreAllowed(r.atom);var n=i[e];if(hasInterceptors(r)){var a=interceptChange(r,{type:"update",object:r.proxy,index:e,newValue:t});if(!a)return;t=a.newValue}(t=r.enhancer(t,n))!==n&&(i[e]=t,r.notifyArrayChildUpdate(e,t,n))}else{if(e!==i.length)throw new Error("[mobx.array] Index out of bounds, "+e+" is larger than "+i.length);r.spliceWithArray(e,0,[t])}}};["concat","every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach(function(r){arrayExtensions[r]=function(){var e=this[$mobx];e.atom.reportObserved();var t=e.dehanceValues(e.values);return t[r].apply(t,arguments)}});var _a,isObservableArrayAdministration=createInstanceofPredicate("ObservableArrayAdministration",ObservableArrayAdministration);function isObservableArray(e){return isObject(e)&&isObservableArrayAdministration(e[$mobx])}var _a$1,ObservableMapMarker={},ObservableMap=function(){function e(e,t,r){if(void 0===t&&(t=deepEnhancer),void 0===r&&(r="ObservableMap@"+getNextId()),this.enhancer=t,this.name=r,this[_a]=ObservableMapMarker,this._keysAtom=createAtom(this.name+".keys()"),this[Symbol.toStringTag]="Map","function"!=typeof Map)throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(e)}return e.prototype._has=function(e){return this._data.has(e)},e.prototype.has=function(e){var t=this;if(!globalState.trackingDerivation)return this._has(e);var r=this._hasMap.get(e);if(!r){var i=r=new ObservableValue(this._has(e),referenceEnhancer,this.name+"."+stringifyKey(e)+"?",!1);this._hasMap.set(e,i),onBecomeUnobserved(i,function(){return t._hasMap.delete(e)})}return r.get()},e.prototype.set=function(e,t){var r=this._has(e);if(hasInterceptors(this)){var i=interceptChange(this,{type:r?"update":"add",object:this,newValue:t,name:e});if(!i)return this;t=i.newValue}return r?this._updateValue(e,t):this._addValue(e,t),this},e.prototype.delete=function(e){var t=this;if(hasInterceptors(this)&&!(n=interceptChange(this,{type:"delete",object:this,name:e})))return!1;if(this._has(e)){var r=isSpyEnabled(),i=hasListeners(this),n=i||r?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;return transaction(function(){t._keysAtom.reportChanged(),t._updateHasMapEntry(e,!1),t._data.get(e).setNewValue(void 0),t._data.delete(e)}),i&&notifyListeners(this,n),!0}return!1},e.prototype._updateHasMapEntry=function(e,t){var r=this._hasMap.get(e);r&&r.setNewValue(t)},e.prototype._updateValue=function(e,t){var r=this._data.get(e);if((t=r.prepareNewValue(t))!==globalState.UNCHANGED){var i=isSpyEnabled(),n=hasListeners(this),a=n||i?{type:"update",object:this,oldValue:r.value,name:e,newValue:t}:null;0,r.setNewValue(t),n&&notifyListeners(this,a)}},e.prototype._addValue=function(t,r){var i=this;checkIfStateModificationsAreAllowed(this._keysAtom),transaction(function(){var e=new ObservableValue(r,i.enhancer,i.name+"."+stringifyKey(t),!1);i._data.set(t,e),r=e.value,i._updateHasMapEntry(t,!0),i._keysAtom.reportChanged()});var e=isSpyEnabled(),n=hasListeners(this);n&&notifyListeners(this,n||e?{type:"add",object:this,name:t,newValue:r}:null)},e.prototype.get=function(e){return this.has(e)?this.dehanceValue(this._data.get(e).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.keys=function(){return this._keysAtom.reportObserved(),this._data.keys()},e.prototype.values=function(){var e=this,t=0,r=Array.from(this.keys());return makeIterable({next:function(){return t<r.length?{value:e.get(r[t++]),done:!1}:{done:!0}}})},e.prototype.entries=function(){var t=this,r=0,i=Array.from(this.keys());return makeIterable({next:function(){if(r<i.length){var e=i[r++];return{value:[e,t.get(e)],done:!1}}return{done:!0}}})},e.prototype[_a=$mobx,Symbol.iterator]=function(){return this.entries()},e.prototype.forEach=function(e,t){var r,i;try{for(var n=__values(this),a=n.next();!a.done;a=n.next()){var s=__read(a.value,2),o=s[0],l=s[1];e.call(t,l,o,this)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}},e.prototype.merge=function(t){var n=this;return isObservableMap(t)&&(t=t.toJS()),transaction(function(){isPlainObject(t)?getPlainObjectKeys(t).forEach(function(e){return n.set(e,t[e])}):Array.isArray(t)?t.forEach(function(e){var t=__read(e,2),r=t[0],i=t[1];return n.set(r,i)}):isES6Map(t)?(t.constructor!==Map&&fail("Cannot initialize from classes that inherit from Map: "+t.constructor.name),t.forEach(function(e,t){return n.set(t,e)})):null!=t&&fail("Cannot initialize map from "+t)}),this},e.prototype.clear=function(){var a=this;transaction(function(){untracked(function(){var t,e;try{for(var r=__values(a.keys()),i=r.next();!i.done;i=r.next()){var n=i.value;a.delete(n)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}})})},e.prototype.replace=function(e){var r=this;return transaction(function(){var t=getMapLikeKeys(e);Array.from(r.keys()).filter(function(e){return-1===t.indexOf(e)}).forEach(function(e){return r.delete(e)}),r.merge(e)}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keysAtom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var t,e,r={};try{for(var i=__values(this),n=i.next();!n.done;n=i.next()){var a=__read(n.value,2),s=a[0],o=a[1];r["symbol"==typeof s?s:stringifyKey(s)]=o}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return r},e.prototype.toJS=function(){return new Map(this)},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var t=this;return this.name+"[{ "+Array.from(this.keys()).map(function(e){return stringifyKey(e)+": "+t.get(e)}).join(", ")+" }]"},e.prototype.observe=function(e,t){return registerListener(this,e)},e.prototype.intercept=function(e){return registerInterceptor(this,e)},e}(),isObservableMap=createInstanceofPredicate("ObservableMap",ObservableMap),ObservableSetMarker={},ObservableSet=function(){function e(e,r,i){if(void 0===r&&(r=deepEnhancer),void 0===i&&(i="ObservableSet@"+getNextId()),this.name=i,this[_a$1]=ObservableSetMarker,this._data=new Set,this._atom=createAtom(this.name),this[Symbol.toStringTag]="Set","function"!=typeof Set)throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(e,t){return r(e,t,i)},e&&this.replace(e)}return e.prototype.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},e.prototype.clear=function(){var a=this;transaction(function(){untracked(function(){var t,e;try{for(var r=__values(a._data.values()),i=r.next();!i.done;i=r.next()){var n=i.value;a.delete(n)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}})})},e.prototype.forEach=function(e,t){var r,i;try{for(var n=__values(this),a=n.next();!a.done;a=n.next()){var s=a.value;e.call(t,s,s,this)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.add=function(e){var t=this;if((checkIfStateModificationsAreAllowed(this._atom),hasInterceptors(this))&&!(n=interceptChange(this,{type:"add",object:this,newValue:e})))return this;if(!this.has(e)){transaction(function(){t._data.add(t.enhancer(e,void 0)),t._atom.reportChanged()});var r=isSpyEnabled(),i=hasListeners(this),n=i||r?{type:"add",object:this,newValue:e}:null;i&&notifyListeners(this,n)}return this},e.prototype.delete=function(e){var t=this;if(hasInterceptors(this)&&!(n=interceptChange(this,{type:"delete",object:this,oldValue:e})))return!1;if(this.has(e)){var r=isSpyEnabled(),i=hasListeners(this),n=i||r?{type:"delete",object:this,oldValue:e}:null;return transaction(function(){t._atom.reportChanged(),t._data.delete(e)}),i&&notifyListeners(this,n),!0}return!1},e.prototype.has=function(e){return this._atom.reportObserved(),this._data.has(this.dehanceValue(e))},e.prototype.entries=function(){var t=0,r=Array.from(this.keys()),i=Array.from(this.values());return makeIterable({next:function(){var e=t;return t+=1,e<i.length?{value:[r[e],i[e]],done:!1}:{done:!0}}})},e.prototype.keys=function(){return this.values()},e.prototype.values=function(){this._atom.reportObserved();var e=this,t=0,r=Array.from(this._data.values());return makeIterable({next:function(){return t<r.length?{value:e.dehanceValue(r[t++]),done:!1}:{done:!0}}})},e.prototype.replace=function(e){var t=this;return isObservableSet(e)&&(e=e.toJS()),transaction(function(){Array.isArray(e)?(t.clear(),e.forEach(function(e){return t.add(e)})):isES6Set(e)?(t.clear(),e.forEach(function(e){return t.add(e)})):null!=e&&fail("Cannot initialize set from "+e)}),this},e.prototype.observe=function(e,t){return registerListener(this,e)},e.prototype.intercept=function(e){return registerInterceptor(this,e)},e.prototype.toJS=function(){return new Set(this)},e.prototype.toString=function(){return this.name+"[ "+Array.from(this).join(", ")+" ]"},e.prototype[_a$1=$mobx,Symbol.iterator]=function(){return this.values()},e}(),isObservableSet=createInstanceofPredicate("ObservableSet",ObservableSet),ObservableObjectAdministration=function(){function e(e,t,r,i){void 0===t&&(t=new Map),this.target=e,this.values=t,this.name=r,this.defaultEnhancer=i,this.keysAtom=new Atom(r+".keys")}return e.prototype.read=function(e){return this.values.get(e).get()},e.prototype.write=function(e,t){var r=this.target,i=this.values.get(e);if(i instanceof ComputedValue)i.set(t);else{if(hasInterceptors(this)){if(!(s=interceptChange(this,{type:"update",object:this.proxy||r,name:e,newValue:t})))return;t=s.newValue}if((t=i.prepareNewValue(t))!==globalState.UNCHANGED){var n=hasListeners(this),a=isSpyEnabled(),s=n||a?{type:"update",object:this.proxy||r,oldValue:i.value,name:e,newValue:t}:null;0,i.setNewValue(t),n&&notifyListeners(this,s)}}},e.prototype.has=function(e){var t=this.pendingKeys||(this.pendingKeys=new Map),r=t.get(e);if(r)return r.get();var i=!!this.values.get(e);return r=new ObservableValue(i,referenceEnhancer,this.name+"."+stringifyKey(e)+"?",!1),t.set(e,r),r.get()},e.prototype.addObservableProp=function(e,t,r){void 0===r&&(r=this.defaultEnhancer);var i=this.target;if(hasInterceptors(this)){var n=interceptChange(this,{object:this.proxy||i,name:e,type:"add",newValue:t});if(!n)return;t=n.newValue}var a=new ObservableValue(t,r,this.name+"."+stringifyKey(e),!1);this.values.set(e,a),t=a.value,Object.defineProperty(i,e,generateObservablePropConfig(e)),this.notifyPropertyAddition(e,t)},e.prototype.addComputedProp=function(e,t,r){var i=this.target;r.name=r.name||this.name+"."+stringifyKey(t),this.values.set(t,new ComputedValue(r)),e!==i&&!isPropertyConfigurable(e,t)||Object.defineProperty(e,t,generateComputedPropConfig(t))},e.prototype.remove=function(e){if(this.values.has(e)){var t=this.target;if(hasInterceptors(this))if(!(o=interceptChange(this,{object:this.proxy||t,name:e,type:"remove"})))return;try{startBatch();var r=hasListeners(this),i=isSpyEnabled(),n=this.values.get(e),a=n&&n.get();if(n&&n.set(void 0),this.keysAtom.reportChanged(),this.values.delete(e),this.pendingKeys){var s=this.pendingKeys.get(e);s&&s.set(!1)}delete this.target[e];var o=r||i?{type:"remove",object:this.proxy||t,oldValue:a,name:e}:null;0,r&&notifyListeners(this,o)}finally{endBatch()}}},e.prototype.illegalAccess=function(e,t){console.warn("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(e,t){return registerListener(this,e)},e.prototype.intercept=function(e){return registerInterceptor(this,e)},e.prototype.notifyPropertyAddition=function(e,t){var r=hasListeners(this),i=isSpyEnabled(),n=r||i?{type:"add",object:this.proxy||this.target,name:e,newValue:t}:null;if(r&&notifyListeners(this,n),this.pendingKeys){var a=this.pendingKeys.get(e);a&&a.set(!0)}this.keysAtom.reportChanged()},e.prototype.getKeys=function(){var t,e;this.keysAtom.reportObserved();var r=[];try{for(var i=__values(this.values),n=i.next();!n.done;n=i.next()){var a=__read(n.value,2),s=a[0];a[1]instanceof ObservableValue&&r.push(s)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return r},e}();function asObservableObject(e,t,r){if(void 0===t&&(t=""),void 0===r&&(r=deepEnhancer),Object.prototype.hasOwnProperty.call(e,$mobx))return e[$mobx];isPlainObject(e)||(t=(e.constructor.name||"ObservableObject")+"@"+getNextId()),t=t||"ObservableObject@"+getNextId();var i=new ObservableObjectAdministration(e,new Map,stringifyKey(t),r);return addHiddenProp(e,$mobx,i),i}var observablePropertyConfigs=Object.create(null),computedPropertyConfigs=Object.create(null);function generateObservablePropConfig(t){return observablePropertyConfigs[t]||(observablePropertyConfigs[t]={configurable:!0,enumerable:!0,get:function(){return this[$mobx].read(t)},set:function(e){this[$mobx].write(t,e)}})}function getAdministrationForComputedPropOwner(e){var t=e[$mobx];return t||(initializeInstance(e),e[$mobx])}function generateComputedPropConfig(t){return computedPropertyConfigs[t]||(computedPropertyConfigs[t]={configurable:globalState.computedConfigurable,enumerable:!1,get:function(){return getAdministrationForComputedPropOwner(this).read(t)},set:function(e){getAdministrationForComputedPropOwner(this).write(t,e)}})}var isObservableObjectAdministration=createInstanceofPredicate("ObservableObjectAdministration",ObservableObjectAdministration);function isObservableObject(e){return!!isObject(e)&&(initializeInstance(e),isObservableObjectAdministration(e[$mobx]))}function getAtom(e,t){if("object"==typeof e&&null!==e){if(isObservableArray(e))return void 0!==t&&fail(!1),e[$mobx].atom;if(isObservableSet(e))return e[$mobx];if(isObservableMap(e)){var r=e;return void 0===t?r._keysAtom:((i=r._data.get(t)||r._hasMap.get(t))||fail(!1),i)}var i;if(initializeInstance(e),t&&!e[$mobx]&&e[t],isObservableObject(e))return t?((i=e[$mobx].values.get(t))||fail(!1),i):fail(!1);if(isAtom(e)||isComputedValue(e)||isReaction(e))return e}else if("function"==typeof e&&isReaction(e[$mobx]))return e[$mobx];return fail(!1)}function getAdministration(e,t){return e||fail("Expecting some object"),void 0!==t?getAdministration(getAtom(e,t)):isAtom(e)||isComputedValue(e)||isReaction(e)||isObservableMap(e)||isObservableSet(e)?e:(initializeInstance(e),e[$mobx]?e[$mobx]:void fail(!1))}function getDebugName(e,t){return(void 0!==t?getAtom(e,t):(isObservableObject(e)||isObservableMap(e)||isObservableSet(e)?getAdministration:getAtom)(e)).name}var g,toString=Object.prototype.toString;function deepEqual(e,t,r){return void 0===r&&(r=-1),eq(e,t,r)}function eq(e,t,r,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var a=typeof e;if("function"!=a&&"object"!=a&&"object"!=typeof t)return!1;var s=toString.call(e);if(s!==toString.call(t))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":0<=r&&r++}e=unwrap(e),t=unwrap(t);var o="[object Array]"===s;if(!o){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,u=t.constructor;if(l!==u&&!("function"==typeof l&&l instanceof l&&"function"==typeof u&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1}if(0===r)return!1;r<0&&(r=-1),n=n||[];for(var c=(i=i||[]).length;c--;)if(i[c]===e)return n[c]===t;if(i.push(e),n.push(t),o){if((c=e.length)!==t.length)return!1;for(;c--;)if(!eq(e[c],t[c],r-1,i,n))return!1}else{var d=Object.keys(e),f=void 0;if(c=d.length,Object.keys(t).length!==c)return!1;for(;c--;)if(!has$1(t,f=d[c])||!eq(e[f],t[f],r-1,i,n))return!1}return i.pop(),n.pop(),!0}function unwrap(e){return isObservableArray(e)?e.slice():isES6Map(e)||isObservableMap(e)||isES6Set(e)||isObservableSet(e)?Array.from(e.entries()):e}function has$1(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function makeIterable(e){return e[Symbol.iterator]=getSelf,e}function getSelf(){return this}if("undefined"==typeof Proxy||"undefined"==typeof Symbol)throw new Error("[mobx] MobX 5+ requires Proxy and Symbol objects. If your environment doesn't support Symbol or Proxy objects, please downgrade to MobX 4. For React Native Android, consider upgrading JSCore.");"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:spy,extras:{getDebugName:getDebugName},$mobx:$mobx});var _dec,_dec2,_dec3,_class,_descriptor,_descriptor2,_descriptor3,_temp,_dec$1,_class$1,_descriptor$1,_temp$1,_dec$2,_dec2$1,_class$2,_descriptor$2,_temp$2,autorunConfig={},isNullOrUndefined=function(e){return null==e},timeoutId=null,timeout=2e3,Controls=(_dec=action.bound,_dec2=action.bound,_dec3=action.bound,_descriptor=_applyDecoratedDescriptor((_class=_temp=function(){function t(e){_classCallCheck(this,t),_initializerDefineProperty(this,"alwaysOn",_descriptor,this),_initializerDefineProperty(this,"display",_descriptor2,this),_initializerDefineProperty(this,"isMouseOnControls",_descriptor3,this),this.root=e}return _createClass(t,[{key:"updateAlwaysOn",value:function(e){this.alwaysOn=e,this.updateShowControls(!0)}},{key:"updateShowControls",value:function(e){this.alwaysOn||this.root.currentState!==PLAYING&&this.root.currentState!==PAUSED||!browserDetection.isMobileOrTablet&&this.isMouseOnControls||e?this.display=!0:this.display=!1}},{key:"updateIsMouseOnControls",value:function(e){this.isMouseOnControls=e}},{key:"setShowControlsTimeout",value:function(e){var t=this,r=0<arguments.length&&void 0!==e?e:null;this.alwaysOn||(this.updateShowControls(!0),clearTimeout(timeoutId),timeoutId=null,timeoutId=setTimeout(function(){t.updateShowControls(!1)},r||timeout))}},{key:"clearShowControlsTimeout",value:function(e){this.alwaysOn||(clearTimeout(timeoutId),timeoutId=null,isNullOrUndefined(e)||this.updateShowControls(e))}},{key:"getState",value:function(){return{showControls:this.showControls,alwaysOn:this.alwaysOn,isMouseOnControls:this.isMouseOnControls}}},{key:"showControls",get:function(){return!isErrorState(this.root.currentState)&&(this.root.currentState===READY||this.root.currentState===INITIALISING||!browserDetection.isMobileOrTablet&&this.root.currentState===PAUSED||this.display||!browserDetection.isMobileOrTablet&&this.isMouseOnControls)}}]),t}()).prototype,"alwaysOn",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor2=_applyDecoratedDescriptor(_class.prototype,"display",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor3=_applyDecoratedDescriptor(_class.prototype,"isMouseOnControls",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_applyDecoratedDescriptor(_class.prototype,"updateAlwaysOn",[_dec],Object.getOwnPropertyDescriptor(_class.prototype,"updateAlwaysOn"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"updateShowControls",[_dec2],Object.getOwnPropertyDescriptor(_class.prototype,"updateShowControls"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"updateIsMouseOnControls",[_dec3],Object.getOwnPropertyDescriptor(_class.prototype,"updateIsMouseOnControls"),_class.prototype),_applyDecoratedDescriptor(_class.prototype,"showControls",[computed],Object.getOwnPropertyDescriptor(_class.prototype,"showControls"),_class.prototype),_class),ErrorMessage=(_dec$1=action.bound,_descriptor$1=_applyDecoratedDescriptor((_class$1=_temp$1=function(){function t(e){_classCallCheck(this,t),_initializerDefineProperty(this,"message",_descriptor$1,this),this.root=e}return _createClass(t,[{key:"getState",value:function(){return{isVisible:this.isVisible,message:this.message}}},{key:"update",value:function(e){var t=0<arguments.length&&void 0!==e?e:"Something went wrong!";this.message=t}},{key:"isVisible",get:function(){return isErrorState(this.root.currentState)&&""!==this.message}}]),t}()).prototype,"message",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_applyDecoratedDescriptor(_class$1.prototype,"isVisible",[computed],Object.getOwnPropertyDescriptor(_class$1.prototype,"isVisible"),_class$1.prototype),_applyDecoratedDescriptor(_class$1.prototype,"update",[_dec$1],Object.getOwnPropertyDescriptor(_class$1.prototype,"update"),_class$1.prototype),_class$1),LayerStates=(_dec$2=action.bound,_dec2$1=action.bound,_descriptor$2=_applyDecoratedDescriptor((_class$2=_temp$2=function(){function t(e){_classCallCheck(this,t),_initializerDefineProperty(this,"layerStates",_descriptor$2,this),this.root=e}return _createClass(t,[{key:"getState",value:function(){return this.layerStates}},{key:"reset",value:function(){this.layerStates.splice(0,this.layerStates.length)}},{key:"addLayerState",value:function(t){this.layerStates.find(function(e){return e.name===t})||this.layerStates.push({name:t,timeApplied:this.root.currentTime})}}]),t}()).prototype,"layerStates",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),_applyDecoratedDescriptor(_class$2.prototype,"reset",[_dec$2],Object.getOwnPropertyDescriptor(_class$2.prototype,"reset"),_class$2.prototype),_applyDecoratedDescriptor(_class$2.prototype,"addLayerState",[_dec2$1],Object.getOwnPropertyDescriptor(_class$2.prototype,"addLayerState"),_class$2.prototype),_class$2),getWillChangeStyle=function(e){var t=[];return e.transform&&t.push("transform"),e.opacity&&t.push("opacity"),0<t.length?_objectSpread2(_objectSpread2({},e),{},{"will-change":t}):e},omitNullProps=function(r,e){var i=1<arguments.length&&void 0!==e?e:function(){return!0},n={};return Object.keys(r).forEach(function(e){var t=r[e];null!=t&&i(t)&&(n[e]=t)}),n},normaliseTransformScale=function(e){var t=e.scale,r=e.scaleX,i=e.scaleY;return r===i&&r?{scale:r}:omitNullProps({scale:t,scaleX:r,scaleY:i})},hasValue=function(e){return e||0===e},hasScaling=function(e){var t=e.scale,r=e.scaleX,i=e.scaleY;return hasValue(t)||hasValue(r)||hasValue(i)},combineTransformScaleStyles=function(){return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(hasScaling(e)||hasScaling(t)){if(hasScaling(e)&&hasScaling(t)){var r={};return hasValue(t.scale)?{scale:t.scale}:(hasValue(t.scaleX)?(r=_objectSpread2(_objectSpread2({},r),{},{scaleX:t.scaleX}),hasValue(e.scale)&&!hasValue(t.scaleY)&&(r=_objectSpread2(_objectSpread2({},r),{},{scaleY:e.scale}))):hasValue(e.scaleX)&&(r=_objectSpread2(_objectSpread2({},r),{},{scaleX:e.scaleX})),hasValue(t.scaleY)?(r=_objectSpread2(_objectSpread2({},r),{},{scaleY:t.scaleY}),hasValue(e.scale)&&!hasValue(t.scaleX)&&(r=_objectSpread2(_objectSpread2({},r),{},{scaleX:e.scale}))):hasValue(e.scaleY)&&(r=_objectSpread2(_objectSpread2({},r),{},{scaleY:e.scaleY})),normaliseTransformScale(r))}return hasScaling(e)?normaliseTransformScale(e):normaliseTransformScale(t)}return{}}},excludeScaling=function(e){e.scale,e.scaleX,e.scaleY;return _objectWithoutProperties(e,["scale","scaleX","scaleY"])},mergeTransformStyle=function(){return function(e,t){return e.transform&&t.transform?_objectSpread2(_objectSpread2(_objectSpread2({},e),t),{},{transform:_objectSpread2(_objectSpread2(_objectSpread2({},excludeScaling(e.transform)),excludeScaling(t.transform)),combineTransformScaleStyles()(e.transform,t.transform))}):_objectSpread2(_objectSpread2({},e),t)}},calculateIndexValue=function(e,t,r){return t===e?t||0:t<e?(e-t)*(1-r)||0:r*t||0},opacity=function(){return function(e,t){var r=e.toValue,i=e.fromValue;return{opacity:calculateIndexValue(i,r,t)}}},calculateValue=function(e,t,r){return t===e?t||0:t<e||e<0?e-(e-t)*r||0:r*(t-e)+e||0},position=function(){return function(e,t){var r=e.toValue,i=e.fromValue;return{transform:{translate:{values:[calculateValue(i[0],r[0],t),calculateValue(i[1],r[1],t)],unit:"px"}}}}},transform_scale=function(){return function(e,t){var r=e.toValue,i=e.fromValue;return{transform:{scale:calculateValue(i,r,t)}}}},transform_scale_x=function(){return function(e,t){var r=e.toValue,i=e.fromValue;return{transform:{scaleX:calculateValue(i,r,t)}}}},transform_scale_y=function(){return function(e,t){var r=e.toValue,i=e.fromValue;return{transform:{scaleY:calculateValue(i,r,t)}}}},transform_rotation=function(){return function(e,t){var r=e.toValue,i=e.fromValue;return{transform:{rotate:{value:calculateValue(-1*i,-1*r,t),unit:"rad"}}}}},transform_rotation3d=function(){return function(e,t){var r=e.toValue,i=e.fromValue,n=i[3],a=r[3];return{transform:{rotate3d:{value:[i[0],i[1],i[2],calculateValue(n,a,t)],unit:"deg"}}}}},animationMap={position:position,opacity:opacity,transform_scale:transform_scale,transform_scale_x:transform_scale_x,transform_scale_y:transform_scale_y,transform_rotation:transform_rotation,transform_rotation3d:transform_rotation3d},resolveAnimation=function(e){var t=animationMap[e];if(t)return t(e);throw Error("Animation: ".concat(e," not found"))},c0x=0,c0y=0,c1x=.42,c1y=0,c2x=.58,c2y=1.1,c3x=1,c3y=1,coefficientsX=[c0x,-3*c0x+3*c1x,3*c0x-6*c1x+3*c2x,3*c1x-c0x-3*c2x+c3x],coefficientsY=[c0y,-3*c0y+3*c1y,3*c0y-6*c1y+3*c2y,3*c1y-c0y-3*c2y+c3y],evaluateAtParameterWithCoefficients=function(e,t){return t[0]+e*t[1]+e*e*t[2]+e*e*e*t[3]},evaluateDerivationAtParameterWithCoefficients=function(e,t){return t[1]+2*e*t[2]+3*e*e*t[3]},calcParameterViaNewtonRaphsonUsingXAndCoefficientsForX=function(e,t){for(var r=e,i=0;i<10;i++){r-=(evaluateAtParameterWithCoefficients(r,t)-e)/evaluateDerivationAtParameterWithCoefficients(r,t)}return r},calcParameterUsingXAndCoefficientsForX=function(e,t){return calcParameterViaNewtonRaphsonUsingXAndCoefficientsForX(e,t)},evaluateYAtX=function(e){var t=calcParameterUsingXAndCoefficientsForX(e,coefficientsX);return evaluateAtParameterWithCoefficients(t,coefficientsY)},calculatePercent=function(e,t,r){var i=(e-t)/r;return 1<i?1:i},normalisePercent=function(e){return 1<e?1:e},getStylesFromAnimation=function(){return function(e){var t=e.absoluteBeginTime,r=e.animation,i=r.keyPath,n=r.beginTime,a=r.duration,s=r.toValue,o=r.fromValue,l=r.autoRepeats,u=void 0===l?"NO":l,c=r.autoReverses,d=void 0===c?"NO":c,f=r.repeatCount,h=void 0===f?null:f,p=_objectWithoutProperties(r,["keyPath","beginTime","duration","toValue","fromValue","autoRepeats","autoReverses","repeatCount"]),g=e.currentTime,m=n+t;if(m<=g){var y=m,v=g-(m+a),b=parseInt(Math.ceil(v/a),10),S="yes"===u.toLowerCase(),T="yes"===d.toLowerCase(),_=m+a<g,I=T&&_,M=T&&h?2*h+1:h;_&&S&&(!M||b<=M)?(y=m+b*a,I=T&&0<b%2):_&&T&&!S&&(y=m+a);var A=normalisePercent(evaluateYAtX(calculatePercent(g,y,a)));return I&&(A=1-A),resolveAnimation(i)(_objectSpread2({toValue:s,fromValue:o},p),A)}return{}}},adjustSizeFromAspectRatio=function(e,t){var r=1<arguments.length&&void 0!==t?t:1;return(e||0===e)&&parseFloat(e)*r||0},adjustTransformSize=function(e,t){if(0<Object.keys(e).length){var r=e.translate,i=_objectWithoutProperties(e,["translate"]);return omitNullProps(_objectSpread2({translate:r?_objectSpread2(_objectSpread2({},r),{},{values:[adjustSizeFromAspectRatio(r.values[0],t),adjustSizeFromAspectRatio(r.values[1],t)]}):null},i))}return null},adjustFontSize=function(e,t){var r=e["font-size"]?adjustSizeFromAspectRatio(e["font-size"].value,t):null;return r?{value:r,unit:"px"}:null},adjustLineHeight=function(e,t){var r=e["line-height"]?adjustSizeFromAspectRatio(e["line-height"].value,t):null;return r?{value:r,unit:"px"}:null},adjustLetterSpacing=function(e,t){var r=e["letter-spacing"]?adjustSizeFromAspectRatio(e["letter-spacing"].value,t):null;return r?{value:r,unit:"px"}:null},adjustBoxShadowSize=function(e,t){var r=null;if(e["box-shadow"]){var i=e["box-shadow"].offset,n=e["box-shadow"].radius,a=e["box-shadow"].color;r={offset:_objectSpread2(_objectSpread2({},i),{},{value:[adjustSizeFromAspectRatio(i.value[0],t),adjustSizeFromAspectRatio(i.value[1],t)]}),radius:_objectSpread2(_objectSpread2({},n),{},{value:adjustSizeFromAspectRatio(n.value,t)}),color:a}}return r},adjustBorderRadiusSize=function(e,r){var t=e["border-radius"];return t?"".concat(t).split(" ").reduce(function(e,t){return"".concat(e," ").concat(parseInt(adjustSizeFromAspectRatio(t,r),10),"px")},"").trim():null},adjustPaddingSize=function(e,t){var r=null;e&&(r={values:e.values.map(function(e){return adjustSizeFromAspectRatio(e,t)}),unit:"px"});return r},adjustSizing=function(e,t,r){return omitNullProps(_objectSpread2(_objectSpread2({},t),{},{transform:t.transform?adjustTransformSize(t.transform,r.aspectRatioPercent):null,"border-radius":adjustBorderRadiusSize(t,r.aspectRatioPercent),left:_objectSpread2(_objectSpread2({},t.left),{},{value:adjustSizeFromAspectRatio(t.left.value,r.aspectRatioPercent)}),top:_objectSpread2(_objectSpread2({},t.top),{},{value:adjustSizeFromAspectRatio(t.top.value,r.aspectRatioPercent)}),height:t.height?_objectSpread2(_objectSpread2({},t.height),{},{value:adjustSizeFromAspectRatio(t.height.value,r.aspectRatioPercent)}):null,width:t.width?_objectSpread2(_objectSpread2({},t.width),{},{value:adjustSizeFromAspectRatio(t.width.value,r.aspectRatioPercent)}):null,"font-size":adjustFontSize(t,r.aspectRatioPercent),"line-height":adjustLineHeight(t,r.aspectRatioPercent),"letter-spacing":adjustLetterSpacing(t,r.aspectRatioPercent),"box-shadow":adjustBoxShadowSize(t,r.aspectRatioPercent),padding:adjustPaddingSize(t.padding,r.aspectRatioPercent),textPadding:adjustPaddingSize(t.textPadding,r.aspectRatioPercent)}),function(e){return"object"!==_typeof(e)||null!==e.value})},adjustTransformTranslate=function(e){var t=e.height,r=e.width,i=_objectWithoutProperties(e,["height","width"]),n=i.transform||{},a=n.scale,s=n.scaleX,o=n.scaleY,l=n.translate;if(!l)return _objectSpread2({height:t,width:r},i);if(l&&(a||s||o)){var u=i["transform-origin"].values,c=l;return c=_objectSpread2(_objectSpread2({},c),{},{values:[c.values[0]-r.value*(u[0]/100-.5),c.values[1]-t.value*(u[1]/100-.5)]}),_objectSpread2(_objectSpread2({},i),{},{height:t,width:r,transform:_objectSpread2(_objectSpread2({},i.transform),{},{translate:c})})}return _objectSpread2(_objectSpread2({},i),{},{height:t,width:r})},combinePositionAndTranslate=function(e){var t=e.transform&&e.transform.translate;return _objectSpread2(_objectSpread2({},e),{},{left:_objectSpread2(_objectSpread2({},e.left),{},{value:t?0:e.left.value}),top:_objectSpread2(_objectSpread2({},e.top),{},{value:t?0:e.top.value})})},hasHeight=function(e){return 0<e.value},hasWidth=function(e){return 0<e.value},hasOpacity=function(e){return 0<e},hasScale=function(e){var t=e.scale,r=void 0===t?1:t,i=e.scaleX,n=void 0===i?1:i,a=e.scaleY;return 0<r&&0<n&&0<(void 0===a?1:a)},hasRotate=function(e){return void 0!==e&&0<e},isWithinViewport=function(e,t,r,i,n,a){var s=0<arguments.length&&void 0!==e?e:{value:0},o=1<arguments.length&&void 0!==t?t:{value:0},l=2<arguments.length&&void 0!==r?r:{value:0},u=3<arguments.length&&void 0!==i?i:{value:0},c=4<arguments.length?n:void 0,d=c.scale,f=void 0===d?1:d,h=c.scaleX,p=void 0===h?1:h,g=c.scaleY,m=void 0===g?1:g,y=c.translate,v=void 0===y?{values:[0,0]}:y,b=c.rotate,S=5<arguments.length?a:void 0;if(hasRotate(b))return!0;var T=s.value+v.values[0],_=o.value+v.values[1],I=T+l.value*f*p,M=_+u.value*f*m;return!(T>=S.right||_>=S.bottom)&&!(T<=0&&I<=0||_<=0&&M<=0)},isLayerVisible=function(e,t){var r=e.opacity,i=void 0===r?1:r,n=e.transform,a=void 0===n?{}:n,s=e.top,o=e.left,l=e.height,u=void 0===l?0:l,c=e.width,d=void 0===c?0:c;return hasHeight(u)&&hasWidth(d)&&hasOpacity(i)&&hasScale(a)&&isWithinViewport(o,s,d,u,a,t)},moment=createCommonjsModule(function(ls,e){ls.exports=function(){var t,n;function c(){return t.apply(null,arguments)}function e(e){t=e}function s(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function o(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(e).length===0}else{var t;for(t in e){if(l(e,t)){return false}}return true}}function a(e){return e===void 0}function d(e){return typeof e==="number"||Object.prototype.toString.call(e)==="[object Number]"}function f(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function i(e,t){var r=[],i;for(i=0;i<e.length;++i){r.push(t(e[i],i))}return r}function h(e,t){for(var r in t){if(l(t,r)){e[r]=t[r]}}if(l(t,"toString")){e.toString=t.toString}if(l(t,"valueOf")){e.valueOf=t.valueOf}return e}function p(e,t,r,i){return Wr(e,t,r,i,true).utc()}function r(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function g(e){if(e._pf==null){e._pf=r()}return e._pf}if(Array.prototype.some){n=Array.prototype.some}else{n=function(e){var t=Object(this),r=t.length>>>0,i;for(i=0;i<r;i++){if(i in t&&e.call(this,t[i],i,t)){return true}}return false}}function m(e){if(e._isValid==null){var t=g(e),r=n.call(t.parsedDateParts,function(e){return e!=null}),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict){i=i&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(e)){e._isValid=i}else{return i}}return e._isValid}function y(e){var t=p(NaN);if(e!=null){h(g(t),e)}else{g(t).userInvalidated=true}return t}var v=c.momentProperties=[],b=false;function S(e,t){var r,i,n;if(!a(t._isAMomentObject)){e._isAMomentObject=t._isAMomentObject}if(!a(t._i)){e._i=t._i}if(!a(t._f)){e._f=t._f}if(!a(t._l)){e._l=t._l}if(!a(t._strict)){e._strict=t._strict}if(!a(t._tzm)){e._tzm=t._tzm}if(!a(t._isUTC)){e._isUTC=t._isUTC}if(!a(t._offset)){e._offset=t._offset}if(!a(t._pf)){e._pf=g(t)}if(!a(t._locale)){e._locale=t._locale}if(v.length>0){for(r=0;r<v.length;r++){i=v[r];n=t[i];if(!a(n)){e[i]=n}}}return e}function T(e){S(this,e);this._d=new Date(e._d!=null?e._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(b===false){b=true;c.updateOffset(this);b=false}}function _(e){return e instanceof T||e!=null&&e._isAMomentObject!=null}function I(e){if(c.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+e)}}function M(n,a){var s=true;return h(function(){if(c.deprecationHandler!=null){c.deprecationHandler(null,n)}if(s){var e=[],t,r,i;for(r=0;r<arguments.length;r++){t="";if(typeof arguments[r]==="object"){t+="\n["+r+"] ";for(i in arguments[0]){if(l(arguments[0],i)){t+=i+": "+arguments[0][i]+", "}}t=t.slice(0,-2)}else{t=arguments[r]}e.push(t)}I(n+"\nArguments: "+Array.prototype.slice.call(e).join("")+"\n"+(new Error).stack);s=false}return a.apply(this,arguments)},a)}var A={},D;function w(e,t){if(c.deprecationHandler!=null){c.deprecationHandler(e,t)}if(!A[e]){I(t);A[e]=true}}function E(e){return typeof Function!=="undefined"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function C(e){var t,r;for(r in e){if(l(e,r)){t=e[r];if(E(t)){this[r]=t}else{this["_"+r]=t}}}this._config=e;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function L(e,t){var r=h({},e),i;for(i in t){if(l(t,i)){if(o(e[i])&&o(t[i])){r[i]={};h(r[i],e[i]);h(r[i],t[i])}else if(t[i]!=null){r[i]=t[i]}else{delete r[i]}}}for(i in e){if(l(e,i)&&!l(t,i)&&o(e[i])){r[i]=h({},r[i])}}return r}function O(e){if(e!=null){this.set(e)}}if(c.suppressDeprecationWarnings=false,c.deprecationHandler=null,Object.keys){D=Object.keys}else{D=function(e){var t,r=[];for(t in e){if(l(e,t)){r.push(t)}}return r}}var N={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function k(e,t,r){var i=this._calendar[e]||this._calendar["sameElse"];return E(i)?i.call(t,r):i}function x(e,t,r){var i=""+Math.abs(e),n=t-i.length,a=e>=0;return(a?r?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+i}var R=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,j=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,P={},z={};function F(e,t,r,i){var n=i;if(typeof i==="string"){n=function(){return this[i]()}}if(e){z[e]=n}if(t){z[t[0]]=function(){return x(n.apply(this,arguments),t[1],t[2])}}if(r){z[r]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)}}}function U(e){if(e.match(/\[[\s\S]/)){return e.replace(/^\[|\]$/g,"")}return e.replace(/\\/g,"")}function B(i){var n=i.match(R),e,a;for(e=0,a=n.length;e<a;e++){if(z[n[e]]){n[e]=z[n[e]]}else{n[e]=U(n[e])}}return function(e){var t="",r;for(r=0;r<a;r++){t+=E(n[r])?n[r].call(e,i):n[r]}return t}}function Y(e,t){if(!e.isValid()){return e.localeData().invalidDate()}t=G(t,e.localeData());P[t]=P[t]||B(t);return P[t](e)}function G(e,t){var r=5;function i(e){return t.longDateFormat(e)||e}j.lastIndex=0;while(r>=0&&j.test(e)){e=e.replace(j,i);j.lastIndex=0;r-=1}return e}var V={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function W(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];if(t||!r){return t}this._longDateFormat[e]=r.match(R).map(function(e){if(e==="MMMM"||e==="MM"||e==="DD"||e==="dddd"){return e.slice(1)}return e}).join("");return this._longDateFormat[e]}var H="Invalid date";function $(){return this._invalidDate}var Q="%d",K=/\d{1,2}/;function Z(e){return this._ordinal.replace("%d",e)}var X={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function J(e,t,r,i){var n=this._relativeTime[r];return E(n)?n(e,t,r,i):n.replace(/%d/i,e)}function q(e,t){var r=this._relativeTime[e>0?"future":"past"];return E(r)?r(t):r.replace(/%s/i,t)}var ee={};function te(e,t){var r=e.toLowerCase();ee[r]=ee[r+"s"]=ee[t]=e}function re(e){return typeof e==="string"?ee[e]||ee[e.toLowerCase()]:undefined}function ie(e){var t={},r,i;for(i in e){if(l(e,i)){r=re(i);if(r){t[r]=e[i]}}}return t}var ne={};function ae(e,t){ne[e]=t}function se(e){var t=[],r;for(r in e){if(l(e,r)){t.push({unit:r,priority:ne[r]})}}t.sort(function(e,t){return e.priority-t.priority});return t}function oe(e){return e%4===0&&e%100!==0||e%400===0}function le(e){if(e<0){return Math.ceil(e)||0}else{return Math.floor(e)}}function ue(e){var t=+e,r=0;if(t!==0&&isFinite(t)){r=le(t)}return r}function ce(t,r){return function(e){if(e!=null){fe(this,t,e);c.updateOffset(this,r);return this}else{return de(this,t)}}}function de(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function fe(e,t,r){if(e.isValid()&&!isNaN(r)){if(t==="FullYear"&&oe(e.year())&&e.month()===1&&e.date()===29){r=ue(r);e._d["set"+(e._isUTC?"UTC":"")+t](r,e.month(),Je(r,e.month()))}else{e._d["set"+(e._isUTC?"UTC":"")+t](r)}}}function he(e){e=re(e);if(E(this[e])){return this[e]()}return this}function pe(e,t){if(typeof e==="object"){e=ie(e);var r=se(e),i;for(i=0;i<r.length;i++){this[r[i].unit](e[r[i].unit])}}else{e=re(e);if(E(this[e])){return this[e](t)}}return this}var ge=/\d/,me=/\d\d/,ye=/\d{3}/,ve=/\d{4}/,be=/[+-]?\d{6}/,Se=/\d\d?/,Te=/\d\d\d\d?/,_e=/\d\d\d\d\d\d?/,Ie=/\d{1,3}/,Me=/\d{1,4}/,Ae=/[+-]?\d{1,6}/,De=/\d+/,we=/[+-]?\d+/,Ee=/Z|[+-]\d\d:?\d\d/gi,Ce=/Z|[+-]\d\d(?::?\d\d)?/gi,Le=/[+-]?\d+(\.\d{1,3})?/,Oe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ne;function ke(e,r,i){Ne[e]=E(r)?r:function(e,t){return e&&i?i:r}}function xe(e,t){if(!l(Ne,e)){return new RegExp(Re(e))}return Ne[e](t._strict,t._locale)}function Re(e){return je(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,i,n){return t||r||i||n}))}function je(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}Ne={};var Pe={};function ze(e,r){var t,i=r;if(typeof e==="string"){e=[e]}if(d(r)){i=function(e,t){t[r]=ue(e)}}for(t=0;t<e.length;t++){Pe[e[t]]=i}}function Fe(e,n){ze(e,function(e,t,r,i){r._w=r._w||{};n(e,r._w,r,i)})}function Ue(e,t,r){if(t!=null&&l(Pe,e)){Pe[e](t,r._a,r,e)}}var Be=0,Ye=1,Ge=2,Ve=3,We=4,He=5,$e=6,Qe=7,Ke=8,Ze;function Xe(e,t){return(e%t+t)%t}if(Array.prototype.indexOf){Ze=Array.prototype.indexOf}else{Ze=function(e){var t;for(t=0;t<this.length;++t){if(this[t]===e){return t}}return-1}}function Je(e,t){if(isNaN(e)||isNaN(t)){return NaN}var r=Xe(t,12);e+=(t-r)/12;return r===1?oe(e)?29:28:31-r%7%2}F("M",["MM",2],"Mo",function(){return this.month()+1}),F("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),F("MMMM",0,0,function(e){return this.localeData().months(this,e)}),te("month","M"),ae("month",8),ke("M",Se),ke("MM",Se,me),ke("MMM",function(e,t){return t.monthsShortRegex(e)}),ke("MMMM",function(e,t){return t.monthsRegex(e)}),ze(["M","MM"],function(e,t){t[Ye]=ue(e)-1}),ze(["MMM","MMMM"],function(e,t,r,i){var n=r._locale.monthsParse(e,i,r._strict);if(n!=null){t[Ye]=n}else{g(r).invalidMonth=e}});var qe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),et="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,rt=Oe,it=Oe;function nt(e,t){if(!e){return s(this._months)?this._months:this._months["standalone"]}return s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||tt).test(t)?"format":"standalone"][e.month()]}function at(e,t){if(!e){return s(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[tt.test(t)?"format":"standalone"][e.month()]}function st(e,t,r){var i,n,a,s=e.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){a=p([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(a,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(a,"").toLocaleLowerCase()}}if(r){if(t==="MMM"){n=Ze.call(this._shortMonthsParse,s);return n!==-1?n:null}else{n=Ze.call(this._longMonthsParse,s);return n!==-1?n:null}}else{if(t==="MMM"){n=Ze.call(this._shortMonthsParse,s);if(n!==-1){return n}n=Ze.call(this._longMonthsParse,s);return n!==-1?n:null}else{n=Ze.call(this._longMonthsParse,s);if(n!==-1){return n}n=Ze.call(this._shortMonthsParse,s);return n!==-1?n:null}}}function ot(e,t,r){var i,n,a;if(this._monthsParseExact){return st.call(this,e,t,r)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){n=p([2e3,i]);if(r&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")}if(!r&&!this._monthsParse[i]){a="^"+this.months(n,"")+"|^"+this.monthsShort(n,"");this._monthsParse[i]=new RegExp(a.replace(".",""),"i")}if(r&&t==="MMMM"&&this._longMonthsParse[i].test(e)){return i}else if(r&&t==="MMM"&&this._shortMonthsParse[i].test(e)){return i}else if(!r&&this._monthsParse[i].test(e)){return i}}}function lt(e,t){var r;if(!e.isValid()){return e}if(typeof t==="string"){if(/^\d+$/.test(t)){t=ue(t)}else{t=e.localeData().monthsParse(t);if(!d(t)){return e}}}r=Math.min(e.date(),Je(e.year(),t));e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,r);return e}function ut(e){if(e!=null){lt(this,e);c.updateOffset(this,true);return this}else{return de(this,"Month")}}function ct(){return Je(this.year(),this.month())}function dt(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex")){ht.call(this)}if(e){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!l(this,"_monthsShortRegex")){this._monthsShortRegex=rt}return this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}}function ft(e){if(this._monthsParseExact){if(!l(this,"_monthsRegex")){ht.call(this)}if(e){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!l(this,"_monthsRegex")){this._monthsRegex=it}return this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}}function ht(){function e(e,t){return t.length-e.length}var t=[],r=[],i=[],n,a;for(n=0;n<12;n++){a=p([2e3,n]);t.push(this.monthsShort(a,""));r.push(this.months(a,""));i.push(this.months(a,""));i.push(this.monthsShort(a,""))}t.sort(e);r.sort(e);i.sort(e);for(n=0;n<12;n++){t[n]=je(t[n]);r[n]=je(r[n])}for(n=0;n<24;n++){i[n]=je(i[n])}this._monthsRegex=new RegExp("^("+i.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function pt(e){return oe(e)?366:365}F("Y",0,0,function(){var e=this.year();return e<=9999?x(e,4):"+"+e}),F(0,["YY",2],0,function(){return this.year()%100}),F(0,["YYYY",4],0,"year"),F(0,["YYYYY",5],0,"year"),F(0,["YYYYYY",6,true],0,"year"),te("year","y"),ae("year",1),ke("Y",we),ke("YY",Se,me),ke("YYYY",Me,ve),ke("YYYYY",Ae,be),ke("YYYYYY",Ae,be),ze(["YYYYY","YYYYYY"],Be),ze("YYYY",function(e,t){t[Be]=e.length===2?c.parseTwoDigitYear(e):ue(e)}),ze("YY",function(e,t){t[Be]=c.parseTwoDigitYear(e)}),ze("Y",function(e,t){t[Be]=parseInt(e,10)}),c.parseTwoDigitYear=function(e){return ue(e)+(ue(e)>68?1900:2e3)};var gt=ce("FullYear",true);function mt(){return oe(this.year())}function yt(e,t,r,i,n,a,s){var o;if(e<100&&e>=0){o=new Date(e+400,t,r,i,n,a,s);if(isFinite(o.getFullYear())){o.setFullYear(e)}}else{o=new Date(e,t,r,i,n,a,s)}return o}function vt(e){var t,r;if(e<100&&e>=0){r=Array.prototype.slice.call(arguments);r[0]=e+400;t=new Date(Date.UTC.apply(null,r));if(isFinite(t.getUTCFullYear())){t.setUTCFullYear(e)}}else{t=new Date(Date.UTC.apply(null,arguments))}return t}function bt(e,t,r){var i=7+t-r,n=(7+vt(e,0,i).getUTCDay()-t)%7;return-n+i-1}function St(e,t,r,i,n){var a=(7+r-i)%7,s=bt(e,i,n),o=1+7*(t-1)+a+s,l,u;if(o<=0){l=e-1;u=pt(l)+o}else if(o>pt(e)){l=e+1;u=o-pt(e)}else{l=e;u=o}return{year:l,dayOfYear:u}}function Tt(e,t,r){var i=bt(e.year(),t,r),n=Math.floor((e.dayOfYear()-i-1)/7)+1,a,s;if(n<1){s=e.year()-1;a=n+_t(s,t,r)}else if(n>_t(e.year(),t,r)){a=n-_t(e.year(),t,r);s=e.year()+1}else{s=e.year();a=n}return{week:a,year:s}}function _t(e,t,r){var i=bt(e,t,r),n=bt(e+1,t,r);return(pt(e)-i+n)/7}function It(e){return Tt(e,this._week.dow,this._week.doy).week}F("w",["ww",2],"wo","week"),F("W",["WW",2],"Wo","isoWeek"),te("week","w"),te("isoWeek","W"),ae("week",5),ae("isoWeek",5),ke("w",Se),ke("ww",Se,me),ke("W",Se),ke("WW",Se,me),Fe(["w","ww","W","WW"],function(e,t,r,i){t[i.substr(0,1)]=ue(e)});var Mt={dow:0,doy:6};function At(){return this._week.dow}function Dt(){return this._week.doy}function wt(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function Et(e){var t=Tt(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}function Ct(e,t){if(typeof e!=="string"){return e}if(!isNaN(e)){return parseInt(e,10)}e=t.weekdaysParse(e);if(typeof e==="number"){return e}return null}function Lt(e,t){if(typeof e==="string"){return t.weekdaysParse(e)%7||7}return isNaN(e)?null:e}function Ot(e,t){return e.slice(t,7).concat(e.slice(0,t))}F("d",0,"do","day"),F("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),F("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),F("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),F("e",0,0,"weekday"),F("E",0,0,"isoWeekday"),te("day","d"),te("weekday","e"),te("isoWeekday","E"),ae("day",11),ae("weekday",11),ae("isoWeekday",11),ke("d",Se),ke("e",Se),ke("E",Se),ke("dd",function(e,t){return t.weekdaysMinRegex(e)}),ke("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ke("dddd",function(e,t){return t.weekdaysRegex(e)}),Fe(["dd","ddd","dddd"],function(e,t,r,i){var n=r._locale.weekdaysParse(e,i,r._strict);if(n!=null){t.d=n}else{g(r).invalidWeekday=e}}),Fe(["d","e","E"],function(e,t,r,i){t[i]=ue(e)});var Nt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),kt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),xt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Rt=Oe,jt=Oe,Pt=Oe;function zt(e,t){var r=s(this._weekdays)?this._weekdays:this._weekdays[e&&e!==true&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===true?Ot(r,this._week.dow):e?r[e.day()]:r}function Ft(e){return e===true?Ot(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Ut(e){return e===true?Ot(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Bt(e,t,r){var i,n,a,s=e.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){a=p([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(a,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(a,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(a,"").toLocaleLowerCase()}}if(r){if(t==="dddd"){n=Ze.call(this._weekdaysParse,s);return n!==-1?n:null}else if(t==="ddd"){n=Ze.call(this._shortWeekdaysParse,s);return n!==-1?n:null}else{n=Ze.call(this._minWeekdaysParse,s);return n!==-1?n:null}}else{if(t==="dddd"){n=Ze.call(this._weekdaysParse,s);if(n!==-1){return n}n=Ze.call(this._shortWeekdaysParse,s);if(n!==-1){return n}n=Ze.call(this._minWeekdaysParse,s);return n!==-1?n:null}else if(t==="ddd"){n=Ze.call(this._shortWeekdaysParse,s);if(n!==-1){return n}n=Ze.call(this._weekdaysParse,s);if(n!==-1){return n}n=Ze.call(this._minWeekdaysParse,s);return n!==-1?n:null}else{n=Ze.call(this._minWeekdaysParse,s);if(n!==-1){return n}n=Ze.call(this._weekdaysParse,s);if(n!==-1){return n}n=Ze.call(this._shortWeekdaysParse,s);return n!==-1?n:null}}}function Yt(e,t,r){var i,n,a;if(this._weekdaysParseExact){return Bt.call(this,e,t,r)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){n=p([2e3,1]).day(i);if(r&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[i]){a="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,"");this._weekdaysParse[i]=new RegExp(a.replace(".",""),"i")}if(r&&t==="dddd"&&this._fullWeekdaysParse[i].test(e)){return i}else if(r&&t==="ddd"&&this._shortWeekdaysParse[i].test(e)){return i}else if(r&&t==="dd"&&this._minWeekdaysParse[i].test(e)){return i}else if(!r&&this._weekdaysParse[i].test(e)){return i}}}function Gt(e){if(!this.isValid()){return e!=null?this:NaN}var t=this._isUTC?this._d.getUTCDay():this._d.getDay();if(e!=null){e=Ct(e,this.localeData());return this.add(e-t,"d")}else{return t}}function Vt(e){if(!this.isValid()){return e!=null?this:NaN}var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function Wt(e){if(!this.isValid()){return e!=null?this:NaN}if(e!=null){var t=Lt(e,this.localeData());return this.day(this.day()%7?t:t-7)}else{return this.day()||7}}function Ht(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!l(this,"_weekdaysRegex")){this._weekdaysRegex=Rt}return this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}}function $t(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!l(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=jt}return this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function Qt(e){if(this._weekdaysParseExact){if(!l(this,"_weekdaysRegex")){Kt.call(this)}if(e){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!l(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=Pt}return this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function Kt(){function e(e,t){return t.length-e.length}var t=[],r=[],i=[],n=[],a,s,o,l,u;for(a=0;a<7;a++){s=p([2e3,1]).day(a);o=je(this.weekdaysMin(s,""));l=je(this.weekdaysShort(s,""));u=je(this.weekdays(s,""));t.push(o);r.push(l);i.push(u);n.push(o);n.push(l);n.push(u)}t.sort(e);r.sort(e);i.sort(e);n.sort(e);this._weekdaysRegex=new RegExp("^("+n.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function Zt(){return this.hours()%12||12}function Xt(){return this.hours()||24}function Jt(e,t){F(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function qt(e,t){return t._meridiemParse}function er(e){return(e+"").toLowerCase().charAt(0)==="p"}F("H",["HH",2],0,"hour"),F("h",["hh",2],0,Zt),F("k",["kk",2],0,Xt),F("hmm",0,0,function(){return""+Zt.apply(this)+x(this.minutes(),2)}),F("hmmss",0,0,function(){return""+Zt.apply(this)+x(this.minutes(),2)+x(this.seconds(),2)}),F("Hmm",0,0,function(){return""+this.hours()+x(this.minutes(),2)}),F("Hmmss",0,0,function(){return""+this.hours()+x(this.minutes(),2)+x(this.seconds(),2)}),Jt("a",true),Jt("A",false),te("hour","h"),ae("hour",13),ke("a",qt),ke("A",qt),ke("H",Se),ke("h",Se),ke("k",Se),ke("HH",Se,me),ke("hh",Se,me),ke("kk",Se,me),ke("hmm",Te),ke("hmmss",_e),ke("Hmm",Te),ke("Hmmss",_e),ze(["H","HH"],Ve),ze(["k","kk"],function(e,t,r){var i=ue(e);t[Ve]=i===24?0:i}),ze(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e);r._meridiem=e}),ze(["h","hh"],function(e,t,r){t[Ve]=ue(e);g(r).bigHour=true}),ze("hmm",function(e,t,r){var i=e.length-2;t[Ve]=ue(e.substr(0,i));t[We]=ue(e.substr(i));g(r).bigHour=true}),ze("hmmss",function(e,t,r){var i=e.length-4,n=e.length-2;t[Ve]=ue(e.substr(0,i));t[We]=ue(e.substr(i,2));t[He]=ue(e.substr(n));g(r).bigHour=true}),ze("Hmm",function(e,t,r){var i=e.length-2;t[Ve]=ue(e.substr(0,i));t[We]=ue(e.substr(i))}),ze("Hmmss",function(e,t,r){var i=e.length-4,n=e.length-2;t[Ve]=ue(e.substr(0,i));t[We]=ue(e.substr(i,2));t[He]=ue(e.substr(n))});var tr,rr=ce("Hours",true);function ir(e,t,r){if(e>11){return r?"pm":"PM"}else{return r?"am":"AM"}}var nr={calendar:N,longDateFormat:V,invalidDate:H,ordinal:Q,dayOfMonthOrdinalParse:K,relativeTime:X,months:qe,monthsShort:et,week:Mt,weekdays:Nt,weekdaysMin:xt,weekdaysShort:kt,meridiemParse:/[ap]\.?m?\.?/i},ar={},sr={},or;function lr(e,t){var r,i=Math.min(e.length,t.length);for(r=0;r<i;r+=1){if(e[r]!==t[r]){return r}}return i}function ur(e){return e?e.toLowerCase().replace("_","-"):e}function cr(e){var t=0,r,i,n,a;while(t<e.length){a=ur(e[t]).split("-");r=a.length;i=ur(e[t+1]);i=i?i.split("-"):null;while(r>0){n=dr(a.slice(0,r).join("-"));if(n){return n}if(i&&i.length>=r&&lr(a,i)>=r-1){break}r--}t++}return or}function dr(t){var e=null,r;if(ar[t]===undefined&&"object"!=="undefined"&&ls&&ls.exports){try{e=or._abbr;r=commonjsRequire;r("./locale/"+t);fr(e)}catch(e){ar[t]=null}}return ar[t]}function fr(e,t){var r;if(e){if(a(t)){r=gr(e)}else{r=hr(e,t)}if(r){or=r}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+e+" not found. Did you forget to load it?")}}}return or._abbr}function hr(e,t){if(t!==null){var r,i=nr;t.abbr=e;if(ar[e]!=null){w("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");i=ar[e]._config}else if(t.parentLocale!=null){if(ar[t.parentLocale]!=null){i=ar[t.parentLocale]._config}else{r=dr(t.parentLocale);if(r!=null){i=r._config}else{if(!sr[t.parentLocale]){sr[t.parentLocale]=[]}sr[t.parentLocale].push({name:e,config:t});return null}}}ar[e]=new O(L(i,t));if(sr[e]){sr[e].forEach(function(e){hr(e.name,e.config)})}fr(e);return ar[e]}else{delete ar[e];return null}}function pr(e,t){if(null!=t){var r,i,n=nr;null!=ar[e]&&null!=ar[e].parentLocale?ar[e].set(L(ar[e]._config,t)):(null!=(i=dr(e))&&(n=i._config),t=L(n,t),null==i&&(t.abbr=e),(r=new O(t)).parentLocale=ar[e],ar[e]=r),fr(e)}else null!=ar[e]&&(null!=ar[e].parentLocale?(ar[e]=ar[e].parentLocale,e===fr()&&fr(e)):null!=ar[e]&&delete ar[e]);return ar[e]}function gr(e){var t;if(e&&e._locale&&e._locale._abbr){e=e._locale._abbr}if(!e){return or}if(!s(e)){t=dr(e);if(t){return t}e=[e]}return cr(e)}function mr(){return D(ar)}function yr(e){var t,r=e._a;if(r&&g(e).overflow===-2){t=r[Ye]<0||r[Ye]>11?Ye:r[Ge]<1||r[Ge]>Je(r[Be],r[Ye])?Ge:r[Ve]<0||r[Ve]>24||r[Ve]===24&&(r[We]!==0||r[He]!==0||r[$e]!==0)?Ve:r[We]<0||r[We]>59?We:r[He]<0||r[He]>59?He:r[$e]<0||r[$e]>999?$e:-1;if(g(e)._overflowDayOfYear&&(t<Be||t>Ge)){t=Ge}if(g(e)._overflowWeeks&&t===-1){t=Qe}if(g(e)._overflowWeekday&&t===-1){t=Ke}g(e).overflow=t}return e}var vr=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,br=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sr=/Z|[+-]\d\d(?::?\d\d)?/,Tr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],_r=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ir=/^\/?Date\((-?\d+)/i,Mr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ar={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function Dr(e){var t,r,i=e._i,n=vr.exec(i)||br.exec(i),a,s,o,l;if(n){g(e).iso=true;for(t=0,r=Tr.length;t<r;t++){if(Tr[t][1].exec(n[1])){s=Tr[t][0];a=Tr[t][2]!==false;break}}if(s==null){e._isValid=false;return}if(n[3]){for(t=0,r=_r.length;t<r;t++){if(_r[t][1].exec(n[3])){o=(n[2]||" ")+_r[t][0];break}}if(o==null){e._isValid=false;return}}if(!a&&o!=null){e._isValid=false;return}if(n[4]){if(Sr.exec(n[4])){l="Z"}else{e._isValid=false;return}}e._f=s+(o||"")+(l||"");zr(e)}else{e._isValid=false}}function wr(e,t,r,i,n,a){var s=[Er(e),et.indexOf(t),parseInt(r,10),parseInt(i,10),parseInt(n,10)];if(a){s.push(parseInt(a,10))}return s}function Er(e){var t=parseInt(e,10);if(t<=49){return 2e3+t}else if(t<=999){return 1900+t}return t}function Cr(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Lr(e,t,r){if(e){var i=kt.indexOf(e),n=new Date(t[0],t[1],t[2]).getDay();if(i!==n){g(r).weekdayMismatch=true;r._isValid=false;return false}}return true}function Or(e,t,r){if(e){return Ar[e]}else if(t){return 0}else{var i=parseInt(r,10),n=i%100,a=(i-n)/100;return a*60+n}}function Nr(e){var t=Mr.exec(Cr(e._i)),r;if(t){r=wr(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Lr(t[1],r,e)){return}e._a=r;e._tzm=Or(t[8],t[9],t[10]);e._d=vt.apply(null,e._a);e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm);g(e).rfc2822=true}else{e._isValid=false}}function kr(e){var t=Ir.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}Dr(e);if(e._isValid===false){delete e._isValid}else{return}Nr(e);if(e._isValid===false){delete e._isValid}else{return}if(e._strict){e._isValid=false}else{c.createFromInputFallback(e)}}function xr(e,t,r){if(e!=null){return e}if(t!=null){return t}return r}function Rr(e){var t=new Date(c.now());if(e._useUTC){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]}return[t.getFullYear(),t.getMonth(),t.getDate()]}function jr(e){var t,r,i=[],n,a,s;if(e._d){return}n=Rr(e);if(e._w&&e._a[Ge]==null&&e._a[Ye]==null){Pr(e)}if(e._dayOfYear!=null){s=xr(e._a[Be],n[Be]);if(e._dayOfYear>pt(s)||e._dayOfYear===0){g(e)._overflowDayOfYear=true}r=vt(s,0,e._dayOfYear);e._a[Ye]=r.getUTCMonth();e._a[Ge]=r.getUTCDate()}for(t=0;t<3&&e._a[t]==null;++t){e._a[t]=i[t]=n[t]}for(;t<7;t++){e._a[t]=i[t]=e._a[t]==null?t===2?1:0:e._a[t]}if(e._a[Ve]===24&&e._a[We]===0&&e._a[He]===0&&e._a[$e]===0){e._nextDay=true;e._a[Ve]=0}e._d=(e._useUTC?vt:yt).apply(null,i);a=e._useUTC?e._d.getUTCDay():e._d.getDay();if(e._tzm!=null){e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm)}if(e._nextDay){e._a[Ve]=24}if(e._w&&typeof e._w.d!=="undefined"&&e._w.d!==a){g(e).weekdayMismatch=true}}function Pr(e){var t,r,i,n,a,s,o,l,u;t=e._w;if(t.GG!=null||t.W!=null||t.E!=null){a=1;s=4;r=xr(t.GG,e._a[Be],Tt(Hr(),1,4).year);i=xr(t.W,1);n=xr(t.E,1);if(n<1||n>7){l=true}}else{a=e._locale._week.dow;s=e._locale._week.doy;u=Tt(Hr(),a,s);r=xr(t.gg,e._a[Be],u.year);i=xr(t.w,u.week);if(t.d!=null){n=t.d;if(n<0||n>6){l=true}}else if(t.e!=null){n=t.e+a;if(t.e<0||t.e>6){l=true}}else{n=a}}if(i<1||i>_t(r,a,s)){g(e)._overflowWeeks=true}else if(l!=null){g(e)._overflowWeekday=true}else{o=St(r,i,n,a,s);e._a[Be]=o.year;e._dayOfYear=o.dayOfYear}}function zr(e){if(e._f===c.ISO_8601){Dr(e);return}if(e._f===c.RFC_2822){Nr(e);return}e._a=[];g(e).empty=true;var t=""+e._i,r,i,n,a,s,o=t.length,l=0,u;n=G(e._f,e._locale).match(R)||[];for(r=0;r<n.length;r++){a=n[r];i=(t.match(xe(a,e))||[])[0];if(i){s=t.substr(0,t.indexOf(i));if(s.length>0){g(e).unusedInput.push(s)}t=t.slice(t.indexOf(i)+i.length);l+=i.length}if(z[a]){if(i){g(e).empty=false}else{g(e).unusedTokens.push(a)}Ue(a,i,e)}else if(e._strict&&!i){g(e).unusedTokens.push(a)}}g(e).charsLeftOver=o-l;if(t.length>0){g(e).unusedInput.push(t)}if(e._a[Ve]<=12&&g(e).bigHour===true&&e._a[Ve]>0){g(e).bigHour=undefined}g(e).parsedDateParts=e._a.slice(0);g(e).meridiem=e._meridiem;e._a[Ve]=Fr(e._locale,e._a[Ve],e._meridiem);u=g(e).era;if(u!==null){e._a[Be]=e._locale.erasConvertYear(u,e._a[Be])}jr(e);yr(e)}function Fr(e,t,r){var i;if(r==null){return t}if(e.meridiemHour!=null){return e.meridiemHour(t,r)}else if(e.isPM!=null){i=e.isPM(r);if(i&&t<12){t+=12}if(!i&&t===12){t=0}return t}else{return t}}function Ur(e){var t,r,i,n,a,s,o=false;if(e._f.length===0){g(e).invalidFormat=true;e._d=new Date(NaN);return}for(n=0;n<e._f.length;n++){a=0;s=false;t=S({},e);if(e._useUTC!=null){t._useUTC=e._useUTC}t._f=e._f[n];zr(t);if(m(t)){s=true}a+=g(t).charsLeftOver;a+=g(t).unusedTokens.length*10;g(t).score=a;if(!o){if(i==null||a<i||s){i=a;r=t;if(s){o=true}}}else{if(a<i){i=a;r=t}}}h(e,r||t)}function Br(e){if(e._d){return}var t=ie(e._i),r=t.day===undefined?t.date:t.day;e._a=i([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)});jr(e)}function Yr(e){var t=new T(yr(Gr(e)));if(t._nextDay){t.add(1,"d");t._nextDay=undefined}return t}function Gr(e){var t=e._i,r=e._f;e._locale=e._locale||gr(e._l);if(t===null||r===undefined&&t===""){return y({nullInput:true})}if(typeof t==="string"){e._i=t=e._locale.preparse(t)}if(_(t)){return new T(yr(t))}else if(f(t)){e._d=t}else if(s(r)){Ur(e)}else if(r){zr(e)}else{Vr(e)}if(!m(e)){e._d=null}return e}function Vr(e){var t=e._i;if(a(t)){e._d=new Date(c.now())}else if(f(t)){e._d=new Date(t.valueOf())}else if(typeof t==="string"){kr(e)}else if(s(t)){e._a=i(t.slice(0),function(e){return parseInt(e,10)});jr(e)}else if(o(t)){Br(e)}else if(d(t)){e._d=new Date(t)}else{c.createFromInputFallback(e)}}function Wr(e,t,r,i,n){var a={};if(t===true||t===false){i=t;t=undefined}if(r===true||r===false){i=r;r=undefined}if(o(e)&&u(e)||s(e)&&e.length===0){e=undefined}a._isAMomentObject=true;a._useUTC=a._isUTC=n;a._l=r;a._i=e;a._f=t;a._strict=i;return Yr(a)}function Hr(e,t,r,i){return Wr(e,t,r,i,false)}c.createFromInputFallback=M("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged and will be removed in an upcoming major release. Please refer to "+"http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),c.ISO_8601=function(){},c.RFC_2822=function(){};var $r=M("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Hr.apply(null,arguments);if(this.isValid()&&e.isValid()){return e<this?this:e}else{return y()}}),Qr=M("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Hr.apply(null,arguments);if(this.isValid()&&e.isValid()){return e>this?this:e}else{return y()}});function Kr(e,t){var r,i;if(t.length===1&&s(t[0])){t=t[0]}if(!t.length){return Hr()}r=t[0];for(i=1;i<t.length;++i){if(!t[i].isValid()||t[i][e](r)){r=t[i]}}return r}function Zr(){var e;return Kr("isBefore",[].slice.call(arguments,0))}function Xr(){var e;return Kr("isAfter",[].slice.call(arguments,0))}var Jr=function(){return Date.now?Date.now():+new Date},qr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ei(e){var t,r=false,i;for(t in e){if(l(e,t)&&!(Ze.call(qr,t)!==-1&&(e[t]==null||!isNaN(e[t])))){return false}}for(i=0;i<qr.length;++i){if(e[qr[i]]){if(r){return false}if(parseFloat(e[qr[i]])!==ue(e[qr[i]])){r=true}}}return true}function ti(){return this._isValid}function ri(){return Ai(NaN)}function ii(e){var t=ie(e),r=t.year||0,i=t.quarter||0,n=t.month||0,a=t.week||t.isoWeek||0,s=t.day||0,o=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=ei(t);this._milliseconds=+c+u*1e3+l*6e4+o*1e3*60*60;this._days=+s+a*7;this._months=+n+i*3+r*12;this._data={};this._locale=gr();this._bubble()}function ni(e){return e instanceof ii}function ai(e){if(e<0){return Math.round(-1*e)*-1}else{return Math.round(e)}}function si(e,t,r){var i=Math.min(e.length,t.length),n=Math.abs(e.length-t.length),a=0,s;for(s=0;s<i;s++){if(r&&e[s]!==t[s]||!r&&ue(e[s])!==ue(t[s])){a++}}return a+n}function oi(e,r){F(e,0,0,function(){var e=this.utcOffset(),t="+";if(e<0){e=-e;t="-"}return t+x(~~(e/60),2)+r+x(~~e%60,2)})}oi("Z",":"),oi("ZZ",""),ke("Z",Ce),ke("ZZ",Ce),ze(["Z","ZZ"],function(e,t,r){r._useUTC=true;r._tzm=ui(Ce,e)});var li=/([\+\-]|\d\d)/gi;function ui(e,t){var r=(t||"").match(e),i,n,a;if(r===null){return null}i=r[r.length-1]||[];n=(i+"").match(li)||["-",0,0];a=+(n[1]*60)+ue(n[2]);return a===0?0:n[0]==="+"?a:-a}function ci(e,t){var r,i;if(t._isUTC){r=t.clone();i=(_(e)||f(e)?e.valueOf():Hr(e).valueOf())-r.valueOf();r._d.setTime(r._d.valueOf()+i);c.updateOffset(r,false);return r}else{return Hr(e).local()}}function di(e){return-Math.round(e._d.getTimezoneOffset())}function fi(e,t,r){var i=this._offset||0,n;if(!this.isValid()){return e!=null?this:NaN}if(e!=null){if(typeof e==="string"){e=ui(Ce,e);if(e===null){return this}}else if(Math.abs(e)<16&&!r){e=e*60}if(!this._isUTC&&t){n=di(this)}this._offset=e;this._isUTC=true;if(n!=null){this.add(n,"m")}if(i!==e){if(!t||this._changeInProgress){Li(this,Ai(e-i,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;c.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?i:di(this)}}function hi(e,t){if(e!=null){if(typeof e!=="string"){e=-e}this.utcOffset(e,t);return this}else{return-this.utcOffset()}}function pi(e){return this.utcOffset(0,e)}function gi(e){if(this._isUTC){this.utcOffset(0,e);this._isUTC=false;if(e){this.subtract(di(this),"m")}}return this}function mi(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var e=ui(Ee,this._i);if(e!=null){this.utcOffset(e)}else{this.utcOffset(0,true)}}return this}function yi(e){if(!this.isValid()){return false}e=e?Hr(e).utcOffset():0;return(this.utcOffset()-e)%60===0}function vi(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bi(){if(!a(this._isDSTShifted)){return this._isDSTShifted}var e={},t;S(e,this);e=Gr(e);if(e._a){t=e._isUTC?p(e._a):Hr(e._a);this._isDSTShifted=this.isValid()&&si(e._a,t.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function Si(){return this.isValid()?!this._isUTC:false}function Ti(){return this.isValid()?this._isUTC:false}function _i(){return this.isValid()?this._isUTC&&this._offset===0:false}c.updateOffset=function(){};var Ii=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Mi=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ai(e,t){var r=e,i=null,n,a,s;if(ni(e)){r={ms:e._milliseconds,d:e._days,M:e._months}}else if(d(e)||!isNaN(+e)){r={};if(t){r[t]=+e}else{r.milliseconds=+e}}else if(i=Ii.exec(e)){n=i[1]==="-"?-1:1;r={y:0,d:ue(i[Ge])*n,h:ue(i[Ve])*n,m:ue(i[We])*n,s:ue(i[He])*n,ms:ue(ai(i[$e]*1e3))*n}}else if(i=Mi.exec(e)){n=i[1]==="-"?-1:1;r={y:Di(i[2],n),M:Di(i[3],n),w:Di(i[4],n),d:Di(i[5],n),h:Di(i[6],n),m:Di(i[7],n),s:Di(i[8],n)}}else if(r==null){r={}}else if(typeof r==="object"&&("from"in r||"to"in r)){s=Ei(Hr(r.from),Hr(r.to));r={};r.ms=s.milliseconds;r.M=s.months}a=new ii(r);if(ni(e)&&l(e,"_locale")){a._locale=e._locale}if(ni(e)&&l(e,"_isValid")){a._isValid=e._isValid}return a}function Di(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function wi(e,t){var r={};r.months=t.month()-e.month()+(t.year()-e.year())*12;if(e.clone().add(r.months,"M").isAfter(t)){--r.months}r.milliseconds=+t-+e.clone().add(r.months,"M");return r}function Ei(e,t){var r;if(!(e.isValid()&&t.isValid())){return{milliseconds:0,months:0}}t=ci(t,e);if(e.isBefore(t)){r=wi(e,t)}else{r=wi(t,e);r.milliseconds=-r.milliseconds;r.months=-r.months}return r}function Ci(n,a){return function(e,t){var r,i;if(t!==null&&!isNaN(+t)){w(a,"moment()."+a+"(period, number) is deprecated. Please use moment()."+a+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");i=e;e=t;t=i}r=Ai(e,t);Li(this,r,n);return this}}function Li(e,t,r,i){var n=t._milliseconds,a=ai(t._days),s=ai(t._months);if(!e.isValid()){return}i=i==null?true:i;if(s){lt(e,de(e,"Month")+s*r)}if(a){fe(e,"Date",de(e,"Date")+a*r)}if(n){e._d.setTime(e._d.valueOf()+n*r)}if(i){c.updateOffset(e,a||s)}}Ai.fn=ii.prototype,Ai.invalid=ri;var Oi=Ci(1,"add"),Ni=Ci(-1,"subtract");function ki(e){return typeof e==="string"||e instanceof String}function xi(e){return _(e)||f(e)||ki(e)||d(e)||ji(e)||Ri(e)||e===null||e===undefined}function Ri(e){var t=o(e)&&!u(e),r=false,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],n,a;for(n=0;n<i.length;n+=1){a=i[n];r=r||l(e,a)}return t&&r}function ji(t){var e=s(t),r=false;if(e){r=t.filter(function(e){return!d(e)&&ki(t)}).length===0}return e&&r}function Pi(e){var t=o(e)&&!u(e),r=false,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],n,a;for(n=0;n<i.length;n+=1){a=i[n];r=r||l(e,a)}return t&&r}function zi(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Fi(e,t){if(arguments.length===1){if(xi(arguments[0])){e=arguments[0];t=undefined}else if(Pi(arguments[0])){t=arguments[0];e=undefined}}var r=e||Hr(),i=ci(r,this).startOf("day"),n=c.calendarFormat(this,i)||"sameElse",a=t&&(E(t[n])?t[n].call(this,r):t[n]);return this.format(a||this.localeData().calendar(n,this,Hr(r)))}function Ui(){return new T(this)}function Bi(e,t){var r=_(e)?e:Hr(e);if(!(this.isValid()&&r.isValid())){return false}t=re(t)||"millisecond";if(t==="millisecond"){return this.valueOf()>r.valueOf()}else{return r.valueOf()<this.clone().startOf(t).valueOf()}}function Yi(e,t){var r=_(e)?e:Hr(e);if(!(this.isValid()&&r.isValid())){return false}t=re(t)||"millisecond";if(t==="millisecond"){return this.valueOf()<r.valueOf()}else{return this.clone().endOf(t).valueOf()<r.valueOf()}}function Gi(e,t,r,i){var n=_(e)?e:Hr(e),a=_(t)?t:Hr(t);if(!(this.isValid()&&n.isValid()&&a.isValid())){return false}i=i||"()";return(i[0]==="("?this.isAfter(n,r):!this.isBefore(n,r))&&(i[1]===")"?this.isBefore(a,r):!this.isAfter(a,r))}function Vi(e,t){var r=_(e)?e:Hr(e),i;if(!(this.isValid()&&r.isValid())){return false}t=re(t)||"millisecond";if(t==="millisecond"){return this.valueOf()===r.valueOf()}else{i=r.valueOf();return this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf()}}function Wi(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Hi(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function $i(e,t,r){var i,n,a;if(!this.isValid()){return NaN}i=ci(e,this);if(!i.isValid()){return NaN}n=(i.utcOffset()-this.utcOffset())*6e4;t=re(t);switch(t){case"year":a=Qi(this,i)/12;break;case"month":a=Qi(this,i);break;case"quarter":a=Qi(this,i)/3;break;case"second":a=(this-i)/1e3;break;case"minute":a=(this-i)/6e4;break;case"hour":a=(this-i)/36e5;break;case"day":a=(this-i-n)/864e5;break;case"week":a=(this-i-n)/6048e5;break;default:a=this-i}return r?a:le(a)}function Qi(e,t){if(e.date()<t.date()){return-Qi(t,e)}var r=(t.year()-e.year())*12+(t.month()-e.month()),i=e.clone().add(r,"months"),n,a;if(t-i<0){n=e.clone().add(r-1,"months");a=(t-i)/(i-n)}else{n=e.clone().add(r+1,"months");a=(t-i)/(n-i)}return-(r+a)||0}function Ki(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Zi(e){if(!this.isValid()){return null}var t=e!==true,r=t?this.clone().utc():this;if(r.year()<0||r.year()>9999){return Y(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(E(Date.prototype.toISOString)){if(t){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Y(r,"Z"))}}return Y(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Xi(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var e="moment",t="",r,i,n,a;if(!this.isLocal()){e=this.utcOffset()===0?"moment.utc":"moment.parseZone";t="Z"}r="["+e+'("]';i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";n="-MM-DD[T]HH:mm:ss.SSS";a=t+'[")]';return this.format(r+i+n+a)}function Ji(e){if(!e){e=this.isUtc()?c.defaultFormatUtc:c.defaultFormat}var t=Y(this,e);return this.localeData().postformat(t)}function qi(e,t){if(this.isValid()&&(_(e)&&e.isValid()||Hr(e).isValid())){return Ai({to:this,from:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function en(e){return this.from(Hr(),e)}function tn(e,t){if(this.isValid()&&(_(e)&&e.isValid()||Hr(e).isValid())){return Ai({from:this,to:e}).locale(this.locale()).humanize(!t)}else{return this.localeData().invalidDate()}}function rn(e){return this.to(Hr(),e)}function nn(e){var t;if(e===undefined){return this._locale._abbr}else{t=gr(e);if(t!=null){this._locale=t}return this}}c.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",c.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var an=M("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){if(e===undefined){return this.localeData()}else{return this.locale(e)}});function sn(){return this._locale}var on=1e3,ln=60*on,un=60*ln,cn=(365*400+97)*24*un;function dn(e,t){return(e%t+t)%t}function fn(e,t,r){if(e<100&&e>=0){return new Date(e+400,t,r)-cn}else{return new Date(e,t,r).valueOf()}}function hn(e,t,r){if(e<100&&e>=0){return Date.UTC(e+400,t,r)-cn}else{return Date.UTC(e,t,r)}}function pn(e){var t,r;e=re(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}r=this._isUTC?hn:fn;switch(e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf();t-=dn(t+(this._isUTC?0:this.utcOffset()*ln),un);break;case"minute":t=this._d.valueOf();t-=dn(t,ln);break;case"second":t=this._d.valueOf();t-=dn(t,on);break}this._d.setTime(t);c.updateOffset(this,true);return this}function gn(e){var t,r;e=re(e);if(e===undefined||e==="millisecond"||!this.isValid()){return this}r=this._isUTC?hn:fn;switch(e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf();t+=un-dn(t+(this._isUTC?0:this.utcOffset()*ln),un)-1;break;case"minute":t=this._d.valueOf();t+=ln-dn(t,ln)-1;break;case"second":t=this._d.valueOf();t+=on-dn(t,on)-1;break}this._d.setTime(t);c.updateOffset(this,true);return this}function mn(){return this._d.valueOf()-(this._offset||0)*6e4}function yn(){return Math.floor(this.valueOf()/1e3)}function vn(){return new Date(this.valueOf())}function bn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Sn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Tn(){return this.isValid()?this.toISOString():null}function _n(){return m(this)}function In(){return h({},g(this))}function Mn(){return g(this).overflow}function An(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Dn(e,t){var r,i,n,a=this._eras||gr("en")._eras;for(r=0,i=a.length;r<i;++r){switch(typeof a[r].since){case"string":n=c(a[r].since).startOf("day");a[r].since=n.valueOf();break}switch(typeof a[r].until){case"undefined":a[r].until=+Infinity;break;case"string":n=c(a[r].until).startOf("day").valueOf();a[r].until=n.valueOf();break}}return a}function wn(e,t,r){var i,n,a=this.eras(),s,o,l;e=e.toUpperCase();for(i=0,n=a.length;i<n;++i){s=a[i].name.toUpperCase();o=a[i].abbr.toUpperCase();l=a[i].narrow.toUpperCase();if(r){switch(t){case"N":case"NN":case"NNN":if(o===e){return a[i]}break;case"NNNN":if(s===e){return a[i]}break;case"NNNNN":if(l===e){return a[i]}break}}else if([s,o,l].indexOf(e)>=0){return a[i]}}}function En(e,t){var r=e.since<=e.until?+1:-1;if(t===undefined){return c(e.since).year()}else{return c(e.since).year()+(t-e.offset)*r}}function Cn(){var e,t,r,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){r=this.startOf("day").valueOf();if(i[e].since<=r&&r<=i[e].until){return i[e].name}if(i[e].until<=r&&r<=i[e].since){return i[e].name}}return""}function Ln(){var e,t,r,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){r=this.startOf("day").valueOf();if(i[e].since<=r&&r<=i[e].until){return i[e].narrow}if(i[e].until<=r&&r<=i[e].since){return i[e].narrow}}return""}function On(){var e,t,r,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){r=this.startOf("day").valueOf();if(i[e].since<=r&&r<=i[e].until){return i[e].abbr}if(i[e].until<=r&&r<=i[e].since){return i[e].abbr}}return""}function Nn(){var e,t,r,i,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){r=n[e].since<=n[e].until?+1:-1;i=this.startOf("day").valueOf();if(n[e].since<=i&&i<=n[e].until||n[e].until<=i&&i<=n[e].since){return(this.year()-c(n[e].since).year())*r+n[e].offset}}return this.year()}function kn(e){if(!l(this,"_erasNameRegex")){Un.call(this)}return e?this._erasNameRegex:this._erasRegex}function xn(e){if(!l(this,"_erasAbbrRegex")){Un.call(this)}return e?this._erasAbbrRegex:this._erasRegex}function Rn(e){if(!l(this,"_erasNarrowRegex")){Un.call(this)}return e?this._erasNarrowRegex:this._erasRegex}function jn(e,t){return t.erasAbbrRegex(e)}function Pn(e,t){return t.erasNameRegex(e)}function zn(e,t){return t.erasNarrowRegex(e)}function Fn(e,t){return t._eraYearOrdinalRegex||De}function Un(){var e=[],t=[],r=[],i=[],n,a,s=this.eras();for(n=0,a=s.length;n<a;++n){t.push(je(s[n].name));e.push(je(s[n].abbr));r.push(je(s[n].narrow));i.push(je(s[n].name));i.push(je(s[n].abbr));i.push(je(s[n].narrow))}this._erasRegex=new RegExp("^("+i.join("|")+")","i");this._erasNameRegex=new RegExp("^("+t.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}function Bn(e,t){F(0,[e,e.length],0,t)}function Yn(e){return Qn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Gn(e){return Qn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Vn(){return _t(this.year(),1,4)}function Wn(){return _t(this.isoWeekYear(),1,4)}function Hn(){var e=this.localeData()._week;return _t(this.year(),e.dow,e.doy)}function $n(){var e=this.localeData()._week;return _t(this.weekYear(),e.dow,e.doy)}function Qn(e,t,r,i,n){var a;if(e==null){return Tt(this,i,n).year}else{a=_t(e,i,n);if(t>a){t=a}return Kn.call(this,e,t,r,i,n)}}function Kn(e,t,r,i,n){var a=St(e,t,r,i,n),s=vt(a.year,0,a.dayOfYear);this.year(s.getUTCFullYear());this.month(s.getUTCMonth());this.date(s.getUTCDate());return this}function Zn(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}F("N",0,0,"eraAbbr"),F("NN",0,0,"eraAbbr"),F("NNN",0,0,"eraAbbr"),F("NNNN",0,0,"eraName"),F("NNNNN",0,0,"eraNarrow"),F("y",["y",1],"yo","eraYear"),F("y",["yy",2],0,"eraYear"),F("y",["yyy",3],0,"eraYear"),F("y",["yyyy",4],0,"eraYear"),ke("N",jn),ke("NN",jn),ke("NNN",jn),ke("NNNN",Pn),ke("NNNNN",zn),ze(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,i){var n=r._locale.erasParse(e,i,r._strict);if(n){g(r).era=n}else{g(r).invalidEra=e}}),ke("y",De),ke("yy",De),ke("yyy",De),ke("yyyy",De),ke("yo",Fn),ze(["y","yy","yyy","yyyy"],Be),ze(["yo"],function(e,t,r,i){var n;if(r._locale._eraYearOrdinalRegex){n=e.match(r._locale._eraYearOrdinalRegex)}if(r._locale.eraYearOrdinalParse){t[Be]=r._locale.eraYearOrdinalParse(e,n)}else{t[Be]=parseInt(e,10)}}),F(0,["gg",2],0,function(){return this.weekYear()%100}),F(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Bn("gggg","weekYear"),Bn("ggggg","weekYear"),Bn("GGGG","isoWeekYear"),Bn("GGGGG","isoWeekYear"),te("weekYear","gg"),te("isoWeekYear","GG"),ae("weekYear",1),ae("isoWeekYear",1),ke("G",we),ke("g",we),ke("GG",Se,me),ke("gg",Se,me),ke("GGGG",Me,ve),ke("gggg",Me,ve),ke("GGGGG",Ae,be),ke("ggggg",Ae,be),Fe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,i){t[i.substr(0,2)]=ue(e)}),Fe(["gg","GG"],function(e,t,r,i){t[i]=c.parseTwoDigitYear(e)}),F("Q",0,"Qo","quarter"),te("quarter","Q"),ae("quarter",7),ke("Q",ge),ze("Q",function(e,t){t[Ye]=(ue(e)-1)*3}),F("D",["DD",2],"Do","date"),te("date","D"),ae("date",9),ke("D",Se),ke("DD",Se,me),ke("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),ze(["D","DD"],Ge),ze("Do",function(e,t){t[Ge]=ue(e.match(Se)[0])});var Xn=ce("Date",true);function Jn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}F("DDD",["DDDD",3],"DDDo","dayOfYear"),te("dayOfYear","DDD"),ae("dayOfYear",4),ke("DDD",Ie),ke("DDDD",ye),ze(["DDD","DDDD"],function(e,t,r){r._dayOfYear=ue(e)}),F("m",["mm",2],0,"minute"),te("minute","m"),ae("minute",14),ke("m",Se),ke("mm",Se,me),ze(["m","mm"],We);var qn=ce("Minutes",false);F("s",["ss",2],0,"second"),te("second","s"),ae("second",15),ke("s",Se),ke("ss",Se,me),ze(["s","ss"],He);var ea=ce("Seconds",false),ta,ra;for(F("S",0,0,function(){return~~(this.millisecond()/100)}),F(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),F(0,["SSS",3],0,"millisecond"),F(0,["SSSS",4],0,function(){return this.millisecond()*10}),F(0,["SSSSS",5],0,function(){return this.millisecond()*100}),F(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),F(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),F(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),F(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),te("millisecond","ms"),ae("millisecond",16),ke("S",Ie,ge),ke("SS",Ie,me),ke("SSS",Ie,ye),ta="SSSS";ta.length<=9;ta+="S"){ke(ta,De)}function ia(e,t){t[$e]=ue(("0."+e)*1e3)}for(ta="S";ta.length<=9;ta+="S"){ze(ta,ia)}function na(){return this._isUTC?"UTC":""}function aa(){return this._isUTC?"Coordinated Universal Time":""}ra=ce("Milliseconds",false),F("z",0,0,"zoneAbbr"),F("zz",0,0,"zoneName");var sa=T.prototype;if(sa.add=Oi,sa.calendar=Fi,sa.clone=Ui,sa.diff=$i,sa.endOf=gn,sa.format=Ji,sa.from=qi,sa.fromNow=en,sa.to=tn,sa.toNow=rn,sa.get=he,sa.invalidAt=Mn,sa.isAfter=Bi,sa.isBefore=Yi,sa.isBetween=Gi,sa.isSame=Vi,sa.isSameOrAfter=Wi,sa.isSameOrBefore=Hi,sa.isValid=_n,sa.lang=an,sa.locale=nn,sa.localeData=sn,sa.max=Qr,sa.min=$r,sa.parsingFlags=In,sa.set=pe,sa.startOf=pn,sa.subtract=Ni,sa.toArray=bn,sa.toObject=Sn,sa.toDate=vn,sa.toISOString=Zi,sa.inspect=Xi,typeof Symbol!=="undefined"&&Symbol.for!=null){sa[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}}function oa(e){return Hr(1e3*e)}function la(){return Hr.apply(null,arguments).parseZone()}function ua(e){return e}sa.toJSON=Tn,sa.toString=Ki,sa.unix=yn,sa.valueOf=mn,sa.creationData=An,sa.eraName=Cn,sa.eraNarrow=Ln,sa.eraAbbr=On,sa.eraYear=Nn,sa.year=gt,sa.isLeapYear=mt,sa.weekYear=Yn,sa.isoWeekYear=Gn,sa.quarter=sa.quarters=Zn,sa.month=ut,sa.daysInMonth=ct,sa.week=sa.weeks=wt,sa.isoWeek=sa.isoWeeks=Et,sa.weeksInYear=Hn,sa.weeksInWeekYear=$n,sa.isoWeeksInYear=Vn,sa.isoWeeksInISOWeekYear=Wn,sa.date=Xn,sa.day=sa.days=Gt,sa.weekday=Vt,sa.isoWeekday=Wt,sa.dayOfYear=Jn,sa.hour=sa.hours=rr,sa.minute=sa.minutes=qn,sa.second=sa.seconds=ea,sa.millisecond=sa.milliseconds=ra,sa.utcOffset=fi,sa.utc=pi,sa.local=gi,sa.parseZone=mi,sa.hasAlignedHourOffset=yi,sa.isDST=vi,sa.isLocal=Si,sa.isUtcOffset=Ti,sa.isUtc=_i,sa.isUTC=_i,sa.zoneAbbr=na,sa.zoneName=aa,sa.dates=M("dates accessor is deprecated. Use date instead.",Xn),sa.months=M("months accessor is deprecated. Use month instead",ut),sa.years=M("years accessor is deprecated. Use year instead",gt),sa.zone=M("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",hi),sa.isDSTShifted=M("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bi);var ca=O.prototype;function da(e,t,r,i){var n=gr(),a=p().set(i,t);return n[r](a,e)}function fa(e,t,r){if(d(e)){t=e;e=undefined}e=e||"";if(t!=null){return da(e,t,r,"month")}var i,n=[];for(i=0;i<12;i++){n[i]=da(e,i,r,"month")}return n}function ha(e,t,r,i){if(typeof e==="boolean"){if(d(t)){r=t;t=undefined}t=t||""}else{t=e;r=t;e=false;if(d(t)){r=t;t=undefined}t=t||""}var n=gr(),a=e?n._week.dow:0,s,o=[];if(r!=null){return da(t,(r+a)%7,i,"day")}for(s=0;s<7;s++){o[s]=da(t,(s+a)%7,i,"day")}return o}function pa(e,t){return fa(e,t,"months")}function ga(e,t){return fa(e,t,"monthsShort")}function ma(e,t,r){return ha(e,t,r,"weekdays")}function ya(e,t,r){return ha(e,t,r,"weekdaysShort")}function va(e,t,r){return ha(e,t,r,"weekdaysMin")}ca.calendar=k,ca.longDateFormat=W,ca.invalidDate=$,ca.ordinal=Z,ca.preparse=ua,ca.postformat=ua,ca.relativeTime=J,ca.pastFuture=q,ca.set=C,ca.eras=Dn,ca.erasParse=wn,ca.erasConvertYear=En,ca.erasAbbrRegex=xn,ca.erasNameRegex=kn,ca.erasNarrowRegex=Rn,ca.months=nt,ca.monthsShort=at,ca.monthsParse=ot,ca.monthsRegex=ft,ca.monthsShortRegex=dt,ca.week=It,ca.firstDayOfYear=Dt,ca.firstDayOfWeek=At,ca.weekdays=zt,ca.weekdaysMin=Ut,ca.weekdaysShort=Ft,ca.weekdaysParse=Yt,ca.weekdaysRegex=Ht,ca.weekdaysShortRegex=$t,ca.weekdaysMinRegex=Qt,ca.isPM=er,ca.meridiem=ir,fr("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=ue(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}}),c.lang=M("moment.lang is deprecated. Use moment.locale instead.",fr),c.langData=M("moment.langData is deprecated. Use moment.localeData instead.",gr);var ba=Math.abs;function Sa(){var e=this._data;return this._milliseconds=ba(this._milliseconds),this._days=ba(this._days),this._months=ba(this._months),e.milliseconds=ba(e.milliseconds),e.seconds=ba(e.seconds),e.minutes=ba(e.minutes),e.hours=ba(e.hours),e.months=ba(e.months),e.years=ba(e.years),this}function Ta(e,t,r,i){var n=Ai(t,r);e._milliseconds+=i*n._milliseconds;e._days+=i*n._days;e._months+=i*n._months;return e._bubble()}function _a(e,t){return Ta(this,e,t,1)}function Ia(e,t){return Ta(this,e,t,-1)}function Ma(e){if(e<0){return Math.floor(e)}else{return Math.ceil(e)}}function Aa(){var e,t,r,i,n,a=this._milliseconds,s=this._days,o=this._months,l=this._data;if(!(0<=a&&0<=s&&0<=o||a<=0&&s<=0&&o<=0))a+=864e5*Ma(wa(o)+s),o=s=0;return l.milliseconds=a%1e3,e=le(a/1e3),l.seconds=e%60,t=le(e/60),l.minutes=t%60,r=le(t/60),l.hours=r%24,s+=le(r/24),n=le(Da(s)),o+=n,s-=Ma(wa(n)),i=le(o/12),o%=12,l.days=s,l.months=o,l.years=i,this}function Da(e){return e*4800/146097}function wa(e){return e*146097/4800}function Ea(e){if(!this.isValid())return NaN;var t,r,i=this._milliseconds;if("month"===(e=re(e))||"quarter"===e||"year"===e)switch(t=this._days+i/864e5,r=this._months+Da(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(wa(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function Ca(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ue(this._months/12):NaN}function La(e){return function(){return this.as(e)}}var Oa=La("ms"),Na=La("s"),ka=La("m"),xa=La("h"),Ra=La("d"),ja=La("w"),Pa=La("M"),za=La("Q"),Fa=La("y");function Ua(){return Ai(this)}function Ba(e){return e=re(e),this.isValid()?this[e+"s"]():NaN}function Ya(e){return function(){return this.isValid()?this._data[e]:NaN}}var Ga=Ya("milliseconds"),Va=Ya("seconds"),Wa=Ya("minutes"),Ha=Ya("hours"),$a=Ya("days"),Qa=Ya("months"),Ka=Ya("years");function Za(){return le(this.days()/7)}var Xa=Math.round,Ja={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function qa(e,t,r,i,n){return n.relativeTime(t||1,!!r,e,i)}function es(e,t,r,i){var n=Ai(e).abs(),a=Xa(n.as("s")),s=Xa(n.as("m")),o=Xa(n.as("h")),l=Xa(n.as("d")),u=Xa(n.as("M")),c=Xa(n.as("w")),d=Xa(n.as("y")),f=(a<=r.ss?["s",a]:a<r.s&&["ss",a])||s<=1&&["m"]||s<r.m&&["mm",s]||o<=1&&["h"]||o<r.h&&["hh",o]||l<=1&&["d"]||l<r.d&&["dd",l];if(null!=r.w)f=f||c<=1&&["w"]||c<r.w&&["ww",c];return(f=f||u<=1&&["M"]||u<r.M&&["MM",u]||d<=1&&["y"]||["yy",d])[2]=t,f[3]=0<+e,f[4]=i,function(e,t,r,i,n){return n.relativeTime(t||1,!!r,e,i)}.apply(null,f)}function ts(e){return void 0!==e?"function"==typeof e&&(Xa=e,!0):Xa}function rs(e,t){if(void 0===Ja[e])return!1;if(void 0===t)return Ja[e];if(Ja[e]=t,"s"===e)Ja.ss=t-1;return!0}function is(e,t){if(!this.isValid())return this.localeData().invalidDate();var r,i,n=!1,a=Ja;if("object"==typeof e)t=e,e=!1;if("boolean"==typeof e)n=e;if("object"==typeof t)a=Object.assign({},Ja,t),null!=t.s&&null==t.ss&&(a.ss=t.s-1);if(r=this.localeData(),i=function(e,t,r,i){var n=Ai(e).abs(),a=Xa(n.as("s")),s=Xa(n.as("m")),o=Xa(n.as("h")),l=Xa(n.as("d")),u=Xa(n.as("M")),c=Xa(n.as("w")),d=Xa(n.as("y")),f=(a<=r.ss?["s",a]:a<r.s&&["ss",a])||s<=1&&["m"]||s<r.m&&["mm",s]||o<=1&&["h"]||o<r.h&&["hh",o]||l<=1&&["d"]||l<r.d&&["dd",l];null!=r.w&&(f=f||c<=1&&["w"]||c<r.w&&["ww",c]);return(f=f||u<=1&&["M"]||u<r.M&&["MM",u]||d<=1&&["y"]||["yy",d])[2]=t,f[3]=0<+e,f[4]=i,function(e,t,r,i,n){return n.relativeTime(t||1,!!r,e,i)}.apply(null,f)}(this,!n,a,r),n)i=r.pastFuture(+this,i);return r.postformat(i)}var ns=Math.abs;function as(e){return(e>0)-(e<0)||+e}function ss(){if(!this.isValid()){return this.localeData().invalidDate()}var e=ns(this._milliseconds)/1e3,t=ns(this._days),r=ns(this._months),i,n,a,s,o=this.asSeconds(),l,u,c,d;if(!o){return"P0D"}i=le(e/60);n=le(i/60);e%=60;i%=60;a=le(r/12);r%=12;s=e?e.toFixed(3).replace(/\.?0+$/,""):"";l=o<0?"-":"";u=as(this._months)!==as(o)?"-":"";c=as(this._days)!==as(o)?"-":"";d=as(this._milliseconds)!==as(o)?"-":"";return l+"P"+(a?u+a+"Y":"")+(r?u+r+"M":"")+(t?c+t+"D":"")+(n||i||e?"T":"")+(n?d+n+"H":"")+(i?d+i+"M":"")+(e?d+s+"S":"")}var os=ii.prototype;return os.isValid=function(){return this._isValid},os.abs=function(){var e=this._data;return this._milliseconds=ba(this._milliseconds),this._days=ba(this._days),this._months=ba(this._months),e.milliseconds=ba(e.milliseconds),e.seconds=ba(e.seconds),e.minutes=ba(e.minutes),e.hours=ba(e.hours),e.months=ba(e.months),e.years=ba(e.years),this},os.add=function(e,t){return Ta(this,e,t,1)},os.subtract=function(e,t){return Ta(this,e,t,-1)},os.as=function(e){if(!this.isValid())return NaN;var t,r,i=this._milliseconds;if("month"===(e=re(e))||"quarter"===e||"year"===e)switch(t=this._days+i/864e5,r=this._months+Da(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(wa(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}},os.asMilliseconds=Oa,os.asSeconds=Na,os.asMinutes=ka,os.asHours=xa,os.asDays=Ra,os.asWeeks=ja,os.asMonths=Pa,os.asQuarters=za,os.asYears=Fa,os.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ue(this._months/12):NaN},os._bubble=function(){var e,t,r,i,n,a=this._milliseconds,s=this._days,o=this._months,l=this._data;0<=a&&0<=s&&0<=o||a<=0&&s<=0&&o<=0||(a+=864e5*Ma(wa(o)+s),o=s=0);return l.milliseconds=a%1e3,e=le(a/1e3),l.seconds=e%60,t=le(e/60),l.minutes=t%60,r=le(t/60),l.hours=r%24,s+=le(r/24),n=le(Da(s)),o+=n,s-=Ma(wa(n)),i=le(o/12),o%=12,l.days=s,l.months=o,l.years=i,this},os.clone=function(){return Ai(this)},os.get=function(e){return e=re(e),this.isValid()?this[e+"s"]():NaN},os.milliseconds=Ga,os.seconds=Va,os.minutes=Wa,os.hours=Ha,os.days=$a,os.weeks=function(){return le(this.days()/7)},os.months=Qa,os.years=Ka,os.humanize=function(e,t){if(!this.isValid())return this.localeData().invalidDate();var r,i,n=!1,a=Ja;"object"==typeof e&&(t=e,e=!1);"boolean"==typeof e&&(n=e);"object"==typeof t&&(a=Object.assign({},Ja,t),null!=t.s&&null==t.ss&&(a.ss=t.s-1));r=this.localeData(),i=function(e,t,r,i){var n=Ai(e).abs(),a=Xa(n.as("s")),s=Xa(n.as("m")),o=Xa(n.as("h")),l=Xa(n.as("d")),u=Xa(n.as("M")),c=Xa(n.as("w")),d=Xa(n.as("y")),f=(a<=r.ss?["s",a]:a<r.s&&["ss",a])||s<=1&&["m"]||s<r.m&&["mm",s]||o<=1&&["h"]||o<r.h&&["hh",o]||l<=1&&["d"]||l<r.d&&["dd",l];null!=r.w&&(f=f||c<=1&&["w"]||c<r.w&&["ww",c]);return(f=f||u<=1&&["M"]||u<r.M&&["MM",u]||d<=1&&["y"]||["yy",d])[2]=t,f[3]=0<+e,f[4]=i,function(e,t,r,i,n){return n.relativeTime(t||1,!!r,e,i)}.apply(null,f)}(this,!n,a,r),n&&(i=r.pastFuture(+this,i));return r.postformat(i)},os.toISOString=ss,os.toString=ss,os.toJSON=ss,os.locale=nn,os.localeData=sn,os.toIsoString=M("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ss),os.lang=an,F("X",0,0,"unix"),F("x",0,0,"valueOf"),ke("x",we),ke("X",/[+-]?\d+(\.\d{1,3})?/),ze("X",function(e,t,r){r._d=new Date(1e3*parseFloat(e))}),ze("x",function(e,t,r){r._d=new Date(ue(e))}),c.version="2.25.3",function(e){t=e}(Hr),c.fn=sa,c.min=function(){return Kr("isBefore",[].slice.call(arguments,0))},c.max=function(){return Kr("isAfter",[].slice.call(arguments,0))},c.now=function(){return Date.now?Date.now():+new Date},c.utc=p,c.unix=function(e){return Hr(1e3*e)},c.months=function(e,t){return fa(e,t,"months")},c.isDate=f,c.locale=fr,c.invalid=y,c.duration=Ai,c.isMoment=_,c.weekdays=function(e,t,r){return ha(e,t,r,"weekdays")},c.parseZone=function(){return Hr.apply(null,arguments).parseZone()},c.localeData=gr,c.isDuration=ni,c.monthsShort=function(e,t){return fa(e,t,"monthsShort")},c.weekdaysMin=function(e,t,r){return ha(e,t,r,"weekdaysMin")},c.defineLocale=hr,c.updateLocale=function(e,t){if(null!=t){var r,i,n=nr;null!=ar[e]&&null!=ar[e].parentLocale?ar[e].set(L(ar[e]._config,t)):(null!=(i=dr(e))&&(n=i._config),t=L(n,t),null==i&&(t.abbr=e),(r=new O(t)).parentLocale=ar[e],ar[e]=r),fr(e)}else null!=ar[e]&&(null!=ar[e].parentLocale?(ar[e]=ar[e].parentLocale,e===fr()&&fr(e)):null!=ar[e]&&delete ar[e]);return ar[e]},c.locales=function(){return D(ar)},c.weekdaysShort=function(e,t,r){return ha(e,t,r,"weekdaysShort")},c.normalizeUnits=re,c.relativeTimeRounding=function(e){return void 0!==e?"function"==typeof e&&(Xa=e,!0):Xa},c.relativeTimeThreshold=function(e,t){if(void 0===Ja[e])return!1;if(void 0===t)return Ja[e];Ja[e]=t,"s"===e&&(Ja.ss=t-1);return!0},c.calendarFormat=function(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"},c.prototype=sa,c.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},c}()});function replaceDate(e){return moment().format("Do MMMM YYYY")}function replaceTime(e){return moment().format("HH:mm")}var textValueReplacements={date:replaceDate,time:replaceTime},lastReplacedItems={},REPLACE_DELAY_IN_MS=1e3,keysCheck=Object.keys(textValueReplacements).join("|"),checkTextValueReplacementsRegex=new RegExp("#(".concat(keysCheck,")"),"gm");function populateTextValues(e,t){if(!t.textValue)return t;var r=lastReplacedItems[e]||null;if(r&&r.time>Date.now()-REPLACE_DELAY_IN_MS)return _objectSpread2(_objectSpread2({},t),{},{textValue:r.value});checkTextValueReplacementsRegex.lastIndex=0;for(var i=t.textValue,n=checkTextValueReplacementsRegex.exec(i);null!==n;){var a=n[0],s=n[1];i=i.replace(a,textValueReplacements[s](i)),n=checkTextValueReplacementsRegex.exec(i)}return lastReplacedItems[e]={time:Date.now(),value:i},_objectSpread2(_objectSpread2({},t),{},{textValue:i})}function populateDynamicValues(e,t){return populateTextValues(e,t)}var _dec$3,_dec2$2,_dec3$1,_dec4,_dec5,_dec6,_dec7,_dec8,_dec9,_dec10,_dec11,_dec12,_dec13,_dec14,_dec15,_dec16,_dec17,_dec18,_dec19,_dec20,_dec21,_dec22,_class$3,_descriptor$3,_descriptor2$1,_descriptor3$1,_descriptor4,_descriptor5,_descriptor6,_descriptor7,_descriptor8,_descriptor9,_descriptor10,_descriptor11,_descriptor12,_descriptor13,_descriptor14,_descriptor15,_descriptor16,_descriptor17,_descriptor18,_descriptor19,_descriptor20,_descriptor21,_descriptor22,_descriptor23,_descriptor24,_descriptor25,_descriptor26,_descriptor27,_descriptor28,_descriptor29,_descriptor30,_descriptor31,_descriptor32,_descriptor33,_descriptor34,_descriptor35,_descriptor36,_descriptor37,_temp$3,calculateNewStyles=function(){return function(e){var t=e.animations,i=e.absoluteBeginTime,n=e.currentTime;if(t){var r=t.reduce(function(e,t){var r=getStylesFromAnimation()({absoluteBeginTime:i,animation:t,currentTime:n});return mergeTransformStyle()(e,r)},{});return getWillChangeStyle(r)}return{}}},createLayer=function(e,t){var r=e.absoluteBeginTime,i=e.absoluteEndTime,n=e.id,a=e.styles,s=e.animations,o=e.type,l=_objectWithoutProperties(e,["absoluteBeginTime","absoluteEndTime","id","styles","animations","type"]),u=t.currentTime,c=t.measurements,d=(t.imageMap,t.videoState),f=t.currentState,h=null;if((d===SEEKED||d===NOT_USED)&&r<=u&&u<i&&f!==INITIALISING){var p=calculateNewStyles()({animations:s,absoluteBeginTime:r,currentTime:u}),g=combinePositionAndTranslate(adjustTransformTranslate(mergeTransformStyle()(a,p)));if(!isLayerVisible(g,{right:1600,bottom:900}))return null;var m=adjustSizing(o,g,c);h=_objectSpread2(_objectSpread2({},populateDynamicValues(n,l)),{},{type:o,styles:m,absoluteBeginTime:r,absoluteEndTime:i})}return _defineProperty({},n,h)},filterLayer=function(e,t,r){return 0<t.length?!t.includes(r.id):!e||0===e.length||e.includes(r.id)},overrideWithState=function(e,s,o){return e.slice().sort(function(e,t){return e.timeApplied<=t.timeApplied?-1:1}).reduce(function(e,t){var r=s.states?s.states[t.name]:void 0;if(!r)return e;var i=o.id.slice(o.id.lastIndexOf(".")+1),n=r.elements.find(function(e){return e.id.slice(e.id.lastIndexOf(".")+1)===i});if(!n)return e;var a=t.timeApplied-o.absoluteBeginTime;return _objectSpread2(_objectSpread2(_objectSpread2({},e),n),{},{animations:n.animations?n.animations.map(function(e){return _objectSpread2(_objectSpread2({},e),{},{beginTime:parseFloat(e.beginTime)+(e.useLayerRelativeTime?0:a)})}):e.animations})},o)},createLayers=function(c,d){return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length?arguments[1]:void 0,i=t.currentTime,n=t.isFullScreen,a=t.measurements,s=t.imageMap,o=t.videoState,l=t.currentState,u=t.layerStates;return e.reduce?e.reduce(function(e,r){return _objectSpread2(_objectSpread2({},e),r.elements.reduce(function(e,t){return _objectSpread2(_objectSpread2({},e),filterLayer(c,d,t)?createLayer(overrideWithState(u,r,t),{currentTime:i,isFullScreen:n,measurements:a,imageMap:s,videoState:o,currentState:l}):{})},{}))},{}):{}}},calculateOffsets=function(e,t){return 16/9<e/t?{yOffset:0,xOffset:(e-16*t/9)/2}:e/t<16/9?{yOffset:(t-9*e/16)/2,xOffset:0}:{xOffset:0,yOffset:0}},BASE_LAYER_WIDTH_169=1600,BASE_LAYER_HEIGHT_169=900,calculateAspectRatioPercent=function(e,t){return 16/9<e/t?t/BASE_LAYER_HEIGHT_169:e/BASE_LAYER_WIDTH_169},calculateMeasurements=function(e){var t=e.clientHeight,r=e.clientWidth,i=calculateAspectRatioPercent(r,t);return _objectSpread2(_objectSpread2({},calculateOffsets(r,t)),{},{width:r,height:t,aspectRatioPercent:i})},mapImage=function(e){return _defineProperty({},e.key,{width:e.width,height:e.height,url:e.url})},recursiveFilterState=function a(e){return Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return"element"!==i&&"store"!==i?"object"===_typeof(n)&&null!==n?_objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,a(n))):_objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,n)):_objectSpread2(_objectSpread2({},e),{},_defineProperty({},i," [object Object]"))},{})},logMobxState=function(e,t){t&&console.groupCollapsed("State Update"),console.log(recursiveFilterState(e)),t&&console.groupEnd()};configure({enforceActions:"observed"});var RootStore=(_dec$3=action.bound,_dec2$2=action.bound,_dec3$1=action.bound,_dec4=action.bound,_dec5=action.bound,_dec6=action.bound,_dec7=action.bound,_dec8=action.bound,_dec9=action.bound,_dec10=action.bound,_dec11=action.bound,_dec12=action.bound,_dec13=action.bound,_dec14=action.bound,_dec15=action.bound,_dec16=action.bound,_dec17=action.bound,_dec18=action.bound,_dec19=action.bound,_dec20=action.bound,_dec21=action.bound,_dec22=action.bound,_descriptor$3=_applyDecoratedDescriptor((_class$3=_temp$3=function(){function e(){_classCallCheck(this,e),this.hasInitialised=!1,_initializerDefineProperty(this,"autoLoop",_descriptor$3,this),_initializerDefineProperty(this,"originalVideoWidth",_descriptor2$1,this),_initializerDefineProperty(this,"originalVideoHeight",_descriptor3$1,this),_initializerDefineProperty(this,"videoStartOffsetTime",_descriptor4,this),_initializerDefineProperty(this,"videoEndOffsetTime",_descriptor5,this),_initializerDefineProperty(this,"videoPlayerContainer",_descriptor6,this),_initializerDefineProperty(this,"clientWidth",_descriptor7,this),_initializerDefineProperty(this,"clientHeight",_descriptor8,this),_initializerDefineProperty(this,"state",_descriptor9,this),_initializerDefineProperty(this,"previousState",_descriptor10,this),_initializerDefineProperty(this,"videoState",_descriptor11,this),_initializerDefineProperty(this,"currentTime",_descriptor12,this),_initializerDefineProperty(this,"startTime",_descriptor13,this),_initializerDefineProperty(this,"duration",_descriptor14,this),_initializerDefineProperty(this,"absoluteBumperBeginTime",_descriptor15,this),_initializerDefineProperty(this,"isFullScreen",_descriptor16,this),_initializerDefineProperty(this,"originalVideoWidth",_descriptor17,this),_initializerDefineProperty(this,"originalVideoHeight",_descriptor18,this),_initializerDefineProperty(this,"controls",_descriptor19,this),_initializerDefineProperty(this,"errorMessage",_descriptor20,this),_initializerDefineProperty(this,"layerStates",_descriptor21,this),_initializerDefineProperty(this,"imageMap",_descriptor22,this),_initializerDefineProperty(this,"hasImageMapLoaded",_descriptor23,this),_initializerDefineProperty(this,"fontMap",_descriptor24,this),_initializerDefineProperty(this,"hasFontMapLoaded",_descriptor25,this),_initializerDefineProperty(this,"showSubtitles",_descriptor26,this),_initializerDefineProperty(this,"displaySubtitlesButton",_descriptor27,this),_initializerDefineProperty(this,"muted",_descriptor28,this),_initializerDefineProperty(this,"mobileLandscapeOnFullscreen",_descriptor29,this),_initializerDefineProperty(this,"loadingStartTime",_descriptor30,this),_initializerDefineProperty(this,"layersJson",_descriptor31,this),this.enabledLayerIds=[],this.disabledLayerIds=[],_initializerDefineProperty(this,"videoBackgroundColour",_descriptor32,this),_initializerDefineProperty(this,"useGrid",_descriptor33,this),_initializerDefineProperty(this,"useTimeInMillis",_descriptor34,this),_initializerDefineProperty(this,"showMouseCoords",_descriptor35,this),_initializerDefineProperty(this,"autoLoop",_descriptor36,this),_initializerDefineProperty(this,"logStateChange",_descriptor37,this)}return _createClass(e,[{key:"setLoadingStartTime",value:function(){0===this.loadingStartTime&&(this.loadingStartTime=Date.now())}},{key:"resetLoadingStartTime",value:function(){this.loadingStartTime=0}},{key:"getState",value:function(){return _objectSpread2({currentState:this.currentState,previousState:this.previousState,videoState:this.videoState,currentTime:this.currentTime,startTime:this.startTime,duration:this.duration,isFullScreen:this.isFullScreen,showSubtitles:this.showSubtitles,muted:this.muted,mobileLandscapeOnFullscreen:this.mobileLandscapeOnFullscreen,autoLoop:this.autoLoop,hasImageMapLoaded:this.hasImageMapLoaded,hasFontMapLoaded:this.hasFontMapLoaded,imageMap:this.imageMap,fontMap:this.fontMap,measurements:this.measurements,layers:this.layers,controls:this.controls.getState(),videoStartOffsetTime:this.videoStartOffsetTime,videoEndOffsetTime:this.videoEndOffsetTime,originalVideoWidth:this.originalVideoWidth,originalVideoHeight:this.originalVideoHeight,clientWidth:this.clientWidth,clientHeight:this.clientHeight},{videoBackgroundColour:this.videoBackgroundColour,enabledLayerIds:this.enabledLayerIds,disabledLayerIds:this.disabledLayerIds,layersJson:this.layersJson,useGrid:this.useGrid,useTimeInMillis:this.useTimeInMillis,showMouseCoords:this.showMouseCoords,autoLoop:this.autoLoop,logStateChange:this.logStateChange})}},{key:"updateCurrentTime",value:function(e){e<this.duration?this.currentTime=e:this.currentTime=this.duration}},{key:"updateDuration",value:function(e){this.duration=e,this.updateCurrentTime(0)}},{key:"updateStartTime",value:function(e){this.startTime=e}},{key:"updateControlsAlwaysOn",value:function(e){this.controls.updateAlwaysOn(e)}},{key:"setShowControlsTimeout",value:function(e){var t=0<arguments.length&&void 0!==e?e:null;this.controls.setShowControlsTimeout(t)}},{key:"clearShowControlsTimeout",value:function(){this.controls.clearShowControlsTimeout()}},{key:"updateIsMouseOnControls",value:function(e){this.controls.updateIsMouseOnControls(e),this.clearShowControlsTimeout()}},{key:"update",value:function(e){var t=e.state,r=e.previousState,i=e.videoState,n=e.currentTime,a=e.duration,s=e.startTime,o=e.layersJson,l=e.errorMessage,u=e.isFullScreen,c=e.imageMap,d=e.hasImageMapLoaded,f=e.hasFontMapLoaded,h=e.fontMap,p=e.showControls,g=e.bumperBeginTime,m=e.showSubtitles,y=e.muted,v=e.mobileLandscapeOnFullscreen,b=e.displaySubtitlesButton,S=e.videoStartOffsetTime;isNullOrUndefined(t)||this.state===t||(this.previousState=this.state,this.state=t),isNullOrUndefined(r)||(this.previousState=r),isNullOrUndefined(i)||(this.videoState=i),isNullOrUndefined(n)||this.updateCurrentTime(n),isNullOrUndefined(a)||this.updateDuration(a),isNullOrUndefined(s)||this.updateStartTime(s),isNullOrUndefined(o)||(this.layersJson=o),isNullOrUndefined(l)||this.errorMessage.update(l),isNullOrUndefined(u)||(this.isFullScreen=u),isNullOrUndefined(d)||(this.hasImageMapLoaded=d),isNullOrUndefined(c)||this.updateImageMap(c),isNullOrUndefined(f)||(this.hasFontMapLoaded=f),isNullOrUndefined(h)||this.updateFontMap(h),isNullOrUndefined(p)||this.controls.updateShowControls(p),isNullOrUndefined(g)||(this.absoluteBumperBeginTime=g),isNullOrUndefined(m)||(this.showSubtitles=m),isNullOrUndefined(y)||(this.muted=y),isNullOrUndefined(v)||(this.mobileLandscapeOnFullscreen=v),isNullOrUndefined(b)||(this.displaySubtitlesButton=b),isNullOrUndefined(S)||(this.videoStartOffsetTime=S)}},{key:"updateAutoLoop",value:function(e){this.autoLoop=e}},{key:"updateShowMouseCoords",value:function(e){this.showMouseCoords=e}},{key:"updateUseTimeInMillis",value:function(e){this.useTimeInMillis=e}},{key:"updateUseGrid",value:function(e){this.useGrid=e}},{key:"updateLogStateChange",value:function(e){this.logStateChange=e}},{key:"updateBackgroundColour",value:function(e){var t=0<arguments.length&&void 0!==e?e:this.videoBackgroundColour;this.videoBackgroundColour=t}},{key:"updateMeasurements",value:function(e){var t=e.isFullScreen,r=e.originalVideoWidth,i=e.originalVideoHeight;this.videoPlayerContainer&&(this.clientWidth=this.videoPlayerContainer.clientWidth(t),this.clientHeight=this.videoPlayerContainer.clientHeight(t)),isNullOrUndefined(t)||(this.isFullScreen=t),isNullOrUndefined(r)||(this.originalVideoWidth=r),isNullOrUndefined(i)||(this.originalVideoHeight=i)}},{key:"updateErrorMessage",value:function(e){this.errorMessage.update(e)}},{key:"updateImageMap",value:function(e){this.imageMap=_objectSpread2(_objectSpread2({},this.imageMap),Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return _objectSpread2(_objectSpread2({},e),mapImage(_objectSpread2({key:i},n)))},{}))}},{key:"updateFontMap",value:function(e){this.fontMap=_objectSpread2(_objectSpread2({},this.fontMap),Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,{url:n}))},{}))}},{key:"updateDevOptions",value:function(e){var t=e.autoLoop,r=e.controlsAlwaysOn,i=e.logStateChange,n=e.videoBackgroundColour,a=e.showMouseCoords,s=e.useGrid,o=e.useTimeInMillis,l=e.duration;isNullOrUndefined(t)||(this.autoLoop=t),isNullOrUndefined(r)||this.updateControlsAlwaysOn(r),isNullOrUndefined(i)||(this.logStateChange=i),isNullOrUndefined(n)||(this.videoBackgroundColour=n),isNullOrUndefined(a)||(this.showMouseCoords=a),isNullOrUndefined(s)||(this.useGrid=s),isNullOrUndefined(o)||(this.useTimeInMillis=o),isNullOrUndefined(l)||this.updateDuration(l)}},{key:"init",value:function(e){var t=this,r=e.originalVideoWidth,i=void 0===r?this.originalVideoWidth:r,n=e.videoStartOffsetTime,a=void 0===n?this.videoStartOffsetTime:n,s=e.videoEndOffsetTime,o=void 0===s?this.videoEndOffsetTime:s,l=e.video,u=e.videoPlayerContainer,c=e.layersJson,d=e.enabledLayerIds,f=void 0===d?[]:d,h=e.disabledLayerIds,p=void 0===h?[]:h,g=_objectWithoutProperties(e,["originalVideoWidth","videoStartOffsetTime","videoEndOffsetTime","video","videoPlayerContainer","layersJson","enabledLayerIds","disabledLayerIds"]);this.hasInitialised||(this.originalVideoWidth=i,this.videoStartOffsetTime=a,this.videoEndOffsetTime=o,this.videoPlayerContainer=u,this.video=l,this.layersJson=c,this.enabledLayerIds=f,this.disabledLayerIds=p,this.update(g),this.hasInitialised=!0,autorun(function(){!0===t.logStateChange&&logMobxState(t.getState(),!1)},autorunConfig),window.updateDevOptions=this.updateDevOptions)}},{key:"currentState",get:function(){return this.hasImageMapLoaded&&this.hasFontMapLoaded||this.state===LOADING_ERROR?this.state:this.previousState!==PLAYING?INITIALISING:LOADING}},{key:"layers",get:function(){return createLayers(this.enabledLayerIds,this.disabledLayerIds)(this.layersJson,{currentTime:this.currentTime,imageMap:this.imageMap,isFullScreen:this.isFullScreen,measurements:this.measurements,videoState:this.videoState,currentState:this.currentState,layerStates:this.layerStates.getState()})}},{key:"measurements",get:function(){return this.videoPlayerContainer&&this.state?this.video?_objectSpread2({clientWidth:this.clientWidth,clientHeight:this.clientHeight,videoWidth:this.video.clientWidth(),videoHeight:this.video.clientHeight()},calculateMeasurements({clientWidth:this.clientWidth,clientHeight:this.clientHeight})):_objectSpread2({clientWidth:this.clientWidth,clientHeight:this.clientHeight,videoHeight:this.clientWidth,videoWidth:this.clientHeight},calculateMeasurements({clientWidth:this.clientWidth,clientHeight:this.clientHeight})):{}}}]),e}()).prototype,"autoLoop",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor2$1=_applyDecoratedDescriptor(_class$3.prototype,"originalVideoWidth",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1600}}),_descriptor3$1=_applyDecoratedDescriptor(_class$3.prototype,"originalVideoHeight",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 900}}),_descriptor4=_applyDecoratedDescriptor(_class$3.prototype,"videoStartOffsetTime",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor5=_applyDecoratedDescriptor(_class$3.prototype,"videoEndOffsetTime",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor6=_applyDecoratedDescriptor(_class$3.prototype,"videoPlayerContainer",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_descriptor7=_applyDecoratedDescriptor(_class$3.prototype,"clientWidth",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor8=_applyDecoratedDescriptor(_class$3.prototype,"clientHeight",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor9=_applyDecoratedDescriptor(_class$3.prototype,"state",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return INITIALISING}}),_descriptor10=_applyDecoratedDescriptor(_class$3.prototype,"previousState",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return INITIALISING}}),_descriptor11=_applyDecoratedDescriptor(_class$3.prototype,"videoState",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return INITIALISING}}),_descriptor12=_applyDecoratedDescriptor(_class$3.prototype,"currentTime",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor13=_applyDecoratedDescriptor(_class$3.prototype,"startTime",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor14=_applyDecoratedDescriptor(_class$3.prototype,"duration",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor15=_applyDecoratedDescriptor(_class$3.prototype,"absoluteBumperBeginTime",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor16=_applyDecoratedDescriptor(_class$3.prototype,"isFullScreen",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor17=_applyDecoratedDescriptor(_class$3.prototype,"originalVideoWidth",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor18=_applyDecoratedDescriptor(_class$3.prototype,"originalVideoHeight",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_descriptor19=_applyDecoratedDescriptor(_class$3.prototype,"controls",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Controls(this)}}),_descriptor20=_applyDecoratedDescriptor(_class$3.prototype,"errorMessage",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new ErrorMessage(this)}}),_descriptor21=_applyDecoratedDescriptor(_class$3.prototype,"layerStates",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new LayerStates(this)}}),_descriptor22=_applyDecoratedDescriptor(_class$3.prototype,"imageMap",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_descriptor23=_applyDecoratedDescriptor(_class$3.prototype,"hasImageMapLoaded",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor24=_applyDecoratedDescriptor(_class$3.prototype,"fontMap",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_descriptor25=_applyDecoratedDescriptor(_class$3.prototype,"hasFontMapLoaded",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor26=_applyDecoratedDescriptor(_class$3.prototype,"showSubtitles",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_descriptor27=_applyDecoratedDescriptor(_class$3.prototype,"displaySubtitlesButton",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),_descriptor28=_applyDecoratedDescriptor(_class$3.prototype,"muted",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor29=_applyDecoratedDescriptor(_class$3.prototype,"mobileLandscapeOnFullscreen",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor30=_applyDecoratedDescriptor(_class$3.prototype,"loadingStartTime",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_applyDecoratedDescriptor(_class$3.prototype,"setLoadingStartTime",[_dec$3],Object.getOwnPropertyDescriptor(_class$3.prototype,"setLoadingStartTime"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"resetLoadingStartTime",[_dec2$2],Object.getOwnPropertyDescriptor(_class$3.prototype,"resetLoadingStartTime"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"currentState",[computed],Object.getOwnPropertyDescriptor(_class$3.prototype,"currentState"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"layers",[computed],Object.getOwnPropertyDescriptor(_class$3.prototype,"layers"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"measurements",[computed],Object.getOwnPropertyDescriptor(_class$3.prototype,"measurements"),_class$3.prototype),_descriptor31=_applyDecoratedDescriptor(_class$3.prototype,"layersJson",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),_descriptor32=_applyDecoratedDescriptor(_class$3.prototype,"videoBackgroundColour",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"#000000"}}),_descriptor33=_applyDecoratedDescriptor(_class$3.prototype,"useGrid",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor34=_applyDecoratedDescriptor(_class$3.prototype,"useTimeInMillis",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor35=_applyDecoratedDescriptor(_class$3.prototype,"showMouseCoords",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor36=_applyDecoratedDescriptor(_class$3.prototype,"autoLoop",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_descriptor37=_applyDecoratedDescriptor(_class$3.prototype,"logStateChange",[observable],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_applyDecoratedDescriptor(_class$3.prototype,"updateCurrentTime",[_dec3$1],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateCurrentTime"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateDuration",[_dec4],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateDuration"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateStartTime",[_dec5],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateStartTime"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateControlsAlwaysOn",[_dec6],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateControlsAlwaysOn"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"setShowControlsTimeout",[_dec7],Object.getOwnPropertyDescriptor(_class$3.prototype,"setShowControlsTimeout"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"clearShowControlsTimeout",[_dec8],Object.getOwnPropertyDescriptor(_class$3.prototype,"clearShowControlsTimeout"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateIsMouseOnControls",[_dec9],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateIsMouseOnControls"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"update",[_dec10],Object.getOwnPropertyDescriptor(_class$3.prototype,"update"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateAutoLoop",[_dec11],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateAutoLoop"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateShowMouseCoords",[_dec12],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateShowMouseCoords"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateUseTimeInMillis",[_dec13],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateUseTimeInMillis"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateUseGrid",[_dec14],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateUseGrid"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateLogStateChange",[_dec15],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateLogStateChange"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateBackgroundColour",[_dec16],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateBackgroundColour"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateMeasurements",[_dec17],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateMeasurements"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateErrorMessage",[_dec18],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateErrorMessage"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateImageMap",[_dec19],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateImageMap"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateFontMap",[_dec20],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateFontMap"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"updateDevOptions",[_dec21],Object.getOwnPropertyDescriptor(_class$3.prototype,"updateDevOptions"),_class$3.prototype),_applyDecoratedDescriptor(_class$3.prototype,"init",[_dec22],Object.getOwnPropertyDescriptor(_class$3.prototype,"init"),_class$3.prototype),_class$3),actions=function(e){var t=e.store;return{updateBackgroundColour:t.updateBackgroundColour,updateUseGrid:t.updateUseGrid,updateUseTimeInMillis:t.updateUseTimeInMillis,updateShowMouseCoords:t.updateShowMouseCoords,updateControlsAlwaysOn:t.updateControlsAlwaysOn,updateAutoLoop:t.updateAutoLoop,updateLogStateChange:t.updateLogStateChange,updateDuration:t.updateDuration,updateDevOptions:t.updateDevOptions}},IMAGE="image",TEXT="text",SUBTITLE="subtitle",BLOCK="block",INFOGRAPHIC="infographic",VIDEO="video",fetchImageFromUrl=function(i,n){return new Promise(function(e,t){var r=new Image;r.src=n,r.onload=function(){return e({key:i,url:n,image:r})},r.onerror=function(){return t({key:i,url:n})}})},fetchImagesFromUrls=function(r){return new Promise(function(t){var e=r.map(function(e){var t=e.url,r=e.key;return fetchImageFromUrl(r,t)});0<e.length?Promise.all(e).then(function(e){t(e.map(function(e){var t=e.image,r=e.key;return{url:t.src,height:t.height,width:t.width,key:r}}))}):t([])})},fetchAssetUrlsFromServer=function(e,t){var r=t.map(function(e){return{key:e,url:e}}),i={};return 0<r.length?new Promise(function(t){e("asset_urls",{body:JSON.stringify({assets:r}),method:"POST",credentials:"omit"}).then(function(e){e.assets.forEach(function(e){i[e.key]=e}),t(Object.values(i))})}):Promise.resolve([])},getAssetsToFetch=function(e,t){return e.filter(function(e){return!t[e]&&!e.includes("sbtv-assets:///")}).map(function(e){return{key:e,url:e}})},getImageListFromJson=function(e){return e.reduce(function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t.elements.reduce(function(e,t){if("video"===t.type)return e;var r=[];return t.url&&t.type===IMAGE&&(r=[].concat(_toConsumableArray(r),[t.url])),t.clip_thumbnail_url&&(r=[].concat(_toConsumableArray(r),[t.url])),[].concat(_toConsumableArray(e),_toConsumableArray(r))},[])))},[]).filter(function(e){return!!e})},getVideoListFromJson=function(e){return e.reduce(function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t.elements.reduce(function(e,t){return t.url&&t.type===VIDEO?[].concat(_toConsumableArray(e),[t.url]):e},[])))},[]).filter(function(e){return!!e})},filterLoadedAssets=function(e,t){return e.filter(function(e){return!t[e]&&e.includes("sbtv-assets:///")})},removeDuplicateImages=function(e){return Array.from(new Set(e))},loadImagesAndVideos=function(o,e,t){var r={},i=getImageListFromJson(t),n=getVideoListFromJson(t),l=filterLoadedAssets(i,e),u=filterLoadedAssets(n,e),c=getAssetsToFetch(i,e);getAssetsToFetch(n,e);return(0<l.length||0<u.length)&&(r=[].concat(_toConsumableArray(l),_toConsumableArray(u)).reduce(function(e,t){return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},t,t))},{})),{needsUpdate:0<l.length||0<u.length,map:r,promise:new Promise(function(){var t=_asyncToGenerator(regenerator.mark(function e(t){var r,i,n,a,s;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetchAssetUrlsFromServer(o,[].concat(_toConsumableArray(l),_toConsumableArray(u)));case 2:return r=e.sent,i=u,n=r.filter(function(e){var t=e.key;return 0<=i.indexOf(t)}),a=r.filter(function(e){var t=e.key;return-1===i.indexOf(t)}),e.next=8,fetchImagesFromUrls(removeDuplicateImages([].concat(_toConsumableArray(a),_toConsumableArray(c))));case 8:s=e.sent,t([].concat(_toConsumableArray(s),_toConsumableArray(n)).reduce(function(e,t){var r=t.key,i=_objectWithoutProperties(t,["key"]);return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},r,i))},{}));case 10:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}},fontfaceobserver_standalone=createCommonjsModule(function(e){function n(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function b(e){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(e)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function S(e,t){e.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function a(e){var t=e.a.offsetWidth,r=t+100;return e.f.style.width=r+"px",e.c.scrollLeft=r,e.b.scrollLeft=e.b.scrollWidth+100,e.g!==t&&(e.g=t,1)}function T(e,t){function r(){var e=i;a(e)&&e.a.parentNode&&t(e.g)}var i=e;n(e.b,r),n(e.c,r),a(e)}function t(e,t){var r=t||{};this.family=e,this.style=r.style||"normal",this.weight=r.weight||"normal",this.stretch=r.stretch||"normal"}function i(){return null===o&&(o=!!document.fonts),o}function _(e,t){return[e.style,e.weight,function(){if(null===r){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(e){}r=""!==e.style.font}return r}()?e.stretch:"","100px",t].join(" ")}var I,s,r,o;o=r=s=I=null,t.prototype.load=function(e,t){var p=this,g=e||"BESbswy",m=0,y=t||3e3,v=(new Date).getTime();return new Promise(function(f,h){if(i()&&!function(){if(null===s)if(i()&&/Apple/.test(window.navigator.vendor)){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);s=!!e&&parseInt(e[1],10)<603}else s=!1;return s}()){var e=new Promise(function(r,e){!function t(){(new Date).getTime()-v>=y?e(Error(y+"ms timeout exceeded")):document.fonts.load(_(p,'"'+p.family+'"'),g).then(function(e){1<=e.length?r():setTimeout(t,25)},e)}()}),t=new Promise(function(e,t){m=setTimeout(function(){t(Error(y+"ms timeout exceeded"))},y)});Promise.race([t,e]).then(function(){clearTimeout(m),f(p)},h)}else r=function(){function r(){var e;(e=-1!=s&&-1!=o||-1!=s&&-1!=l||-1!=o&&-1!=l)&&((e=s!=o&&s!=l&&o!=l)||(null===I&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),I=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)),e=I&&(s==t&&o==t&&l==t||s==u&&o==u&&l==u||s==c&&o==c&&l==c)),e=!e),e&&(d.parentNode&&d.parentNode.removeChild(d),clearTimeout(m),f(p))}var i=new b(g),n=new b(g),a=new b(g),s=-1,o=-1,l=-1,t=-1,u=-1,c=-1,d=document.createElement("div");d.dir="ltr",S(i,_(p,"sans-serif")),S(n,_(p,"serif")),S(a,_(p,"monospace")),d.appendChild(i.a),d.appendChild(n.a),d.appendChild(a.a),document.body.appendChild(d),t=i.a.offsetWidth,u=n.a.offsetWidth,c=a.a.offsetWidth,function e(){if((new Date).getTime()-v>=y)d.parentNode&&d.parentNode.removeChild(d),h(Error(y+"ms timeout exceeded"));else{var t=document.hidden;!0!==t&&void 0!==t||(s=i.a.offsetWidth,o=n.a.offsetWidth,l=a.a.offsetWidth,r()),m=setTimeout(e,50)}}(),T(i,function(e){s=e,r()}),S(i,_(p,'"'+p.family+'",sans-serif')),T(n,function(e){o=e,r()}),S(n,_(p,'"'+p.family+'",serif')),T(a,function(e){l=e,r()}),S(a,_(p,'"'+p.family+'",monospace'))},document.body?r():document.addEventListener?document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e),r()}):document.attachEvent("onreadystatechange",function e(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",e),r())});var r})},e.exports=t}),getFontListFromJson=function(e){return e.reduce(function(e,t){return _objectSpread2(_objectSpread2({},e),t.elements.reduce(function(e,t){return t.font&&t.fontUrl?_objectSpread2(_objectSpread2({},e),{},_defineProperty({},t.font,t.fontUrl)):e},{}))},{})},filterLoadedFonts=function(a,e){return Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return a[i]?e:_objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,n))},{})},addFontToDocument=function(e,t){var r=document.getElementsByTagName("head")[0],i=document.createElement("style");return i.innerHTML="@import url('".concat(t,"');"),r.appendChild(i),new fontfaceobserver_standalone(e).load()},loadFonts=function(e,t){var r=filterLoadedFonts(e,getFontListFromJson(t));return{needsUpdate:0<Object.entries(r).length,map:r,promise:new Promise(function(e){var t=Object.entries(r).map(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];return addFontToDocument(r,i)});Promise.all(t).then(function(){e(r)}).catch(function(e){return console.error("Something went wrong loading a font",e)})})}},loadAssets=function(e){var t=e.service,r=e.imageMapFromStore,i=e.fontMapFromStore,n=e.projectJson,a=loadImagesAndVideos(t,r,n),s=loadFonts(i,n);return{imageMap:a.map,fontMap:s.map,imagesLoading:a.needsUpdate,fontsLoading:s.needsUpdate,promise:new Promise(function(n){Promise.all([a.promise,s.promise]).then(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];n({imageMap:r,fontMap:i})})})}},parseValue=function(e){var t=e.replace("{","").replace("}","").split(",");return 1<t.length?t.map(function(e){return parseFloat(e)}):parseFloat(t)};function map3dRotations(e){if(e.type&&e.type.includes("3DRotate")){var t=e.type.includes("From"),r=e.xFactor,i=e.yFactor,n=e.zFactor,a=e.angle,s="".concat(r,",").concat(i,",").concat(n,",0"),o="".concat(r,",").concat(i,",").concat(n,",").concat(a),l=t?s:o,u=t?o:s;return _objectSpread2(_objectSpread2({},e),{},{keyPath:"transform_rotation3d",toValue:l,fromValue:u})}return e}var mapKeyPath=function(e){return e.replace(/\./g,"_")},sortAnimationsByBeginTime=function(e){var t=_toConsumableArray(e);return t.sort(function(e,t){return e.beginTime-t.beginTime}),t},mapAnimations=function(){return function(e){return sortAnimationsByBeginTime(e.filter(function(e){return!(e.type&&e.type.includes("3D")&&!e.type.includes("3DRotate"))}).filter(function(e){return!(e.toValue===e.fromValue&&0===e.beginTime)}).map(map3dRotations).map(function(e){return _objectSpread2(_objectSpread2({},e),{},{keyPath:mapKeyPath(e.keyPath),beginTime:parseFloat(e.beginTime),duration:parseFloat(e.duration),toValue:parseValue(e.toValue),fromValue:parseValue(e.fromValue)})}))}},mapInfographicProperties=function(e){return{imagePositionX:e.imagePositionX,imagePositionY:e.imagePositionY,imageScale:e.imageScale}},mapVideoLayerProperties=function(e){return{audioDisabled:!!e.audioDisabled}},mapLayerType=function(e){var t=e.type,r=e.id,i=e.url,n=e.textValue,a=e.link,s=e.trigger,o=_objectWithoutProperties(e,["type","id","url","textValue","link","trigger"]),l=t;return t===INFOGRAPHIC&&(l=r),omitNullProps(_objectSpread2(_objectSpread2({type:l,src:t===IMAGE||t===VIDEO?i:null,textValue:n,link:a,trigger:s},mapInfographicProperties(o)),mapVideoLayerProperties(o)))},mapFont=function(e,t,r,i){return e?{"font-family":e,"-webkit-font-smoothing":"auto","text-rendering":"geometricPrecision","font-size":t?{value:t,unit:"px"}:null,"line-height":r?{value:r,unit:"px"}:"normal","letter-spacing":i?{value:i,unit:"px"}:"initial"}:{}},containsTransformScaleAndTranslate=function(e){return e.some(function(e){return e.keyPath.includes("scale")})&&e.some(function(e){return e.keyPath.includes("position")})},containsTransformScaleX=function(e){return e.some(function(e){return e.keyPath.includes("scale.x")})},containsTransformScaleY=function(e){return e.some(function(e){return e.keyPath.includes("scale.y")})},containsTransformScales=function(e){return containsTransformScaleX(e)||containsTransformScaleY(e)},shouldUseAnchorPoint=function(e){return containsTransformScaleAndTranslate(e)||containsTransformScales(e)},mapTansformOrigin=function(e){var t=e.anchorPoint,r=e.otherAnimations;return r&&shouldUseAnchorPoint(r)?t?containsTransformScales(r)?{values:parseValue(t).map(function(e){return 100*e}),unit:"%"}:containsTransformScaleX(r)?{values:[parseValue(t)[0],1],unit:"%"}:containsTransformScaleY(r)?{values:[1,parseValue(t)[1]],unit:"%"}:{values:parseValue(t).map(function(e){return 100*e}),unit:"%"}:{values:[50,50],unit:"%"}:null},mapRGBAColor=function(e,t){var r=1<arguments.length&&void 0!==t?t:function(e){return e};return e?e.endsWith("Color")?e.replace("Color",""):"rgba(".concat(e.replace("#","").split(":").map(function(e,t){return 3===t?r(e)/100:e}).join(","),")"):null},mapFrameDimensions=function(e,t){return e?{height:{value:e.h,unit:"px"},width:{value:e.w,unit:"px"},left:{value:e.x,unit:"px"},top:{value:e.y,unit:"px"}}:t},mapZIndex=function(e,t,r){if(t===SUBTITLE)return 199;if(e.zIndex)return e.zIndex;var i=e.frame||r;return 1600===i.w&&900===i.h?90:100},mapBoxShadow=function(e){var t=e.shadowOpacity,r=e.shadowRadius,i=e.shadowColor,n=e.shadowOffset;return i?{offset:{value:[n[0],n[1]],unit:"px"},radius:{value:r,unit:"px"},color:mapRGBAColor(i,function(e){return t*e})}:null},mapWhiteSpace=function(e){return e.type!==TEXT?null:"on"===e.textWrapping?"pre-wrap":"pre"},DEFAULT_169_FRAME={height:{value:900,unit:"px"},width:{value:1600,unit:"px"},left:{value:0,unit:"px"},top:{value:0,unit:"px"}},mapPadding=function(e){return e?{values:e.split(",").map(function(e){return parseFloat(e.trim())}),unit:"px"}:null},mapStyles=function(e){var t=e.parentType,r=e.config;return omitNullProps(_objectSpread2(_objectSpread2(_objectSpread2({},mapFrameDimensions(r.frame,DEFAULT_169_FRAME)),{},{position:"absolute","transform-origin":mapTansformOrigin(r),"background-color":mapRGBAColor(r.type===TEXT?r.textBackgroundColor?r.textBackgroundColor:r.backgroundColor:r.color)},mapFont(r.font,r.fontSize,r.lineHeight,r.letterSpacing)),{},{color:mapRGBAColor(r.textColor),"z-index":mapZIndex(r,t,DEFAULT_169_FRAME),"text-align":r.textAlign,"box-shadow":mapBoxShadow(r),"white-space":mapWhiteSpace(r),padding:mapPadding(r.padding),textPadding:mapPadding(r.textPadding),"border-radius":r.type===TEXT&&r.textBackgroundRadius?r.textBackgroundRadius:r.cornerRadius}))},mapLayer=function(r,i,n,a){return function(e,t){return _objectSpread2(_objectSpread2({id:"".concat(i,".").concat(r,".").concat(t,".").concat(e.id),styles:mapStyles({config:e,width:n,height:a,parentType:r}),absoluteBeginTime:e.absoluteLayerBeginTime,absoluteEndTime:e.absoluteLayerEndTime,animations:e.otherAnimations&&mapAnimations(e.id)(e.otherAnimations)},mapLayerType(e)),{},{parentType:r})}},mapLayers=function(e){var n=0<arguments.length&&void 0!==e?e:0;return function(e,t,r,i){return i.map(function(){return mapLayer(r,n,e,t).apply(void 0,arguments)})}},mapStateElements=function(r,i,n,a){function s(t){return _objectSpread2(_objectSpread2(_objectSpread2({},e.find(function(e){return e.id===t.id})||{}),t),{},{otherAnimations:t.otherAnimations})}var o=n.states?n.states:{},e=n.elements;return Object.keys(o).reduce(function(e,t){return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},t,_objectSpread2(_objectSpread2({},o[t]),{},{elements:o[t].elements?a(r,i,n.layerType,o[t].elements.map(s)):[]})))},{})},en="en",fr="fr",it="it",de="de",supportedLanguages={en:en,fr:fr,it:it,de:de},getBrowserLanguage=function(){return Array.from(new Set(navigator.languages.map(function(e){return e.split("-")[0]}))).find(function(e){return!!supportedLanguages[e]})||supportedLanguages.en},escapeQuotes=function(e){return e.replace(/'/g,"'").replace(/\n/g,"").replace(/\\([\s\S])|(")/g,"\\$1$2")};function getVal(e,t){if(void 0===t)return t;var r=e.shift(),i=t;if(-1<r.indexOf("[")){var n=r.match(/(\w+)\[(\d+)\]/);null!==n&&(r=n[2],i=t[n[1]])}return 0===e.length?i[r]:i?getVal(e,i[r]):void 0}function getTokenValueFromData(e,t){var r=getVal(e.data_path.split("."),t)||e.default_value;return escapeQuotes(String(r))}function replaceTokensWithData(e,t){for(var r,i=RegExp("({{)(.*?)(}})","g"),n=JSON.stringify(e);r=i.exec(JSON.stringify(e));){var a=r[2].replace(/\\/g,"").trim(),s=getTokenValueFromData(JSON.parse(a),t);n=n.replaceAll(r[0],s)}return JSON.parse(n)}function mapVideoToBlob(e,t){return _mapVideoToBlob.apply(this,arguments)}function _mapVideoToBlob(){return(_mapVideoToBlob=_asyncToGenerator(regenerator.mark(function e(t,r){var i,n,a;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(r.src);case 2:return i=e.sent,e.next=5,i.blob();case 5:return n=e.sent,a=URL.createObjectURL(n),e.abrupt("return",_objectSpread2(_objectSpread2({},t),{},{elements:[].concat(_toConsumableArray(t.elements),[_objectSpread2(_objectSpread2({},r),{},{src:a})])}));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function mapVideosToBlobs(e){return _mapVideosToBlobs.apply(this,arguments)}function _mapVideosToBlobs(){return(_mapVideosToBlobs=_asyncToGenerator(regenerator.mark(function e(t){var r,i,n,a,s;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=[],i=_createForOfIteratorHelper(t);try{for(a=function(){var t=n.value,e=t.elements.filter(function(e){return"video"===e.type});r.push.apply(r,_toConsumableArray(e.map(function(e){return mapVideoToBlob(_objectSpread2(_objectSpread2({},t),{},{elements:t.elements.filter(function(e){return"video"!==e.type})}),e)})))},i.s();!(n=i.n()).done;)a()}catch(e){i.e(e)}finally{i.f()}return e.next=5,Promise.all(r);case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}var mapQueryParamsToString=function(e){var t=Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return"".concat(e,"&").concat(i,"=").concat(n)},"")||"";return 0<t.length?"?".concat(t.substring(1,t.length)):""},fetchProject=function(){var t=_asyncToGenerator(regenerator.mark(function e(t){var r,i,n,a,s,o,l,u,c,d,f,h,p,g,m,y,v,b,S,T,_,I,M,A,D,w,E,C;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.service,i=t.projectId,n=t.preloadedProjectJSON,a=t.clientWidth,s=t.clientHeight,o=t.transformProjectJson,l=t.serviceQueryParams,u=t.data,c=mapQueryParamsToString(_objectSpread2({language:getBrowserLanguage()},l)),e.prev=2,i)return e.next=6,r("player/".concat(i).concat(c),{method:"GET",options:{mode:"cors"}});e.next=9;break;case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=JSON.parse(n);case 10:return d=e.t0,f=d.project,h=d.name,p=d.duration,g=d.openerDuration,m=d.bumperDuration,y=d.bumperBeginTime,v=replaceTokensWithData(o(f),u),b=g,S=m,T=v.filter(function(e){return"video"===e.layerType}),_=T[0].elements[0].clip_thumbnail_url,I=T.map(function(e){return{src:e.elements[0].url,srcHLS:e.elements[0].url_hls,duration:e.elements[0].duration,videoClipStart:e.elements[0].beginTime,startTime:e.elements[0].absoluteLayerBeginTime,endTime:e.elements[0].absoluteLayerEndTime}}),M=v.filter(function(e){return"video"!==e.layerType}).map(function(e,t){return _objectSpread2(_objectSpread2({},e),{},{elements:mapLayers(t)(a,s,e.layerType,e.elements),states:mapStateElements(a,s,e,mapLayers(t))})}),A=M.filter(function(e){return!!e.elements.find(function(e){return"video"===e.type})}),D=M.filter(function(e){return void 0===e.elements.find(function(e){return"video"===e.type})}),e.next=23,mapVideosToBlobs(A);case 23:return w=e.sent,E=[].concat(_toConsumableArray(D),_toConsumableArray(w)),C=v.filter(function(e){return e.layerType===SUBTITLE}),e.abrupt("return",{videoPoster:_,mappedLayers:E,videoStartOffsetTime:b,videoEndOffsetTime:S,projectJson:v,videos:I,projectName:h,projectDuration:p,bumperBeginTime:y,displaySubtitlesButton:C});case 29:throw e.prev=29,e.t1=e.catch(2),Error({message:"Unable to load video"});case 32:case"end":return e.stop()}},e,null,[[2,29]])}));return function(e){return t.apply(this,arguments)}}(),Component=function(){function t(e){_classCallCheck(this,t),this.refs={},this.create(e)}return _createClass(t,[{key:"create",value:function(e){e&&(this.createElement(e),this.attachListeners(e),this.attachRef(e))}},{key:"createElement",value:function(e){this.element=this.root(e),e.id||""===e.id||(this.element.id=this.constructor.name),e.id&&(this.element.id=e.id)}},{key:"attachRef",value:function(e){e.ref&&e.ref(this)}},{key:"attachListeners",value:function(e){if(e.eventListeners){var t=e.eventListeners,r=t.resize,i=_objectWithoutProperties(t,["resize"]);addEventListeners(this.element,i),r&&new ResizeObserver(r).observe(this.element)}}},{key:"isElementInDOM",value:function(){return isElementInDOM(this.element)}},{key:"getElement",value:function(){return this.element}},{key:"getClassName",value:function(){return this.constructor.name}},{key:"root",value:function(){throw Error("Must override root()")}},{key:"update",value:function(){throw Error("Must override update()")}},{key:"addClass",value:function(e){this.element.classList.add(e)}},{key:"removeClass",value:function(e){this.element.classList.remove(e)}}]),t}(),createFactory=function(i){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _construct(i,t)}},ElementWrapper=function(n){return function(){_inherits(t,Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(e){var t=e.children,r=(e.ref,_objectWithoutProperties(e,["children","ref"])),i=n;return t?jsx(i,r,t):jsx(i,r)}},{key:"update",value:function(e){var n=this;Object.entries(e).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],i=t[1];n.element.setAttribute(r,i)})}},{key:"setTextContent",value:function(e){this.element.textContent=e}}]),t}()},createElementWrapper=function(e){return createFactory(ElementWrapper(e))},append=function(e,t){if(0<t.length){var r=document.createDocumentFragment();t.forEach(function(e){r.appendChild(e)}),e.appendChild(r)}},handleTextElement=function(e){return createDOMElement({elementName:"string",textContent:e})},handleArray=function(e){return e.reduce(function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(handleTypes(t)))},[])},handleFunction=function(e){return e.elementName(_objectSpread2(_objectSpread2({},e.attributes),{},{children:e.children})).getElement()},handleTypes=function(e){return"string"==typeof e||"number"==typeof e&&!Number.isNaN(e)?[handleTextElement(e.toString())]:Array.isArray(e)?handleArray(e):"function"==typeof e?[handleFunction(e)]:e?[e]:[]},jsx=function(e,t){t=t||{},"string"==typeof e&&t.ref&&(e=createElementWrapper(e));for(var r=arguments.length,i=new Array(2<r?r-2:0),n=2;n<r;n++)i[n-2]=arguments[n];var a={elementName:e,attributes:t,children:i};if("string"===a.elementName)return handleTextElement(a.children?a.children[0]:null);if("string"!=typeof a.elementName)return"function"==typeof a.elementName?handleFunction(a):a;var s=createDOMElement(_objectSpread2({elementName:a.elementName},a.attributes));if(a.children){var o=a.children.reduce(function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(handleTypes(t)))},[]);append(s,o)}return s},createRef=function(t,r){return function(e){t.refs||(t.refs={}),t.refs[r]=e}},Container=function(){_inherits(i,Component);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this,e)).store=e.store,t.subscribe(t.update.bind(_assertThisInitialized(t))),t}return _createClass(i,[{key:"subscribe",value:function(){throw Error("Must override subscribe()")}},{key:"addElementToSelf",value:function(e){this.addElementToTarget(e,this.element)}},{key:"addElementToTarget",value:function(e,t){Array.isArray(e)?append(t,e):append(t,[e])}}]),i}(),styles={root:"styles_root__2yUun",fullScreen:"styles_fullScreen__2Bof3",sizer:"styles_sizer__a4fA6"},VideoPlayerContainer=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(e){return this.initialWidth=e.initialWidth,this.currentlySetWidth=0,this.currentlySetHeight=0,this.currentlyFullScreen=!1,jsx("div",{className:styles.root},e.children)}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({videoBackgroundColour:t.store.videoBackgroundColour,showControls:t.store.controls.showControls,measurements:t.store.measurements,isFullScreen:t.store.isFullScreen,originalVideoWidth:t.store.originalVideoWidth,originalVideoHeight:t.store.originalVideoHeight,currentState:t.store.currentState})},autorunConfig)}},{key:"update",value:function(e){var t=e.videoBackgroundColour,r=void 0===t?"#000000":t,i=e.showControls,n=e.measurements,a=n.clientWidth,s=n.clientHeight,o=e.originalVideoWidth,l=e.originalVideoHeight,u=e.isFullScreen,c=e.currentState===INITIALISING;this.element.style.backgroundColor=r,this.element.style.cursor=i?"":"none";var d=a,f=a*(l||s)/(o||a);o<l&&(f=a*(o/l)),!c&&(o||l)||(f=9*(d=this.initialWidth)/16);var h=!1;u!==this.currentlyFullScreen&&(this.currentlyFullScreen=u,this.currentlySetWidth=d,this.currentlySetHeight=f,this.currentlyFullScreen?this.element.style=convertStyleMapToInlineStyles({height:"100%",width:"100%"}):h=!0);var p=0<d&&0<f,g=!u&&(this.currentlySetWidth!==d||this.currentlySetHeight!==f&&p);(h||g)&&(c||(this.currentlySetWidth=d,this.currentlySetHeight=f),this.element.style=convertStyleMapToInlineStyles({height:"".concat(f,"px")}))}},{key:"attachRef",value:function(e){e.ref&&e.ref(this)}},{key:"getElement",value:function(){return this.element}},{key:"setFullScreen",value:function(){this.element.classList.add(styles.fullScreen)}},{key:"removeFullScreen",value:function(){this.element.classList.remove(styles.fullScreen)}},{key:"clientWidth",value:function(e){return e?window.innerWidth:this.element.clientWidth}},{key:"clientHeight",value:function(e){return e?window.innerHeight:this.element.clientHeight}},{key:"getOffsetLeft",value:function(){return this.element.offsetLeft}}]),t}(),VideoPlayerContainer$1=createFactory(VideoPlayerContainer),transformVideoSource=function(e){return e?e.startsWith("http")&&!e.startsWith("https")&&"https:"===window.location.protocol?e.replace("http","https"):e:null},hls=createCommonjsModule(function(e,t){var r;"undefined"!=typeof window&&(r=function(){return i={},n.m=r={"./node_modules/eventemitter3/index.js":function(e,t,r){var i=Object.prototype.hasOwnProperty,h="~";function n(){}function o(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,r,i,n){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,n),s=h?h+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],a]:e._events[s].push(a):(e._events[s]=a,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(h=!1)),s.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)i.call(e,t)&&r.push(h?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},s.prototype.listeners=function(e){var t=h?h+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,a=new Array(n);i<n;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=h?h+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,n,a){var s=h?h+e:e;if(!this._events[s])return!1;var o,l,u=this._events[s],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,n),!0;case 6:return u.fn.call(u.context,t,r,i,n,a),!0}for(l=1,o=new Array(c-1);l<c;l++)o[l-1]=arguments[l];u.fn.apply(u.context,o)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),c){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!o)for(d=1,o=new Array(c-1);d<c;d++)o[d-1]=arguments[d];u[l].fn.apply(u[l].context,o)}}return!0},s.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,r,i){var n=h?h+e:e;if(!this._events[n])return this;if(!t)return u(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||u(this,n);else{for(var s=0,o=[],l=a.length;s<l;s++)(a[s].fn!==t||i&&!a[s].once||r&&a[s].context!==r)&&o.push(a[s]);o.length?this._events[n]=1===o.length?o[0]:o:u(this,n)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=h?h+e:e,this._events[t]&&u(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=h,s.EventEmitter=s,e.exports=s},"./node_modules/url-toolkit/src/url-toolkit.js":function(e,t,r){var i,c,n,a,d;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/?#]*)(.*)$/,n=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,d={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=d.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=d.normalizePath(i.path),d.buildURLFromParts(i)}var n=d.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return r.alwaysNormalize?(n.path=d.normalizePath(n.path),d.buildURLFromParts(n)):t;var a=d.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var s=c.exec(a.path);a.netLoc=s[1],a.path=s[2]}a.netLoc&&!a.path&&(a.path="/");var o={scheme:a.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(o.netLoc=a.netLoc,"/"!==n.path[0]))if(n.path){var l=a.path,u=l.substring(0,l.lastIndexOf("/")+1)+n.path;o.path=d.normalizePath(u)}else o.path=a.path,n.params||(o.params=a.params,n.query||(o.query=a.query));return null===o.path&&(o.path=r.alwaysNormalize?d.normalizePath(n.path):n.path),d.buildURLFromParts(o)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(n,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=d},"./node_modules/webworkify-webpack/index.js":function(e,t,h){function l(r){var i={};function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=r,n.c=i,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var e=n(n.s=ENTRY_MODULE);return e.default||e}var p="[\\.|\\-|\\+|\\w|/|@]+",g="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function m(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(e,t,r){var i={};i[r]=[];var n=t.toString(),a=n.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!a)return i;for(var s,o=a[1],l=new RegExp("(\\\\n|\\W)"+m(o)+g,"g");s=l.exec(n);)"dll-reference"!==s[3]&&i[r].push(s[3]);for(l=new RegExp("\\("+m(o)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+g,"g");s=l.exec(n);)e[s[2]]||(i[r].push(s[1]),e[s[2]]=h(s[1]).m),i[s[2]]=i[s[2]]||[],i[s[2]].push(s[4]);for(var u,c=Object.keys(i),d=0;d<c.length;d++)for(var f=0;f<i[c[d]].length;f++)u=i[c[d]][f],isNaN(+u)||(i[c[d]][f]=+i[c[d]][f]);return i}function y(r){return Object.keys(r).reduce(function(e,t){return e||0<r[t].length},!1)}e.exports=function(e,t){t=t||{};var r={main:h.m},i=t.all?{main:Object.keys(r.main)}:function(e,t){for(var r={main:[t]},i={main:[]},n={main:{}};y(r);)for(var a=Object.keys(r),s=0;s<a.length;s++){var o=a[s],l=r[o].pop();if(n[o]=n[o]||{},!n[o][l]&&e[o][l]){n[o][l]=!0,i[o]=i[o]||[],i[o].push(l);for(var u=f(e,e[o][l],o),c=Object.keys(u),d=0;d<c.length;d++)r[c[d]]=r[c[d]]||[],r[c[d]]=r[c[d]].concat(u[c[d]])}}return i}(r,e),n="";Object.keys(i).filter(function(e){return"main"!==e}).forEach(function(t){for(var e=0;i[t][e];)e++;i[t].push(e),r[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",n=n+"var "+t+" = ("+l.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i[t].map(function(e){return JSON.stringify(e)+": "+r[t][e].toString()}).join(",")+"});\n"}),n=n+"new (("+l.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+i.main.map(function(e){return JSON.stringify(e)+": "+r.main[e].toString()}).join(",")+"}))(self);";var a=new window.Blob([n],{type:"text/javascript"});if(t.bare)return a;var s=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(a),o=new window.Worker(s);return o.objectURL=s,o}},"./src/crypt/decrypter.js":function(e,t,r){r.r(t);var o=function(){function e(e,t){this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),l=function(){function e(e,t){this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();var u=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),i=0;i<4;i++)r[i]=t.getUint32(4*i);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],s=r[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],f=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)f[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var m=p^p<<1^p<<2^p<<3^p<<4;m=m>>>8^255&m^99;var y=f[t[e[h]=m]=h],v=f[y],b=f[v],S=257*f[m]^16843008*m;i[h]=S<<24|S>>>8,n[h]=S<<16|S>>>16,a[h]=S<<8|S>>>24,s[h]=S,S=16843009*b^65537*v^257*y^16843008*h,l[m]=S<<24|S>>>8,u[m]=S<<16|S>>>16,c[m]=S<<8|S>>>24,d[m]=S,h?(h=y^f[f[f[b^y]]],p^=f[f[p]]):h=p=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,i=0;i<t.length&&r;)r=t[i]===this.key[i],i++;if(!r){this.key=t;var n=this.keySize=t.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,s,o,l,u=this.ksRows=4*(n+6+1),c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),f=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],m=p[1],y=p[2],v=p[3];for(a=0;a<u;a++)a<n?o=c[a]=t[a]:(l=o,a%n==0?(l=f[(l=l<<8|l>>>24)>>>24]<<24|f[l>>>16&255]<<16|f[l>>>8&255]<<8|f[255&l],l^=h[a/n|0]<<24):6<n&&a%n==4&&(l=f[l>>>24]<<24|f[l>>>16&255]<<16|f[l>>>8&255]<<8|f[255&l]),c[a]=o=(c[a-n]^l)>>>0);for(s=0;s<u;s++)a=u-s,l=3&s?c[a]:c[a-4],d[s]=s<4||a<=4?l:g[f[l>>>24]]^m[f[l>>>16&255]]^y[f[l>>>8&255]]^v[f[255&l]],d[s]=d[s]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r,i){for(var n,a,s,o,l,u,c,d,f,h,p,g,m,y,v,b,S,T=this.keySize+6,_=this.invKeySchedule,I=this.invSBox,M=this.invSubMix,A=M[0],D=M[1],w=M[2],E=M[3],C=this.uint8ArrayToUint32Array_(r),L=C[0],O=C[1],N=C[2],k=C[3],x=new Int32Array(e),R=new Int32Array(x.length),j=this.networkToHostOrderSwap;t<x.length;){for(f=j(x[t]),h=j(x[t+1]),p=j(x[t+2]),g=j(x[t+3]),l=f^_[0],u=g^_[1],c=p^_[2],d=h^_[3],m=4,y=1;y<T;y++)n=A[l>>>24]^D[u>>16&255]^w[c>>8&255]^E[255&d]^_[m],a=A[u>>>24]^D[c>>16&255]^w[d>>8&255]^E[255&l]^_[m+1],s=A[c>>>24]^D[d>>16&255]^w[l>>8&255]^E[255&u]^_[m+2],o=A[d>>>24]^D[l>>16&255]^w[u>>8&255]^E[255&c]^_[m+3],l=n,u=a,c=s,d=o,m+=4;n=I[l>>>24]<<24^I[u>>16&255]<<16^I[c>>8&255]<<8^I[255&d]^_[m],a=I[u>>>24]<<24^I[c>>16&255]<<16^I[d>>8&255]<<8^I[255&l]^_[m+1],s=I[c>>>24]<<24^I[d>>16&255]<<16^I[l>>8&255]<<8^I[255&u]^_[m+2],o=I[d>>>24]<<24^I[l>>16&255]<<16^I[u>>8&255]<<8^I[255&c]^_[m+3],m+=3,R[t]=j(n^L),R[t+1]=j(o^O),R[t+2]=j(s^N),R[t+3]=j(a^k),L=f,O=h,N=p,k=g,t+=4}return i?(v=R.buffer,b=v.byteLength,(S=b&&new DataView(v).getUint8(b-1))?v.slice(0,b-S):v):R.buffer},t.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},e}(),a=r("./src/errors.ts"),c=r("./src/utils/logger.js"),s=r("./src/events.js"),i=r("./src/utils/get-self-scope.js"),d=Object(i.getSelfScope)(),n=function(){function e(e,t,r){var i=(void 0===r?{}:r).removePKCS7Padding,n=void 0===i||i;if(this.logEnabled=!0,this.observer=e,this.config=t,this.removePKCS7Padding=n)try{var a=d.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(e){}this.disableWebCrypto=!this.subtle}var t=e.prototype;return t.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},t.decrypt=function(t,r,i,n){var a=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(c.logger.log("JS AES decrypt"),this.logEnabled=!1);var e=this.decryptor;e||(this.decryptor=e=new u),e.expandKey(r),n(e.decrypt(t,0,i,this.removePKCS7Padding))}else{this.logEnabled&&(c.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var s=this.subtle;this.key!==r&&(this.key=r,this.fastAesKey=new l(s,r)),this.fastAesKey.expandKey().then(function(e){new o(s,i).decrypt(t,e).catch(function(e){a.onWebCryptoError(e,t,r,i,n)}).then(function(e){n(e)})}).catch(function(e){a.onWebCryptoError(e,t,r,i,n)})}},t.onWebCryptoError=function(e,t,r,i,n){this.config.enableSoftwareAES?(c.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,i,n)):(c.logger.error("decrypting error : "+e.message),this.observer.trigger(s.default.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))},t.destroy=function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)},e}();t.default=n},"./src/demux/demuxer-inline.js":function(e,t,r){r.r(t);var q=r("./src/events.js"),ee=r("./src/errors.ts"),g=r("./src/crypt/decrypter.js"),p=r("./src/polyfills/number-isFinite.js"),te=r("./src/utils/logger.js"),i=r("./src/utils/get-self-scope.js");function a(e,t){return 255===e[t]&&240==(246&e[t+1])}function c(e,t){return 1&e[t+1]?7:9}function d(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function m(e,t){return!!(t+1<e.length&&a(e,t))}function n(e,t){if(m(e,t)){var r=c(e,t);if(t+r>=e.length)return;var i=d(e,t);if(i<=r)return;var n=t+i;if(n===e.length||n+1<e.length&&a(e,n))return 1}}function y(e,t,r,i,n){if(!e.samplerate){var a=function(e,t,r,i){var n,a,s,o,l,u=navigator.userAgent.toLowerCase(),c=i,d=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(n=1+((192&t[r+2])>>>6),a=(60&t[r+2])>>>2,!(d.length-1<a))return o=(1&t[r+2])<<2,o|=(192&t[r+3])>>>6,te.logger.log("manifest codec:"+i+",ADTS data:type:"+n+",sampleingIndex:"+a+"["+d[a]+"Hz],channelConfig:"+o),s=/firefox/i.test(u)?6<=a?(n=5,l=new Array(4),a-3):(n=2,l=new Array(2),a):-1!==u.indexOf("android")?(n=2,l=new Array(2),a):(n=5,l=new Array(4),i&&(-1!==i.indexOf("mp4a.40.29")||-1!==i.indexOf("mp4a.40.5"))||!i&&6<=a?a-3:((i&&-1!==i.indexOf("mp4a.40.2")&&(6<=a&&1==o||/vivaldi/i.test(u))||!i&&1==o)&&(n=2,l=new Array(2)),a)),l[0]=n<<3,l[0]|=(14&a)>>1,l[1]|=(1&a)<<7,l[1]|=o<<3,5===n&&(l[1]|=(14&s)>>1,l[2]=(1&s)<<7,l[2]|=8,l[3]=0),{config:l,samplerate:d[a],channelCount:o,codec:"mp4a.40."+n,manifestCodec:c};e.trigger(q.default.ERROR,{type:ee.ErrorTypes.MEDIA_ERROR,details:ee.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+a})}(t,r,i,n);e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,te.logger.log("parsed codec:"+e.codec+",rate:"+a.samplerate+",nb channel:"+a.channelCount)}}function v(e){return 9216e4/e}function b(e,t,r,i,n){var a=function(e,t,r,i,n){var a,s,o=e.length;if(a=c(e,t),s=d(e,t),0<(s-=a)&&t+a+s<=o)return{headerLength:a,frameLength:s,stamp:r+i*n}}(t,r,i,n,v(e.samplerate));if(a){var s=a.stamp,o=a.headerLength,l=a.frameLength,u={unit:t.subarray(r+o,r+o+l),pts:s,dts:s};return e.samples.push(u),{sample:u,length:l+o}}}var w=r("./src/demux/id3.js"),I=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){if(!e)return!1;for(var t=(w.default.getID3Data(e,0)||[]).length,r=e.length;t<r;t++)if(n(e,t))return te.logger.log("ADTS sync word found !"),!0;return!1},t.append=function(e,t,r,i){for(var n=this._audioTrack,a=w.default.getID3Data(e,0)||[],s=w.default.getTimeStamp(a),o=Object(p.isFiniteNumber)(s)?90*s:9e4*t,l=0,u=o,c=e.length,d=a.length,f=[{pts:u,dts:u,data:a}];d<c-1;)if(m(e,d)&&d+5<c){y(n,this.observer,e,d,n.manifestCodec);var h=b(n,e,d,o,l);if(!h){te.logger.log("Unable to parse AAC frame");break}d+=h.length,u=h.sample.pts,l++}else w.default.isHeader(e,d)?(a=w.default.getID3Data(e,d),f.push({pts:u,dts:u,data:a}),d+=a.length):d++;this.remuxer.remux(n,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,r,i)},t.destroy=function(){},e}(),M=r("./src/demux/mp4demuxer.js"),S={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(e,t,r,i,n){if(!(r+24>t.length)){var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var s=i+n*(9e4*a.samplesPerFrame/a.sampleRate),o={unit:t.subarray(r,r+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(o),{sample:o,length:a.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3,s=e[t+2]>>1&1;if(1!=r&&0!=n&&15!=n&&3!=a){var o=3==r?3-i:3==i?3:4,l=1e3*S.BitratesMap[14*o+n-1],u=3==r?0:2==r?1:2,c=S.SamplingRateMap[3*u+a],d=e[t+3]>>6==3?1:2,f=S.SamplesCoefficients[r][i],h=S.BytesInSlot[i],p=8*f*h;return{sampleRate:c,channelCount:d,frameLength:parseInt(f*l/c+s,10)*h,samplesPerFrame:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),i=4;r&&r.frameLength&&(i=r.frameLength);var n=t+i;if(n===e.length||n+1<e.length&&this.isHeaderPattern(e,n))return!0}return!1}},T=S,E=function(){function e(e){this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw new Error("no bytes available");i.set(e.subarray(r,r+n)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},t.skipBits=function(e){var t;this.bitsAvailable>e||(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return 32<e&&te.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=e-t)&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){var t,r=8,i=8;for(t=0;t<e;t++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},t.readSPS=function(){var e,t,r,i,n,a,s,o=0,l=0,u=0,c=0,d=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),m=this.skipEG.bind(this),y=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);if(d(),e=d(),f(5),g(3),d(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=h();if(3===b&&g(1),y(),y(),g(1),p())for(a=3!==b?8:12,s=0;s<a;s++)p()&&v(s<6?16:64)}y();var S=h();if(0===S)h();else if(1===S)for(g(1),m(),m(),t=h(),s=0;s<t;s++)m();y(),g(1),r=h(),i=h(),0===(n=f(1))&&g(1),g(1),p()&&(o=h(),l=h(),u=h(),c=h());var T=[1,1];if(p()&&p())switch(d()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[d()<<8|d(),d()<<8|d()]}return{width:Math.ceil(16*(r+1)-2*o-2*l),height:(2-n)*(i+1)*16-(n?2:4)*(u+c),pixelRatio:T}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),s=function(){function e(e,t,r,i){this.decryptdata=r,this.discardEPB=i,this.decrypter=new g.default(e,t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},t.decryptAacSample=function(t,r,i,n){var a=t[r].unit,e=a.subarray(16,a.length-a.length%16),s=e.buffer.slice(e.byteOffset,e.byteOffset+e.length),o=this;this.decryptBuffer(s,function(e){e=new Uint8Array(e),a.set(e,16),n||o.decryptAacSamples(t,r+1,i)})},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,i),!i)return}}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),i=0,n=32;n<=e.length-16;n+=160,i+=16)r.set(e.subarray(n,n+16),i);return r},t.getAvcDecryptedUnit=function(e,t){t=new Uint8Array(t);for(var r=0,i=32;i<=e.length-16;i+=160,r+=16)e.set(t.subarray(r,r+16),i);return e},t.decryptAvcSample=function(t,r,i,n,a,s){var o=this.discardEPB(a.data),e=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(e.buffer,function(e){a.data=l.getAvcDecryptedUnit(o,e),s||l.decryptAvcSamples(t,r,i+1,n)})},t.decryptAvcSamples=function(e,t,r,i){for(;;t++,r=0){if(t>=e.length)return void i();for(var n=e[t].units;!(r>=n.length);r++){var a=n[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var s=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,i,a,s),!s)return}}}},e}(),o={video:1,audio:2,id3:3,text:4},A=function(){function O(e,t,r,i){this.observer=e,this.config=r,this.typeSupported=i,this.remuxer=t,this.sampleAes=null,this.pmtUnknownTypes={}}var e=O.prototype;return e.setDecryptData=function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new s(this.observer,this.config,e,this.discardEPB):this.sampleAes=null},O.probe=function(e){var t=O._syncOffset(e);return!(t<0)&&(t&&te.logger.warn("MPEG2-TS detected but first sync word found @ offset "+t+", junk ahead ?"),!0)},O._syncOffset=function(e){for(var t=Math.min(1e3,e.length-564),r=0;r<t;){if(71===e[r]&&71===e[r+188]&&71===e[r+376])return r;r++}return-1},O.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:o[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===e?0:void 0,isAAC:"audio"===e||void 0,duration:"audio"===e?t:void 0}},e.resetInitSegment=function(e,t,r,i){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=O.createTrack("video",i),this._audioTrack=O.createTrack("audio",i),this._id3Track=O.createTrack("id3",i),this._txtTrack=O.createTrack("text",i),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=r,this._duration=i},e.resetTimeStamp=function(){},e.append=function(e,t,r,i){var n,a,s,o,l,u=e.length,c=!1;this.pmtUnknownTypes={},this.contiguous=r;var d=this.pmtParsed,f=this._avcTrack,h=this._audioTrack,p=this._id3Track,g=f.pid,m=h.pid,y=p.pid,v=this._pmtId,b=f.pesData,S=h.pesData,T=p.pesData,_=this._parsePAT,I=this._parsePMT.bind(this),M=this._parsePES,A=this._parseAVCPES.bind(this),D=this._parseAACPES.bind(this),w=this._parseMPEGPES.bind(this),E=this._parseID3PES.bind(this),C=O._syncOffset(e);for(u-=(u+C)%188,n=C;n<u;n+=188)if(71===e[n]){if(a=!!(64&e[n+1]),s=((31&e[n+1])<<8)+e[n+2],1<(48&e[n+3])>>4){if((o=n+5+e[n+4])===n+188)continue}else o=n+4;switch(s){case g:a&&(b&&(l=M(b))&&A(l,!1),b={data:[],size:0}),b&&(b.data.push(e.subarray(o,n+188)),b.size+=n+188-o);break;case m:a&&(S&&(l=M(S))&&(h.isAAC?D:w)(l),S={data:[],size:0}),S&&(S.data.push(e.subarray(o,n+188)),S.size+=n+188-o);break;case y:a&&(T&&(l=M(T))&&E(l),T={data:[],size:0}),T&&(T.data.push(e.subarray(o,n+188)),T.size+=n+188-o);break;case 0:a&&(o+=e[o]+1),v=this._pmtId=_(e,o);break;case v:a&&(o+=e[o]+1);var L=I(e,o,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(g=L.avc)&&(f.pid=g),0<(m=L.audio)&&(h.pid=m,h.isAAC=L.isAAC),0<(y=L.id3)&&(p.pid=y),c&&!d&&(te.logger.log("reparse from beginning"),c=!1,n=C-188),d=this.pmtParsed=!0;break;case 17:case 8191:break;default:c=!0}}else this.observer.trigger(q.default.ERROR,{type:ee.ErrorTypes.MEDIA_ERROR,details:ee.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});b&&(l=M(b))?(A(l,!0),f.pesData=null):f.pesData=b,S&&(l=M(S))?((h.isAAC?D:w)(l),h.pesData=null):(S&&S.size&&te.logger.log("last AAC PES packet truncated,might overlap between fragments"),h.pesData=S),T&&(l=M(T))?(E(l),p.pesData=null):p.pesData=T,null==this.sampleAes?this.remuxer.remux(h,f,p,this._txtTrack,t,r,i):this.decryptAndRemux(h,f,p,this._txtTrack,t,r,i)},e.decryptAndRemux=function(e,t,r,i,n,a,s){if(e.samples&&e.isAAC){var o=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){o.decryptAndRemuxAvc(e,t,r,i,n,a,s)})}else this.decryptAndRemuxAvc(e,t,r,i,n,a,s)},e.decryptAndRemuxAvc=function(e,t,r,i,n,a,s){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(e,t,r,i,n,a,s)})}else this.remuxer.remux(e,t,r,i,n,a,s)},e.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e._parsePAT=function(e,t){return(31&e[t+10])<<8|e[t+11]},e._trackUnknownPmt=function(e,t,r){var i=this.pmtUnknownTypes[e]||0;return 0===i&&(this.pmtUnknownTypes[e]=0,t.call(te.logger,r)),this.pmtUnknownTypes[e]++,i},e._parsePMT=function(e,t,r,i){var n,a,s={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=t+3+((15&e[t+1])<<8|e[t+2])-4,t+=12+((15&e[t+10])<<8|e[t+11]);t<n;){switch(a=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!i){this._trackUnknownPmt(e[t],te.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===s.audio&&(s.audio=a);break;case 21:-1===s.id3&&(s.id3=a);break;case 219:if(!i){this._trackUnknownPmt(e[t],te.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===s.avc&&(s.avc=a);break;case 3:case 4:r?-1===s.audio&&(s.audio=a,s.isAAC=!1):this._trackUnknownPmt(e[t],te.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(e[t],te.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(e[t],te.logger.log,"Unknown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return s},e._parsePES=function(e){var t,r,i,n,a,s,o,l,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&1<c.length;){var d=new Uint8Array(c[0].length+c[1].length);d.set(c[0]),d.set(c[1],c[0].length),c[0]=d,c.splice(1,1)}if(1!==((t=c[0])[0]<<16)+(t[1]<<8)+t[2])return null;if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;if(192&(r=t[7])&&(4294967295<(s=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)&&(s-=8589934592),64&r?(4294967295<(o=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(o-=8589934592),54e5<s-o&&(te.logger.warn(Math.round((s-o)/9e4)+"s delta between PTS and DTS, align them"),s=o)):o=s),l=(n=t[8])+9,e.size<=l)return null;e.size-=l,a=new Uint8Array(e.size);for(var f=0,h=c.length;f<h;f++){var p=(t=c[f]).byteLength;if(l){if(p<l){l-=p;continue}t=t.subarray(l),p-=l,l=0}a.set(t,u),u+=p}return i&&(i-=n+3),{data:a,pts:s,dts:o,len:i}},e.pushAccesUnit=function(e,t){if(e.units.length&&e.frame){var r=t.samples,i=r.length;if(isNaN(e.pts)){if(!i)return void t.dropped++;var n=r[i-1];e.pts=n.pts,e.dts=n.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(i||this.contiguous)?(e.id=i,r.push(e)):t.dropped++}e.debug.length&&te.logger.log(e.pts+"/"+e.dts+":"+e.debug)},e._parseAVCPES=function(y,e){function v(e,t,r,i){return{key:e,pts:t,dts:r,units:[],debug:i}}var b,S,T,_=this,I=this._avcTrack,t=this._parseAVCNALu(y.data),M=this.avcSample,A=!1,D=this.pushAccesUnit.bind(this);y.data=null,M&&t.length&&!I.audFound&&(D(M,I),M=this.avcSample=v(!1,y.pts,y.dts,"")),t.forEach(function(e){switch(e.type){case 1:S=!0,(M=M||(_.avcSample=v(!0,y.pts,y.dts,""))).frame=!0;var t=e.data;if(A&&4<t.length){var r=new E(t).readSliceType();2!==r&&4!==r&&7!==r&&9!==r||(M.key=!0)}break;case 5:S=!0,(M=M||(_.avcSample=v(!0,y.pts,y.dts,""))).key=!0,M.frame=!0;break;case 6:S=!0,(b=new E(_.discardEPB(e.data))).readUByte();for(var i=0,n=0,a=!1,s=0;!a&&1<b.bytesAvailable;){for(i=0;i+=s=b.readUByte(),255===s;);for(n=0;n+=s=b.readUByte(),255===s;);if(4===i&&0!==b.bytesAvailable){if(a=!0,181===b.readUByte())if(49===b.readUShort())if(1195456820===b.readUInt())if(3===b.readUByte()){var o=b.readUByte(),l=31&o,u=[o,b.readUByte()];for(T=0;T<l;T++)u.push(b.readUByte()),u.push(b.readUByte()),u.push(b.readUByte());_._insertSampleInOrder(_._txtTrack.samples,{type:3,pts:y.pts,bytes:u})}}else if(5===i&&0!==b.bytesAvailable){if(a=!0,16<n){var c=[];for(T=0;T<16;T++)c.push(b.readUByte().toString(16)),3!==T&&5!==T&&7!==T&&9!==T||c.push("-");var d=n-16,f=new Uint8Array(d);for(T=0;T<d;T++)f[T]=b.readUByte();_._insertSampleInOrder(_._txtTrack.samples,{pts:y.pts,payloadType:i,uuid:c.join(""),userDataBytes:f,userData:Object(w.utf8ArrayToStr)(f.buffer)})}}else if(n<b.bytesAvailable)for(T=0;T<n;T++)b.readUByte()}break;case 7:if(A=S=!0,!I.sps){var h=(b=new E(e.data)).readSPS();I.width=h.width,I.height=h.height,I.pixelRatio=h.pixelRatio,I.sps=[e.data],I.duration=_._duration;var p=e.data.subarray(1,4),g="avc1.";for(T=0;T<3;T++){var m=p[T].toString(16);m.length<2&&(m="0"+m),g+=m}I.codec=g}break;case 8:S=!0,I.pps||(I.pps=[e.data]);break;case 9:S=!1,I.audFound=!0,M&&D(M,I),M=_.avcSample=v(!1,y.pts,y.dts,"");break;case 12:S=!1;break;default:S=!1,M&&(M.debug+="unknown NAL "+e.type+" ")}M&&S&&M.units.push(e)}),e&&M&&(D(M,I),this.avcSample=null)},e._insertSampleInOrder=function(e,t){var r=e.length;if(0<r){if(t.pts>=e[r-1].pts)e.push(t);else for(var i=r-1;0<=i;i--)if(t.pts<e[i].pts){e.splice(i,0,t);break}}else e.push(t)},e._getLastNalUnit=function(){var e,t=this.avcSample;if(!t||0===t.units.length){var r=this._avcTrack.samples;t=r[r.length-1]}if(t){var i=t.units;e=i[i.length-1]}return e},e._parseAVCNALu=function(e){var t,r,i,n,a=0,s=e.byteLength,o=this._avcTrack,l=o.naluState||0,u=l,c=[],d=-1;for(-1===l&&(n=31&e[d=0],l=0,a=1);a<s;)if(t=e[a++],l)if(1!==l)if(t)if(1===t){if(0<=d)i={data:e.subarray(d,a-l-1),type:n},c.push(i);else{var f=this._getLastNalUnit();if(f&&(u&&a<=4-u&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-u)),0<(r=a-l-1))){var h=new Uint8Array(f.data.byteLength+r);h.set(f.data,0),h.set(e.subarray(0,r),f.data.byteLength),f.data=h}}l=a<s?(n=31&e[d=a],0):-1}else l=0;else l=3;else l=t?0:2;else l=t?0:1;if(0<=d&&0<=l&&(i={data:e.subarray(d,s),type:n,state:l},c.push(i)),0===c.length){var p=this._getLastNalUnit();if(p){var g=new Uint8Array(p.data.byteLength+e.byteLength);g.set(p.data,0),g.set(e,p.data.byteLength),p.data=g}}return o.naluState=l,c},e.discardEPB=function(e){for(var t,r,i=e.byteLength,n=[],a=1;a<i-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return e;t=i-n.length,r=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===n[0]&&(s++,n.shift()),r[a]=e[s];return r},e._parseAACPES=function(e){var t,r,i,n,a,s,o,l=this._audioTrack,u=e.data,c=e.pts,d=this.aacOverFlow,f=this.aacLastPTS;if(d){var h=new Uint8Array(d.byteLength+u.byteLength);h.set(d,0),h.set(u,d.byteLength),u=h}for(i=0,a=u.length;i<a-1&&!m(u,i);i++);if(i&&(o=i<a-1?(s="AAC PES did not start with ADTS header,offset:"+i,!1):(s="no ADTS header found in AAC PES",!0),te.logger.warn("parsing error:"+s),this.observer.trigger(q.default.ERROR,{type:ee.ErrorTypes.MEDIA_ERROR,details:ee.ErrorDetails.FRAG_PARSING_ERROR,fatal:o,reason:s}),o))return;if(y(l,this.observer,u,i,this.audioCodec),r=0,t=v(l.samplerate),d&&f){var p=f+t;1<Math.abs(p-c)&&(te.logger.log("AAC: align PTS for overlapping frames by "+Math.round((p-c)/90)),c=p)}for(;i<a;){if(m(u,i)){if(i+5<a){var g=b(l,u,i,c,r);if(g){i+=g.length,n=g.sample.pts,r++;continue}}break}i++}d=i<a?u.subarray(i,a):null,this.aacOverFlow=d,this.aacLastPTS=n},e._parseMPEGPES=function(e){for(var t=e.data,r=t.length,i=0,n=0,a=e.pts;n<r;)if(T.isHeader(t,n)){var s=T.appendFrame(this._audioTrack,t,n,a,i);if(!s)break;n+=s.length,i++}else n++},e._parseID3PES=function(e){this._id3Track.samples.push(e)},O}(),D=function(){function e(e,t,r){this.observer=e,this.config=r,this.remuxer=t}var t=e.prototype;return t.resetInitSegment=function(e,t,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:i,inputTimeScale:9e4}},t.resetTimeStamp=function(){},e.probe=function(e){var t,r,i=w.default.getID3Data(e,0);if(i&&void 0!==w.default.getTimeStamp(i))for(t=i.length,r=Math.min(e.length-1,t+100);t<r;t++)if(T.probe(e,t))return te.logger.log("MPEG Audio sync word found !"),!0;return!1},t.append=function(e,t,r,i){for(var n=w.default.getID3Data(e,0),a=w.default.getTimeStamp(n),s=a?90*a:9e4*t,o=n.length,l=e.length,u=0,c=0,d=this._audioTrack,f=[{pts:s,dts:s,data:n}];o<l;)if(T.isHeader(e,o)){var h=T.appendFrame(d,e,o,s,u);if(!h)break;o+=h.length,c=h.sample.pts,u++}else w.default.isHeader(e,o)?(n=w.default.getID3Data(e,o),f.push({pts:c,dts:c,data:n}),o+=n.length):o++;this.remuxer.remux(d,{samples:[]},{samples:f,inputTimeScale:9e4},{samples:[]},t,r,i)},t.destroy=function(){},e}(),V=function(){function e(){}return e.getSilentFrame=function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),l=Math.pow(2,32)-1,re=function(){function f(){}return f.init=function(){var e;for(e in f.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})f.types.hasOwnProperty(e)&&(f.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);f.HDLR_TYPES={video:t,audio:r};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);f.STTS=f.STSC=f.STCO=n,f.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),f.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),f.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),f.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);f.FTYP=f.box(f.types.ftyp,a,o,a,s),f.DINF=f.box(f.types.dinf,f.box(f.types.dref,i))},f.box=function(e){for(var t,r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n;n--;)i+=r[n].byteLength;for((t=new Uint8Array(i))[0]=i>>24&255,t[1]=i>>16&255,t[2]=i>>8&255,t[3]=255&i,t.set(e,4),n=0,i=8;n<a;n++)t.set(r[n],i),i+=r[n].byteLength;return t},f.hdlr=function(e){return f.box(f.types.hdlr,f.HDLR_TYPES[e])},f.mdat=function(e){return f.box(f.types.mdat,e)},f.mdhd=function(e,t){t*=e;var r=Math.floor(t/(1+l)),i=Math.floor(t%(1+l));return f.box(f.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},f.mdia=function(e){return f.box(f.types.mdia,f.mdhd(e.timescale,e.duration),f.hdlr(e.type),f.minf(e))},f.mfhd=function(e){return f.box(f.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},f.minf=function(e){return"audio"===e.type?f.box(f.types.minf,f.box(f.types.smhd,f.SMHD),f.DINF,f.stbl(e)):f.box(f.types.minf,f.box(f.types.vmhd,f.VMHD),f.DINF,f.stbl(e))},f.moof=function(e,t,r){return f.box(f.types.moof,f.mfhd(e),f.traf(r,t))},f.moov=function(e){for(var t=e.length,r=[];t--;)r[t]=f.trak(e[t]);return f.box.apply(null,[f.types.moov,f.mvhd(e[0].timescale,e[0].duration)].concat(r).concat(f.mvex(e)))},f.mvex=function(e){for(var t=e.length,r=[];t--;)r[t]=f.trex(e[t]);return f.box.apply(null,[f.types.mvex].concat(r))},f.mvhd=function(e,t){t*=e;var r=Math.floor(t/(1+l)),i=Math.floor(t%(1+l)),n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return f.box(f.types.mvhd,n)},f.sdtp=function(e){var t,r,i=e.samples||[],n=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)t=i[r].flags,n[r+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return f.box(f.types.sdtp,n)},f.stbl=function(e){return f.box(f.types.stbl,f.stsd(e),f.box(f.types.stts,f.STTS),f.box(f.types.stsc,f.STSC),f.box(f.types.stsz,f.STSZ),f.box(f.types.stco,f.STCO))},f.avc1=function(e){var t,r,i,n=[],a=[];for(t=0;t<e.sps.length;t++)i=(r=e.sps[t]).byteLength,n.push(i>>>8&255),n.push(255&i),n=n.concat(Array.prototype.slice.call(r));for(t=0;t<e.pps.length;t++)i=(r=e.pps[t]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));var s=f.box(f.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|e.sps.length].concat(n).concat([e.pps.length]).concat(a))),o=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return f.box(f.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,f.box(f.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),f.box(f.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))},f.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},f.mp4a=function(e){var t=e.samplerate;return f.box(f.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),f.box(f.types.esds,f.esds(e)))},f.mp3=function(e){var t=e.samplerate;return f.box(f.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))},f.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?f.box(f.types.stsd,f.STSD,f.mp4a(e)):f.box(f.types.stsd,f.STSD,f.mp3(e)):f.box(f.types.stsd,f.STSD,f.avc1(e))},f.tkhd=function(e){var t=e.id,r=e.duration*e.timescale,i=e.width,n=e.height,a=Math.floor(r/(1+l)),s=Math.floor(r%(1+l));return f.box(f.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,n>>8&255,255&n,0,0]))},f.traf=function(e,t){var r=f.sdtp(e),i=e.id,n=Math.floor(t/(1+l)),a=Math.floor(t%(1+l));return f.box(f.types.traf,f.box(f.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),f.box(f.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a])),f.trun(e,r.length+16+20+8+16+8+8),r)},f.trak=function(e){return e.duration=e.duration||4294967295,f.box(f.types.trak,f.tkhd(e),f.mdia(e))},f.trex=function(e){var t=e.id;return f.box(f.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},f.trun=function(e,t){var r,i,n,a,s,o,l=e.samples||[],u=l.length,c=12+16*u,d=new Uint8Array(c);for(t+=8+c,d.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),r=0;r<u;r++)n=(i=l[r]).duration,a=i.size,s=i.flags,o=i.cts,d.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*r);return f.box(f.types.trun,d)},f.initSegment=function(e){f.types||f.init();var t,r=f.moov(e);return(t=new Uint8Array(f.FTYP.byteLength+r.byteLength)).set(f.FTYP),t.set(r,f.FTYP.byteLength),t},f}();function u(e,t,r,i){void 0===r&&(r=1),void 0===i&&(i=!1);var n=e*t*r;return i?Math.round(n):n}function ie(e,t){return void 0===t&&(t=!1),u(e,1e3,1/9e4,t)}function f(e,t){return void 0===t&&(t=1),u(e,9e4,1/t)}var _,W=f(10),ne=f(.2),C=function(){function e(e,t,r,i){this.observer=e,this.config=t,this.typeSupported=r;var n=navigator.userAgent;this.isSafari=i&&-1<i.indexOf("Apple")&&n&&!n.match("CriOS"),this.ISGenerated=!1}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this._initPTS=this._initDTS=e},t.resetInitSegment=function(){this.ISGenerated=!1},t.remux=function(e,t,r,i,n,a,s){if(this.ISGenerated||this.generateIS(e,t,n),this.ISGenerated){var o=e.samples.length,l=t.samples.length,u=n,c=n;if(o&&l){var d=(e.samples[0].pts-t.samples[0].pts)/t.inputTimeScale;u+=Math.max(0,d),c+=Math.max(0,-d)}if(o){e.timescale||(te.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,n));var f,h=this.remuxAudio(e,u,a,s);if(l)h&&(f=h.endPTS-h.startPTS),t.timescale||(te.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,n)),this.remuxVideo(t,c,a,f,s)}else if(l){var p=this.remuxVideo(t,c,a,0,s);p&&e.codec&&this.remuxEmptyAudio(e,u,a,p)}}r.samples.length&&this.remuxID3(r,n),i.samples.length&&this.remuxText(i,n),this.observer.trigger(q.default.FRAG_PARSED)},t.generateIS=function(e,t,r){var i,n,a=this.observer,s=e.samples,o=t.samples,l=this.typeSupported,u="audio/mp4",c={},d={tracks:c},f=void 0===this._initPTS;if(f&&(i=n=1/0),e.config&&s.length&&(e.timescale=e.samplerate,te.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(l.mpeg?(u="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3")),c.audio={container:u,codec:e.codec,initSegment:!e.isAAC&&l.mpeg?new Uint8Array:re.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(i=n=s[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&o.length){var h=t.inputTimeScale;t.timescale=h,c.video={container:"video/mp4",codec:t.codec,initSegment:re.initSegment([t]),metadata:{width:t.width,height:t.height}},f&&(i=Math.min(i,o[0].pts-h*r),n=Math.min(n,o[0].dts-h*r),this.observer.trigger(q.default.INIT_PTS_FOUND,{initPTS:i}))}Object.keys(c).length?(a.trigger(q.default.FRAG_PARSING_INIT_SEGMENT,d),this.ISGenerated=!0,f&&(this._initPTS=i,this._initDTS=n)):a.trigger(q.default.ERROR,{type:ee.ErrorTypes.MEDIA_ERROR,details:ee.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},t.remuxVideo=function(e,t,r,i,n){var a,s,o,l,u,c,d,f=8,h=e.timescale,p=e.samples,g=[],m=p.length,y=this._PTSNormalize,v=this._initPTS,b=this.nextAvcDts,S=this.isSafari;if(0!==m){S&&(r|=p.length&&b&&(n&&Math.abs(t-b/h)<.1||Math.abs(p[0].pts-b-v)<h/5)),r||(b=t*h),p.forEach(function(e){e.pts=y(e.pts-v,b),e.dts=y(e.dts-v,b)}),p.sort(function(e,t){var r=e.dts-t.dts,i=e.pts-t.pts;return r||i||e.id-t.id});var T=p.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-1*ne)},0);if(T<0){te.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+ie(T,!0)+" ms to overcome this issue");for(var _=0;_<p.length;_++)p[_].dts+=T}var I=p[0];u=Math.max(I.dts,0),l=Math.max(I.pts,0);var M=u-b;r&&M&&(1<M?te.logger.log("AVC: "+ie(M,!0)+" ms hole between fragments detected,filling it"):M<-1&&te.logger.log("AVC: "+ie(-M,!0)+" ms overlapping between fragments detected"),u=b,p[0].dts=u,l=Math.max(l-M,b),p[0].pts=l,te.logger.log("Video: PTS/DTS adjusted: "+ie(l,!0)+"/"+ie(u,!0)+", delta: "+ie(M,!0)+" ms")),I=p[p.length-1],d=Math.max(I.dts,0),c=Math.max(I.pts,0,d),S&&(a=Math.round((d-u)/(p.length-1)));for(var A=0,D=0,w=0;w<m;w++){for(var E=p[w],C=E.units,L=C.length,O=0,N=0;N<L;N++)O+=C[N].data.length;D+=O,A+=L,E.length=O,E.dts=S?u+w*a:Math.max(E.dts,u),E.pts=Math.max(E.pts,E.dts)}var k=D+4*A+8;try{s=new Uint8Array(k)}catch(e){return void this.observer.trigger(q.default.ERROR,{type:ee.ErrorTypes.MUX_ERROR,details:ee.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:k,reason:"fail allocating video mdat "+k})}var x=new DataView(s.buffer);x.setUint32(0,k),s.set(re.types.mdat,4);for(var R=0;R<m;R++){for(var j=p[R],P=j.units,z=0,F=void 0,U=0,B=P.length;U<B;U++){var Y=P[U],G=Y.data,V=Y.data.byteLength;x.setUint32(f,V),f+=4,s.set(G,f),f+=V,z+=4+V}if(S)F=Math.max(0,a*Math.round((j.pts-j.dts)/a));else{if(R<m-1)a=p[R+1].dts-j.dts;else{var W=this.config,H=j.dts-p[0<R?R-1:R].dts;if(W.stretchShortVideoTrack){var $=W.maxBufferHole,Q=Math.floor($*h),K=(i?l+i*h:this.nextAudioPts)-j.pts;Q<K?((a=K-H)<0&&(a=H),te.logger.log("It is approximately "+ie(K,!1)+" ms to the next segment; using duration "+ie(a,!1)+" ms for the last video frame.")):a=H}else a=H}F=Math.round(j.pts-j.dts)}g.push({size:z,duration:a,cts:F,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:j.key?2:1,isNonSync:j.key?0:1}})}this.nextAvcDts=d+a;var Z=e.dropped;if(e.nbNalu=0,e.dropped=0,g.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")){var X=g[0].flags;X.dependsOn=2,X.isNonSync=0}e.samples=g,o=re.moof(e.sequenceNumber++,u,e),e.samples=[];var J={data1:o,data2:s,startPTS:l/h,endPTS:(c+a)/h,startDTS:u/h,endDTS:this.nextAvcDts/h,type:"video",hasAudio:!1,hasVideo:!0,nb:g.length,dropped:Z};return this.observer.trigger(q.default.FRAG_PARSING_DATA,J),J}},t.remuxAudio=function(e,t,r,i){var n,a,s,o,l,u,c=e.inputTimeScale,d=e.timescale,f=c/d,h=(e.isAAC?1024:1152)*f,p=this._PTSNormalize,g=this._initPTS,m=!e.isAAC&&this.typeSupported.mpeg,y=m?0:8,v=e.samples,b=[],S=this.nextAudioPts;if(r|=v.length&&S&&(i&&Math.abs(t-S/c)<.1||Math.abs(v[0].pts-S-g)<20*h),v.forEach(function(e){e.pts=e.dts=p(e.pts-g,t*c)}),0!==(v=v.filter(function(e){return 0<=e.pts})).length){if(r||(S=i?t*c:v[0].pts),e.isAAC)for(var T=this.config.maxAudioFramesDrift,_=0,I=S;_<v.length;){var M,A=v[_];if((M=A.pts-I)<=-T*h)te.logger.warn("Dropping 1 audio frame @ "+ie(I,!0)+" ms due to "+ie(M,!0)+" ms overlap."),v.splice(_,1);else if(T*h<=M&&M<W&&I){var D=Math.round(M/h);te.logger.warn("Injecting "+D+" audio frames @ "+ie(I,!0)+" ms due to "+ie(M,!0)+" ms gap.");for(var w=0;w<D;w++){var E=Math.max(I,0);(a=V.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(te.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),a=A.unit.subarray()),v.splice(_,0,{unit:a,pts:E,dts:E}),I+=h,_++}A.pts=A.dts=I,I+=h,_++}else A.pts=A.dts=I,I+=h,_++}for(var C=v.length,L=0;C--;)L+=v[C].unit.byteLength;for(var O=0,N=v.length;O<N;O++){var k=v[O],x=k.unit,R=k.pts;if(void 0!==u)n.duration=Math.round((R-u)/f);else{var j=R-S,P=0;if(r&&e.isAAC&&j){if(0<j&&j<W)P=Math.round((R-S)/h),te.logger.log(ie(j,!0)+" ms hole between AAC samples detected,filling it"),0<P&&(L+=P*(a=(a=V.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||x.subarray()).length);else if(j<-12){te.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+ie(S,!0)+" ms / "+ie(R,!0)+" ms / "+ie(-j,!0)+" ms"),L-=x.byteLength;continue}R=S}if(l=R,!(0<L))return;L+=y;try{s=new Uint8Array(L)}catch(e){return void this.observer.trigger(q.default.ERROR,{type:ee.ErrorTypes.MUX_ERROR,details:ee.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:L,reason:"fail allocating audio mdat "+L})}m||(new DataView(s.buffer).setUint32(0,L),s.set(re.types.mdat,4));for(var z=0;z<P;z++)(a=V.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(te.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),a=x.subarray()),s.set(a,y),y+=a.byteLength,n={size:a.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(n)}s.set(x,y);var F=x.byteLength;y+=F,n={size:F,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},b.push(n),u=R}var U=0;if(2<=(C=b.length)&&(U=b[C-2].duration,n.duration=U),C){this.nextAudioPts=S=u+f*U,e.samples=b,o=m?new Uint8Array:re.moof(e.sequenceNumber++,l/f,e),e.samples=[];var B=l/c,Y=S/c,G={data1:o,data2:s,startPTS:B,endPTS:Y,startDTS:B,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:C};return this.observer.trigger(q.default.FRAG_PARSING_DATA,G),G}return null}},t.remuxEmptyAudio=function(e,t,r,i){var n=e.inputTimeScale,a=n/(e.samplerate?e.samplerate:n),s=this.nextAudioPts,o=(void 0!==s?s:i.startDTS*n)+this._initDTS,l=i.endDTS*n+this._initDTS,u=1024*a,c=Math.ceil((l-o)/u),d=V.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(te.logger.warn("remux empty Audio"),d){for(var f=[],h=0;h<c;h++){var p=o+h*u;f.push({unit:d,pts:p,dts:p})}e.samples=f,this.remuxAudio(e,t,r)}else te.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},t.remuxID3=function(e){var t=e.samples.length;if(t){for(var r=e.inputTimeScale,i=this._initPTS,n=this._initDTS,a=0;a<t;a++){var s=e.samples[a];s.pts=(s.pts-i)/r,s.dts=(s.dts-n)/r}this.observer.trigger(q.default.FRAG_PARSING_METADATA,{samples:e.samples}),e.samples=[]}},t.remuxText=function(e){e.samples.sort(function(e,t){return e.pts-t.pts});var t,r=e.samples.length,i=e.inputTimeScale,n=this._initPTS;if(r){for(var a=0;a<r;a++)(t=e.samples[a]).pts=(t.pts-n)/i;this.observer.trigger(q.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[]},t._PTSNormalize=function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;4294967296<Math.abs(e-t);)e+=r;return e},e}(),L=function(){function e(e){this.observer=e}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(){},t.resetInitSegment=function(){},t.remux=function(e,t,r,i,n,a,s,o){var l=this.observer,u="";e&&(u+="audio"),t&&(u+="video"),l.trigger(q.default.FRAG_PARSING_DATA,{data1:o,startPTS:n,startDTS:n,type:u,hasAudio:!!e,hasVideo:!!t,nb:1,dropped:0}),l.trigger(q.default.FRAG_PARSED)},e}(),h=Object(i.getSelfScope)();try{_=h.performance.now.bind(h.performance)}catch(e){te.logger.debug("Unable to use Performance API on this environment"),_=h.Date.now}var O=function(){function e(e,t,r,i){this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i}var t=e.prototype;return t.destroy=function(){var e=this.demuxer;e&&e.destroy()},t.push=function(e,r,i,n,a,s,o,l,u,c,d,f){var h=this;if(0<e.byteLength&&null!=r&&null!=r.key&&"AES-128"===r.method){var t=this.decrypter;null==t&&(t=this.decrypter=new g.default(this.observer,this.config));var p=_();t.decrypt(e,r.key.buffer,r.iv.buffer,function(e){var t=_();h.observer.trigger(q.default.FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:t}}),h.pushDecrypted(new Uint8Array(e),r,new Uint8Array(i),n,a,s,o,l,u,c,d,f)})}else this.pushDecrypted(new Uint8Array(e),r,new Uint8Array(i),n,a,s,o,l,u,c,d,f)},t.pushDecrypted=function(e,t,r,i,n,a,s,o,l,u,c,d){var f=this.demuxer;if(!f||(s||o)&&!this.probe(e)){for(var h=this.observer,p=this.typeSupported,g=this.config,m=[{demux:A,remux:C},{demux:M.default,remux:L},{demux:I,remux:C},{demux:D,remux:C}],y=0,v=m.length;y<v;y++){var b=m[y],S=b.demux.probe;if(S(e)){var T=this.remuxer=new b.remux(h,g,p,this.vendor);f=new b.demux(h,T,g,p),this.probe=S;break}}if(!f)return void h.trigger(q.default.ERROR,{type:ee.ErrorTypes.MEDIA_ERROR,details:ee.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=f}var _=this.remuxer;(s||o)&&(f.resetInitSegment(r,i,n,u),_.resetInitSegment()),s&&(f.resetTimeStamp(d),_.resetTimeStamp(d)),"function"==typeof f.setDecryptData&&f.setDecryptData(t),f.append(e,a,l,c)},e}();t.default=O},"./src/demux/demuxer-worker.js":function(e,t,r){r.r(t);var s=r("./src/demux/demuxer-inline.js"),o=r("./src/events.js"),l=r("./src/utils/logger.js"),u=r("./node_modules/eventemitter3/index.js");t.default=function(n){var a=new u.EventEmitter;a.trigger=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];a.emit.apply(a,[e,e].concat(r))},a.off=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];a.removeListener.apply(a,[e].concat(r))};function i(e,t){n.postMessage({event:e,data:t})}n.addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"init":var r=JSON.parse(t.config);n.demuxer=new s.default(a,t.typeSupported,r,t.vendor),Object(l.enableLogs)(r.debug),i("init",null);break;case"demux":n.demuxer.push(t.data,t.decryptdata,t.initSegment,t.audioCodec,t.videoCodec,t.timeOffset,t.discontinuity,t.trackSwitch,t.contiguous,t.duration,t.accurateTimeOffset,t.defaultInitPTS)}}),a.on(o.default.FRAG_DECRYPTED,i),a.on(o.default.FRAG_PARSING_INIT_SEGMENT,i),a.on(o.default.FRAG_PARSED,i),a.on(o.default.ERROR,i),a.on(o.default.FRAG_PARSING_METADATA,i),a.on(o.default.FRAG_PARSING_USERDATA,i),a.on(o.default.INIT_PTS_FOUND,i),a.on(o.default.FRAG_PARSING_DATA,function(e,t){var r=[],i={event:e,data:t};t.data1&&(i.data1=t.data1.buffer,r.push(t.data1.buffer),delete t.data1),t.data2&&(i.data2=t.data2.buffer,r.push(t.data2.buffer),delete t.data2),n.postMessage(i,r)})}},"./src/demux/id3.js":function(e,t,r){r.r(t),r.d(t,"utf8ArrayToStr",function(){return n});var d,f=r("./src/utils/get-self-scope.js"),i=function(){function o(){}return o.isHeader=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o.isFooter=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},o.getID3Data=function(e,t){for(var r=t,i=0;o.isHeader(e,t);){i+=10,i+=o._readSize(e,t+6),o.isFooter(e,t+10)&&(i+=10),t+=i}if(0<i)return e.subarray(r,r+i)},o._readSize=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},o.getTimeStamp=function(e){for(var t=o.getID3Frames(e),r=0;r<t.length;r++){var i=t[r];if(o.isTimeStampFrame(i))return o._readTimeStamp(i)}},o.isTimeStampFrame=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},o._getFrameData=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=o._readSize(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}},o.getID3Frames=function(e){for(var t=0,r=[];o.isHeader(e,t);){for(var i=o._readSize(e,t+6),n=(t+=10)+i;t+8<n;){var a=o._getFrameData(e.subarray(t)),s=o._decodeFrame(a);s&&r.push(s),t+=a.size+10}o.isFooter(e,t)&&(t+=10)}return r},o._decodeFrame=function(e){return"PRIV"===e.type?o._decodePrivFrame(e):"T"===e.type[0]?o._decodeTextFrame(e):"W"===e.type[0]?o._decodeURLFrame(e):void 0},o._readTimeStamp=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},o._decodePrivFrame=function(e){if(!(e.size<2)){var t=o._utf8ArrayToStr(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}},o._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=o._utf8ArrayToStr(e.data.subarray(t),!0);t+=r.length+1;var i=o._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:r,data:i}}var n=o._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:n}}},o._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=o._utf8ArrayToStr(e.data.subarray(t));t+=r.length+1;var i=o._utf8ArrayToStr(e.data.subarray(t));return{key:e.type,info:r,data:i}}var n=o._utf8ArrayToStr(e.data);return{key:e.type,data:n}},o._utf8ArrayToStr=function(e,t){void 0===t&&(t=!1);var r=function(){var e=Object(f.getSelfScope)();d||void 0===e.TextDecoder||(d=new e.TextDecoder("utf-8"));return d}();if(r){var i=r.decode(e);if(t){var n=i.indexOf("\0");return-1!==n?i.substring(0,n):i}return i.replace(/\0/g,"")}for(var a,s,o,l=e.length,u="",c=0;c<l;){if(0===(a=e[c++])&&t)return u;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(a);break;case 12:case 13:s=e[c++],u+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=e[c++],o=e[c++],u+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&o)<<0)}}return u},o}();var n=i._utf8ArrayToStr;t.default=i},"./src/demux/mp4demuxer.js":function(e,t,r){r.r(t);var f=r("./src/utils/logger.js"),l=r("./src/events.js"),o=Math.pow(2,32)-1,i=function(){function g(e,t){this.observer=e,this.remuxer=t}var e=g.prototype;return e.resetTimeStamp=function(e){this.initPTS=e},e.resetInitSegment=function(e,t,r,i){if(e&&e.byteLength){var n=this.initData=g.parseInitSegment(e);null==t&&(t="mp4a.40.5"),null==r&&(r="avc1.42e01e");var a={};n.audio&&n.video?a.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:i?e:null}:(n.audio&&(a.audio={container:"audio/mp4",codec:t,initSegment:i?e:null}),n.video&&(a.video={container:"video/mp4",codec:r,initSegment:i?e:null})),this.observer.trigger(l.default.FRAG_PARSING_INIT_SEGMENT,{tracks:a})}else t&&(this.audioCodec=t),r&&(this.videoCodec=r)},g.probe=function(e){return 0<g.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length},g.bin2str=function(e){return String.fromCharCode.apply(null,e)},g.readUint16=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<8|e[t+1];return r<0?65536+r:r},g.readUint32=function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r},g.writeUint32=function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r},g.findBox=function(e,t){var r,i,n,a,s,o,l=[];if(e.data?(s=e.start,n=e.end,e=e.data):(s=0,n=e.byteLength),!t.length)return null;for(r=s;r<n;)o=1<(i=g.readUint32(e,r))?r+i:n,g.bin2str(e.subarray(r+4,r+8))===t[0]&&(1===t.length?l.push({data:e,start:r+8,end:o}):(a=g.findBox({data:e,start:r+8,end:o},t.slice(1))).length&&(l=l.concat(a))),r=o;return l},g.parseSegmentIndex=function(e){var t,r=g.findBox(e,["moov"])[0],i=r?r.end:null,n=0,a=g.findBox(e,["sidx"]);if(!a||!a[0])return null;t=[];var s=(a=a[0]).data[0],o=g.readUint32(a,n=0===s?8:16);n+=4;n+=0===s?8:16,n+=2;var l=a.end+0,u=g.readUint16(a,n);n+=2;for(var c=0;c<u;c++){var d=n,f=g.readUint32(a,d);d+=4;var h=2147483647&f;if(1==(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var p=g.readUint32(a,d);d+=4,t.push({referenceSize:h,subsegmentDuration:p,info:{duration:p/o,start:l,end:l+h-1}}),l+=h,n=d+=4}return{earliestPresentationTime:0,timescale:o,version:s,referencesCount:u,references:t,moovEndOffset:i}},g.parseInitSegment=function(e){var d=[];return g.findBox(e,["moov","trak"]).forEach(function(e){var t=g.findBox(e,["tkhd"])[0];if(t){var r=t.data[t.start],i=0===r?12:20,n=g.readUint32(t,i),a=g.findBox(e,["mdia","mdhd"])[0];if(a){r=a.data[a.start];var s=g.readUint32(a,i=0===r?12:20),o=g.findBox(e,["mdia","hdlr"])[0];if(o){var l={soun:"audio",vide:"video"}[g.bin2str(o.data.subarray(o.start+8,o.start+12))];if(l){var u=g.findBox(e,["mdia","minf","stbl","stsd"]);if(u.length){u=u[0];var c=g.bin2str(u.data.subarray(u.start+12,u.start+16));f.logger.log("MP4Demuxer:"+l+":"+c+" found")}d[n]={timescale:s,type:l},d[l]={timescale:s,id:n}}}}}}),d},g.getStartDTS=function(n,e){var t,r,i;return t=g.findBox(e,["moof","traf"]),r=[].concat.apply([],t.map(function(i){return g.findBox(i,["tfhd"]).map(function(e){var t,r;return t=g.readUint32(e,4),r=n[t].timescale||9e4,g.findBox(i,["tfdt"]).map(function(e){var t,r;return t=e.data[e.start],r=g.readUint32(e,4),1===t&&(r*=Math.pow(2,32),r+=g.readUint32(e,8)),r})[0]/r})})),i=Math.min.apply(null,r),isFinite(i)?i:0},g.offsetStartDTS=function(i,e,s){g.findBox(e,["moof","traf"]).map(function(r){return g.findBox(r,["tfhd"]).map(function(e){var t=g.readUint32(e,4),a=i[t].timescale||9e4;g.findBox(r,["tfdt"]).map(function(e){var t=e.data[e.start],r=g.readUint32(e,4);if(0===t)g.writeUint32(e,4,r-s*a);else{r*=Math.pow(2,32),r+=g.readUint32(e,8),r-=s*a,r=Math.max(r,0);var i=Math.floor(r/(1+o)),n=Math.floor(r%(1+o));g.writeUint32(e,4,i),g.writeUint32(e,8,n)}})})})},e.append=function(e,t,r,i){var n=this.initData;n||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),n=this.initData);var a,s=this.initPTS;if(void 0===s){var o=g.getStartDTS(n,e);this.initPTS=s=o-t,this.observer.trigger(l.default.INIT_PTS_FOUND,{initPTS:s})}g.offsetStartDTS(n,e,s),a=g.getStartDTS(n,e),this.remuxer.remux(n.audio,n.video,null,null,a,r,i,e)},e.destroy=function(){},g}();t.default=i},"./src/errors.ts":function(e,t,r){var i,n,a,s;r.r(t),r.d(t,"ErrorTypes",function(){return i}),r.d(t,"ErrorDetails",function(){return a}),(n=i=i||{}).NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",(s=a=a||{}).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",s.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",s.KEY_SYSTEM_NO_SESSION="keySystemNoSession",s.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",s.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",s.MANIFEST_LOAD_ERROR="manifestLoadError",s.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",s.MANIFEST_PARSING_ERROR="manifestParsingError",s.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",s.LEVEL_EMPTY_ERROR="levelEmptyError",s.LEVEL_LOAD_ERROR="levelLoadError",s.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",s.LEVEL_SWITCH_ERROR="levelSwitchError",s.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",s.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",s.FRAG_LOAD_ERROR="fragLoadError",s.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",s.FRAG_DECRYPT_ERROR="fragDecryptError",s.FRAG_PARSING_ERROR="fragParsingError",s.REMUX_ALLOC_ERROR="remuxAllocError",s.KEY_LOAD_ERROR="keyLoadError",s.KEY_LOAD_TIMEOUT="keyLoadTimeOut",s.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",s.BUFFER_APPEND_ERROR="bufferAppendError",s.BUFFER_APPENDING_ERROR="bufferAppendingError",s.BUFFER_STALLED_ERROR="bufferStalledError",s.BUFFER_FULL_ERROR="bufferFullError",s.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",s.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",s.INTERNAL_EXCEPTION="internalException"},"./src/events.js":function(e,t,r){r.r(t);t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":function(e,t,r){r.r(t),r.d(t,"default",function(){return dr});var i={};r.r(i),r.d(i,"newCue",function(){return gt});var m,n,l,a,s=r("./node_modules/url-toolkit/src/url-toolkit.js"),y=r("./src/errors.ts"),j=r("./src/polyfills/number-isFinite.js"),P=r("./src/events.js"),z=r("./src/utils/logger.js"),o={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},u=function(){function e(e){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=e,this.onEvent=this.onEvent.bind(this);for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){},t.onHandlerDestroyed=function(){},t.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},t.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if(o[e])throw new Error("Forbidden event-name: "+e);this.hls.on(e,this.onEvent)},this)},t.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)},t.onEvent=function(e,t){this.onEventGeneric(e,t)},t.onEventGeneric=function(t,e){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,t,e).call()}catch(e){z.logger.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.OTHER_ERROR,details:y.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},e}();(n=m=m||{}).MANIFEST="manifest",n.LEVEL="level",n.AUDIO_TRACK="audioTrack",n.SUBTITLE_TRACK="subtitleTrack",(a=l=l||{}).MAIN="main",a.AUDIO="audio",a.SUBTITLE="subtitle";var c=r("./src/demux/mp4demuxer.js");function d(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var f,h,w=function(){function e(e,t){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=e,this.reluri=t}var t,r,i;return t=e,(r=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(s.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&d(t.prototype,r),i&&d(t,i),e}();function p(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(h=f=f||{}).AUDIO="audio",h.VIDEO="video";var E=function(){function e(){var e;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((e={})[f.AUDIO]=!1,e[f.VIDEO]=!1,e),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var t,r,i,n=e.prototype;return n.setByteRange=function(e,t){var r=e.split("@",2),i=[];1===r.length?i[0]=t?t.byteRangeEndOffset:0:i[0]=parseInt(r[1]),i[1]=parseInt(r[0])+i[0],this._byteRange=i},n.addElementaryStream=function(e){this._elementaryStreams[e]=!0},n.hasElementaryStream=function(e){return!0===this._elementaryStreams[e]},n.createInitializationVector=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t},n.setDecryptDataFromLevelKey=function(e,t){var r=e;return null!=e&&e.method&&e.uri&&!e.iv&&((r=new w(e.baseuri,e.reluri)).method=e.method,r.iv=this.createInitializationVector(t)),r},t=e,(r=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(s.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var e=this.sn;"number"!=typeof e&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&z.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),e=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,e)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(j.isFiniteNumber)(this.programDateTime))return null;var e=Object(j.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&p(t.prototype,r),i&&p(t,i),e}();function g(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var C=function(){function e(e){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=e,this.version=null}var t,r,i;return t=e,(r=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(j.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&g(t.prototype,r),i&&g(t,i),e}(),v=/^(\d+)x(\d+)$/,b=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,L=function(){function r(e){for(var t in"string"==typeof e&&(e=r.parseAttrList(e)),e)e.hasOwnProperty(t)&&(this[t]=e[t])}var e=r.prototype;return e.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},e.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},e.decimalFloatingPoint=function(e){return parseFloat(this[e])},e.enumeratedString=function(e){return this[e]},e.decimalResolution=function(e){var t=v.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},r.parseAttrList=function(e){var t,r={};for(b.lastIndex=0;null!==(t=b.exec(e));){var i=t[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[t[1]]=i}return r},r}(),S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function T(e,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"')}var _=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,I=/#EXT-X-MEDIA:(.*)/g,O=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),N=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,k=/\.(mp4|m4s|m4v|m4a)$/i,M=function(){function d(){}return d.findGroup=function(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(i.id===t)return i}},d.convertAVC1ToAVCOTI=function(e){var t,r=e.split(".");return 2<r.length?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t},d.resolve=function(e,t){return s.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},d.parseMasterPlaylist=function(e,t){var r,i=[],n={},a=!1;function s(r,n){["video","audio"].forEach(function(i){var t=r.filter(function(e){return t=e,!!(r=S[i])&&!0===r[t.slice(0,4)];var t,r});if(t.length){var e=t.filter(function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)});n[i+"Codec"]=0<e.length?e[0]:t[0],r=r.filter(function(e){return-1===t.indexOf(e)})}}),n.unknownCodecs=r}for(_.lastIndex=0;null!=(r=_.exec(e));)if(r[1]){var o={},l=o.attrs=new L(r[1]);o.url=d.resolve(r[2],t);var u=l.decimalResolution("RESOLUTION");u&&(o.width=u.width,o.height=u.height),o.bitrate=l.decimalInteger("AVERAGE-BANDWIDTH")||l.decimalInteger("BANDWIDTH"),o.name=l.NAME,s([].concat((l.CODECS||"").split(/[ ,]+/)),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=d.convertAVC1ToAVCOTI(o.videoCodec)),i.push(o)}else if(r[3]){var c=new L(r[3]);c["DATA-ID"]&&(a=!0,n[c["DATA-ID"]]=c)}return{levels:i,sessionData:a?n:null}},d.parseMasterPlaylistMedia=function(e,t,r,i){var n;void 0===i&&(i=[]);var a=[],s=0;for(I.lastIndex=0;null!==(n=I.exec(e));){var o=new L(n[1]);if(o.TYPE===r){var l={attrs:o,id:s++,groupId:o["GROUP-ID"],instreamId:o["INSTREAM-ID"],name:o.NAME||o.LANGUAGE,type:r,default:"YES"===o.DEFAULT,autoselect:"YES"===o.AUTOSELECT,forced:"YES"===o.FORCED,lang:o.LANGUAGE};if(o.URI&&(l.url=d.resolve(o.URI,t)),i.length){var u=d.findGroup(i,l.groupId);l.audioCodec=u?u.codec:i[0].codec}a.push(l)}}return a},d.parseLevelPlaylist=function(e,t,r,i,n){var a,s,o,l=0,u=0,c=new C(t),d=0,f=null,h=new E,p=null;for(O.lastIndex=0;null!==(a=O.exec(e));){var g=a[1];if(g){h.duration=parseFloat(g);var m=(" "+a[2]).slice(1);h.title=m||null,h.tagList.push(m?["INF",g,m]:["INF",g])}else if(a[3]){if(Object(j.isFiniteNumber)(h.duration)){var y=l++;h.type=i,h.start=u,o&&(h.levelkey=o),h.sn=y,h.level=r,h.cc=d,h.urlId=n,h.baseurl=t,h.relurl=(" "+a[3]).slice(1),x(h,f),c.fragments.push(h),u+=(f=h).duration,h=new E}}else if(a[4]){var v=(" "+a[4]).slice(1);f?h.setByteRange(v,f):h.setByteRange(v)}else if(a[5])h.rawProgramDateTime=(" "+a[5]).slice(1),h.tagList.push(["PROGRAM-DATE-TIME",h.rawProgramDateTime]),null===p&&(p=c.fragments.length);else{if(!(a=a[0].match(N))){z.logger.warn("No matches on slow regex match for level playlist!");continue}for(s=1;s<a.length&&void 0===a[s];s++);var b=(" "+a[s+1]).slice(1),S=(" "+a[s+2]).slice(1);switch(a[s]){case"#":h.tagList.push(S?[b,S]:[b]);break;case"PLAYLIST-TYPE":c.type=b.toUpperCase();break;case"MEDIA-SEQUENCE":l=c.startSN=parseInt(b);break;case"TARGETDURATION":c.targetduration=parseFloat(b);break;case"VERSION":c.version=parseInt(b);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"DIS":d++,h.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":d=parseInt(b);break;case"KEY":var T=new L(b),_=T.enumeratedString("METHOD"),I=T.URI,M=T.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(T.KEYFORMAT||"identity")){z.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}_&&(o=new w(t,I),I&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(_)&&(o.method=_,o.key=null,o.iv=M));break;case"START":var A=new L(b).decimalFloatingPoint("TIME-OFFSET");Object(j.isFiniteNumber)(A)&&(c.startTimeOffset=A);break;case"MAP":var D=new L(b);h.relurl=D.URI,D.BYTERANGE&&h.setByteRange(D.BYTERANGE),h.baseurl=t,h.level=r,h.type=i,h.sn="initSegment",c.initSegment=h,(h=new E).rawProgramDateTime=c.initSegment.rawProgramDateTime;break;default:z.logger.warn("line parsed but not handled: "+a)}}}return(h=f)&&!h.relurl&&(c.fragments.pop(),u-=h.duration),c.totalduration=u,c.averagetargetduration=u/c.fragments.length,c.endSN=l-1,c.startCC=c.fragments[0]?c.fragments[0].cc:0,c.endCC=d,!c.initSegment&&c.fragments.length&&c.fragments.every(function(e){return k.test(e.relurl)})&&(z.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(h=new E).relurl=c.fragments[0].relurl,h.baseurl=t,h.level=r,h.type=i,h.sn="initSegment",c.initSegment=h,c.needSidxRanges=!0),p&&function(e,t){for(var r=e[t],i=t-1;0<=i;i--){var n=e[i];n.programDateTime=r.programDateTime-1e3*n.duration,r=n}}(c.fragments,p),c},d}();function x(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Object(j.isFiniteNumber)(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}var A=window.performance,D=function(r){var e,t;function g(e){var t;return(t=r.call(this,e,P.default.MANIFEST_LOADING,P.default.LEVEL_LOADING,P.default.AUDIO_TRACK_LOADING,P.default.SUBTITLE_TRACK_LOADING)||this).loaders={},t}t=r,(e=g).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,g.canHaveQualityLevels=function(e){return e!==m.AUDIO_TRACK&&e!==m.SUBTITLE_TRACK},g.mapContextToLevelType=function(e){switch(e.type){case m.AUDIO_TRACK:return l.AUDIO;case m.SUBTITLE_TRACK:return l.SUBTITLE;default:return l.MAIN}},g.getResponseUrl=function(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r};var i=g.prototype;return i.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,i=t.loader,n=new(r||i)(t);return e.loader=n,this.loaders[e.type]=n},i.getInternalLoader=function(e){return this.loaders[e.type]},i.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},i.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},i.destroy=function(){this.destroyInternalLoaders(),r.prototype.destroy.call(this)},i.onManifestLoading=function(e){this.load({url:e.url,type:m.MANIFEST,level:0,id:null,responseType:"text"})},i.onLevelLoading=function(e){this.load({url:e.url,type:m.LEVEL,level:e.level,id:e.id,responseType:"text"})},i.onAudioTrackLoading=function(e){this.load({url:e.url,type:m.AUDIO_TRACK,level:null,id:e.id,responseType:"text"})},i.onSubtitleTrackLoading=function(e){this.load({url:e.url,type:m.SUBTITLE_TRACK,level:null,id:e.id,responseType:"text"})},i.load=function(e){var t=this.hls.config;z.logger.debug("Loading playlist of type "+e.type+", level: "+e.level+", id: "+e.id);var r,i,n,a,s=this.getInternalLoader(e);if(s){var o=s.context;if(o&&o.url===e.url)return z.logger.trace("playlist request ongoing"),!1;z.logger.warn("aborting previous loader for type: "+e.type),s.abort()}switch(e.type){case m.MANIFEST:r=t.manifestLoadingMaxRetry,i=t.manifestLoadingTimeOut,n=t.manifestLoadingRetryDelay,a=t.manifestLoadingMaxRetryTimeout;break;case m.LEVEL:n=a=r=0,i=t.levelLoadingTimeOut;break;default:r=t.levelLoadingMaxRetry,i=t.levelLoadingTimeOut,n=t.levelLoadingRetryDelay,a=t.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(e);var l={timeout:i,maxRetry:r,retryDelay:n,maxRetryDelay:a},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return z.logger.debug("Calling internal loader delegate for URL: "+e.url),s.load(e,l,u),!0},i.loadsuccess=function(e,t,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(e,r),void this._handlePlaylistLoaded(e,t,r,i);if(this.resetInternalLoader(r.type),"string"!=typeof e.data)throw new Error('expected responseType of "text" for PlaylistLoader');var n=e.data;t.tload=A.now(),0===n.indexOf("#EXTM3U")?0<n.indexOf("#EXTINF:")||0<n.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(e,t,r,i):this._handleMasterPlaylist(e,t,r,i):this._handleManifestParsingError(e,r,"no EXTM3U delimiter",i)},i.loaderror=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!1,e)},i.loadtimeout=function(e,t,r){void 0===r&&(r=null),this._handleNetworkError(t,r,!0)},i._handleMasterPlaylist=function(e,t,r,i){var n=this.hls,a=e.data,s=g.getResponseUrl(e,r),o=M.parseMasterPlaylist(a,s),l=o.levels,u=o.sessionData;if(l.length){var c=l.map(function(e){return{id:e.attrs.AUDIO,codec:e.audioCodec}}),d=M.parseMasterPlaylistMedia(a,s,"AUDIO",c),f=M.parseMasterPlaylistMedia(a,s,"SUBTITLES"),h=M.parseMasterPlaylistMedia(a,s,"CLOSED-CAPTIONS");if(d.length){var p=!1;d.forEach(function(e){e.url||(p=!0)}),!1===p&&l[0].audioCodec&&!l[0].attrs.AUDIO&&(z.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),d.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}n.trigger(P.default.MANIFEST_LOADED,{levels:l,audioTracks:d,subtitles:f,captions:h,url:s,stats:t,networkDetails:i,sessionData:u})}else this._handleManifestParsingError(e,r,"no level found in manifest",i)},i._handleTrackOrLevelPlaylist=function(e,t,r,i){var n=this.hls,a=r.id,s=r.level,o=r.type,l=g.getResponseUrl(e,r),u=Object(j.isFiniteNumber)(a)?a:0,c=Object(j.isFiniteNumber)(s)?s:u,d=g.mapContextToLevelType(r),f=M.parseLevelPlaylist(e.data,l,c,d,u);if(f.tload=t.tload,f.fragments.length){if(o===m.MANIFEST){var h={url:l,details:f};n.trigger(P.default.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:l,stats:t,networkDetails:i,sessionData:null})}if(t.tparsed=A.now(),f.needSidxRanges){var p=f.initSegment.url;this.load({url:p,isSidxRequest:!0,type:o,level:s,levelDetails:f,id:a,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=f,this._handlePlaylistLoaded(e,t,r,i)}else n.trigger(P.default.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:l,reason:"no fragments found in level",level:"number"==typeof r.level?r.level:void 0})},i._handleSidxRequest=function(e,t){if("string"==typeof e.data)throw new Error("sidx request must be made with responseType of array buffer");var r=c.default.parseSegmentIndex(new Uint8Array(e.data));if(r){var i=r.references,n=t.levelDetails;i.forEach(function(e,t){var r=e.info;if(n){var i=n.fragments[t];0===i.byteRange.length&&i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}}),n&&n.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},i._handleManifestParsingError=function(e,t,r,i){this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:e.url,reason:r,networkDetails:i})},i._handleNetworkError=function(e,t,r,i){var n,a;void 0===r&&(r=!1),void 0===i&&(i=null),z.logger.info("A network error occured while loading a "+e.type+"-type playlist");var s=this.getInternalLoader(e);switch(e.type){case m.MANIFEST:n=r?y.ErrorDetails.MANIFEST_LOAD_TIMEOUT:y.ErrorDetails.MANIFEST_LOAD_ERROR,a=!0;break;case m.LEVEL:n=r?y.ErrorDetails.LEVEL_LOAD_TIMEOUT:y.ErrorDetails.LEVEL_LOAD_ERROR,a=!1;break;case m.AUDIO_TRACK:n=r?y.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,a=!1;break;default:a=!1}s&&(s.abort(),this.resetInternalLoader(e.type));var o={type:y.ErrorTypes.NETWORK_ERROR,details:n,fatal:a,url:e.url,loader:s,context:e,networkDetails:t};i&&(o.response=i),this.hls.trigger(P.default.ERROR,o)},i._handlePlaylistLoaded=function(e,t,r,i){var n=r.type,a=r.level,s=r.id,o=r.levelDetails;if(o&&o.targetduration)if(g.canHaveQualityLevels(r.type))this.hls.trigger(P.default.LEVEL_LOADED,{details:o,level:a||0,id:s||0,stats:t,networkDetails:i});else switch(n){case m.AUDIO_TRACK:this.hls.trigger(P.default.AUDIO_TRACK_LOADED,{details:o,id:s,stats:t,networkDetails:i});break;case m.SUBTITLE_TRACK:this.hls.trigger(P.default.SUBTITLE_TRACK_LOADED,{details:o,id:s,stats:t,networkDetails:i})}else this._handleManifestParsingError(e,r,"invalid target duration",i)},g}(u);var R=function(i){var e,t;function r(e){var t;return(t=i.call(this,e,P.default.FRAG_LOADING)||this).loaders={},t}t=i,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n=r.prototype;return n.destroy=function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},i.prototype.destroy.call(this)},n.onFragLoading=function(e){var t=e.frag,r=t.type,i=this.loaders,n=this.hls.config,a=n.fLoader,s=n.loader;t.loaded=0;var o,l,u,c=i[r];c&&(z.logger.warn("abort previous fragment loader for type: "+r),c.abort()),c=i[r]=t.loader=new(n.fLoader?a:s)(n),o={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var d=t.byteRangeStartOffset,f=t.byteRangeEndOffset;Object(j.isFiniteNumber)(d)&&Object(j.isFiniteNumber)(f)&&(o.rangeStart=d,o.rangeEnd=f),l={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},u={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},c.load(o,l,u)},n.loadsuccess=function(e,t,r,i){void 0===i&&(i=null);var n=e.data,a=r.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(P.default.FRAG_LOADED,{payload:n,frag:a,stats:t,networkDetails:i})},n.loaderror=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})},n.loadtimeout=function(e,t,r){void 0===r&&(r=null);var i=t.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})},n.loadprogress=function(e,t,r,i){void 0===i&&(i=null);var n=t.frag;n.loaded=e.loaded,this.hls.trigger(P.default.FRAG_LOAD_PROGRESS,{frag:n,stats:e,networkDetails:i})},r}(u);var F=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.KEY_LOADING)||this).loaders={},t.decryptkey=null,t.decrypturl=null,t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n=i.prototype;return n.destroy=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},r.prototype.destroy.call(this)},n.onKeyLoading=function(e){var t=e.frag,r=t.type,i=this.loaders[r];if(t.decryptdata){var n=t.decryptdata.uri;if(n!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(i&&(z.logger.warn("abort previous key loader for type:"+r),i.abort()),!n)return void z.logger.warn("key uri is falsy");t.loader=this.loaders[r]=new a.loader(a),this.decrypturl=n,this.decryptkey=null;var s={url:n,frag:t,responseType:"arraybuffer"},o={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};t.loader.load(s,o,l)}else this.decryptkey&&(t.decryptdata.key=this.decryptkey,this.hls.trigger(P.default.KEY_LOADED,{frag:t}))}else z.logger.warn("Missing decryption data on fragment in onKeyLoading")},n.loadsuccess=function(e,t,r){var i=r.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(e.data),i.loader=void 0,delete this.loaders[i.type],this.hls.trigger(P.default.KEY_LOADED,{frag:i})):z.logger.error("after key load, decryptdata unset")},n.loaderror=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})},n.loadtimeout=function(e,t){var r=t.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},i}(u);var U="NOT_LOADED",B="APPENDING",Y="PARTIAL",G="OK",V=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.BUFFER_APPENDED,P.default.FRAG_BUFFERED,P.default.FRAG_LOADED)||this).bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=e.config,t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n=i.prototype;return n.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,u.prototype.destroy.call(this),r.prototype.destroy.call(this)},n.getBufferedFrag=function(i,n){var a=this.fragments,e=Object.keys(a).filter(function(e){var t=a[e];if(t.body.type!==n)return!1;if(!t.buffered)return!1;var r=t.body;return r.startPTS<=i&&i<=r.endPTS});if(0===e.length)return null;var t=e.pop();return a[t].body},n.detectEvictedFragments=function(s,o){var l=this;Object.keys(this.fragments).forEach(function(e){var t=l.fragments[e];if(t&&t.buffered){var r=t.range[s];if(r)for(var i=r.time,n=0;n<i.length;n++){var a=i[n];if(!l.isTimeBuffered(a.startPTS,a.endPTS,o)){l.removeFragment(t.body);break}}}})},n.detectPartialFragments=function(r){var i=this,e=this.getFragmentKey(r),n=this.fragments[e];n&&(n.buffered=!0,Object.keys(this.timeRanges).forEach(function(e){if(r.hasElementaryStream(e)){var t=i.timeRanges[e];n.range[e]=i.getBufferedTimes(r.startPTS,r.endPTS,t)}}))},n.getBufferedTimes=function(e,t,r){for(var i,n,a=[],s=!1,o=0;o<r.length;o++){if(i=r.start(o)-this.bufferPadding,n=r.end(o)+this.bufferPadding,i<=e&&t<=n){a.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))});break}if(e<n&&i<t)a.push({startPTS:Math.max(e,r.start(o)),endPTS:Math.min(t,r.end(o))}),s=!0;else if(t<=i)break}return{time:a,partial:s}},n.getFragmentKey=function(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn},n.getPartialFragment=function(r){var i,n,a,s=this,o=null,l=0;return Object.keys(this.fragments).forEach(function(e){var t=s.fragments[e];s.isPartial(t)&&(n=t.body.startPTS-s.bufferPadding,a=t.body.endPTS+s.bufferPadding,n<=r&&r<=a&&(i=Math.min(r-n,a-r),l<=i&&(o=t.body,l=i)))}),o},n.getState=function(e){var t=this.getFragmentKey(e),r=this.fragments[t],i=U;return void 0!==r&&(i=r.buffered?!0===this.isPartial(r)?Y:G:B),i},n.isPartial=function(e){return!0===e.buffered&&(void 0!==e.range.video&&!0===e.range.video.partial||void 0!==e.range.audio&&!0===e.range.audio.partial)},n.isTimeBuffered=function(e,t,r){for(var i,n,a=0;a<r.length;a++){if(i=r.start(a)-this.bufferPadding,n=r.end(a)+this.bufferPadding,i<=e&&t<=n)return!0;if(t<=i)return!1}return!1},n.onFragLoaded=function(e){var t=e.frag;Object(j.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.fragments[this.getFragmentKey(t)]={body:t,range:Object.create(null),buffered:!1})},n.onBufferAppended=function(e){var r=this;this.timeRanges=e.timeRanges,Object.keys(this.timeRanges).forEach(function(e){var t=r.timeRanges[e];r.detectEvictedFragments(e,t)})},n.onFragBuffered=function(e){this.detectPartialFragments(e.frag)},n.hasFragment=function(e){var t=this.getFragmentKey(e);return void 0!==this.fragments[t]},n.removeFragment=function(e){var t=this.getFragmentKey(e);delete this.fragments[t]},n.removeAllFragments=function(){this.fragments=Object.create(null)},i}(u),W={search:function(e,t){for(var r=0,i=e.length-1,n=null,a=null;r<=i;){var s=t(a=e[n=(r+i)/2|0]);if(0<s)r=n+1;else{if(!(s<0))return a;i=n-1}}return null}},H=function(){function e(){}return e.isBuffered=function(e,t){try{if(e)for(var r=e.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(e){}return!1},e.bufferInfo=function(e,t,r){try{if(e){var i,n=e.buffered,a=[];for(i=0;i<n.length;i++)a.push({start:n.start(i),end:n.end(i)});return this.bufferedInfo(a,t,r)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}},e.bufferedInfo=function(e,t,r){e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end});var i=[];if(r)for(var n=0;n<e.length;n++){var a=i.length;if(a){var s=i[a-1].end;e[n].start-s<r?e[n].end>s&&(i[a-1].end=e[n].end):i.push(e[n])}else i.push(e[n])}else i=e;for(var o,l=0,u=t,c=t,d=0;d<i.length;d++){var f=i[d].start,h=i[d].end;if(f<=t+r&&t<h)u=f,l=(c=h)-t;else if(t+r<f){o=f;break}}return{len:l,start:u,end:c,nextStart:o}},e}(),$=r("./node_modules/eventemitter3/index.js"),Q=r("./node_modules/webworkify-webpack/index.js"),K=r("./src/demux/demuxer-inline.js");function Z(){return window.MediaSource||window.WebKitMediaSource}var X=r("./src/utils/get-self-scope.js");var J=function(e){var t,r;function i(){return e.apply(this,arguments)||this}return r=e,(t=i).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r,i.prototype.trigger=function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.emit.apply(this,[e,e].concat(r))},i}($.EventEmitter),q=Object(X.getSelfScope)(),ee=Z()||{isTypeSupported:function(){return!1}},te=function(){function e(r,e){var i=this;this.hls=r,this.id=e;function t(e,t){(t=t||{}).frag=i.frag,t.id=i.id,r.trigger(e,t)}var n=this.observer=new J,a=r.config;n.on(P.default.FRAG_DECRYPTED,t),n.on(P.default.FRAG_PARSING_INIT_SEGMENT,t),n.on(P.default.FRAG_PARSING_DATA,t),n.on(P.default.FRAG_PARSED,t),n.on(P.default.ERROR,t),n.on(P.default.FRAG_PARSING_METADATA,t),n.on(P.default.FRAG_PARSING_USERDATA,t),n.on(P.default.INIT_PTS_FOUND,t);var s={mp4:ee.isTypeSupported("video/mp4"),mpeg:ee.isTypeSupported("audio/mpeg"),mp3:ee.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(a.enableWorker&&"undefined"!=typeof Worker){var l;z.logger.log("demuxing in webworker");try{l=this.w=Q("./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),l.addEventListener("message",this.onwmsg),l.onerror=function(e){r.trigger(P.default.ERROR,{type:y.ErrorTypes.OTHER_ERROR,details:y.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},l.postMessage({cmd:"init",typeSupported:s,vendor:o,id:e,config:JSON.stringify(a)})}catch(e){z.logger.warn("Error in worker:",e),z.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),l&&q.URL.revokeObjectURL(l.objectURL),this.demuxer=new K.default(n,s,a,o),this.w=void 0}}else this.demuxer=new K.default(n,s,a,o)}var t=e.prototype;return t.destroy=function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},t.push=function(e,t,r,i,n,a,s,o){var l=this.w,u=Object(j.isFiniteNumber)(n.startPTS)?n.startPTS:n.start,c=n.decryptdata,d=this.frag,f=!(d&&n.cc===d.cc),h=!(d&&n.level===d.level),p=d&&n.sn===d.sn+1,g=!h&&p;if(f&&z.logger.log(this.id+":discontinuity detected"),h&&z.logger.log(this.id+":switch detected"),this.frag=n,l)l.postMessage({cmd:"demux",data:e,decryptdata:c,initSegment:t,audioCodec:r,videoCodec:i,timeOffset:u,discontinuity:f,trackSwitch:h,contiguous:g,duration:a,accurateTimeOffset:s,defaultInitPTS:o},e instanceof ArrayBuffer?[e]:[]);else{var m=this.demuxer;m&&m.push(e,c,t,r,i,u,f,h,g,a,s,o)}},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":q.URL.revokeObjectURL(this.w.objectURL);break;case P.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},e}();function re(e,t,r){switch(t){case"audio":e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds.push(r);break;case"text":e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds.push(r)}}function ie(e,t,r){var i=e[t],n=e[r],a=n.startPTS;Object(j.isFiniteNumber)(a)?t<r?(i.duration=a-i.start,i.duration<0&&z.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(n.duration=i.start-a,n.duration<0&&z.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):n.start=t<r?i.start+i.duration:Math.max(i.start-n.duration,0)}function ne(e,t,r,i,n,a){var s=r;if(Object(j.isFiniteNumber)(t.startPTS)){var o=Math.abs(t.startPTS-r);Object(j.isFiniteNumber)(t.deltaPTS)?t.deltaPTS=Math.max(o,t.deltaPTS):t.deltaPTS=o,s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),i=Math.max(i,t.endPTS),n=Math.min(n,t.startDTS),a=Math.max(a,t.endDTS)}var l=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=i,t.startDTS=n,t.endDTS=a,t.duration=i-r;var u,c,d,f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;for(u=f-e.startSN,(c=e.fragments)[u]=t,d=u;0<d;d--)ie(c,d,d-1);for(d=u;d<c.length-1;d++)ie(c,d,d+1);return e.PTSKnown=!0,l}function ae(e,r){r.initSegment&&e.initSegment&&(r.initSegment=e.initSegment);var i,n=0;if(se(e,r,function(e,t){n=e.cc-t.cc,Object(j.isFiniteNumber)(e.startPTS)&&(t.start=t.startPTS=e.startPTS,t.endPTS=e.endPTS,t.duration=e.duration,t.backtracked=e.backtracked,t.dropped=e.dropped,i=t),r.PTSKnown=!0}),r.PTSKnown){if(n){z.logger.log("discontinuity sliding from playlist, take drift into account");for(var t=r.fragments,a=0;a<t.length;a++)t[a].cc+=n}i?ne(r,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):function(e,t){var r=t.startSN-e.startSN,i=e.fragments,n=t.fragments;if(r<0||r>i.length)return;for(var a=0;a<n.length;a++)n[a].start+=i[r].start}(e,r),r.PTSKnown=e.PTSKnown}}function se(e,t,r){if(e&&t)for(var i=Math.max(e.startSN,t.startSN)-t.startSN,n=Math.min(e.endSN,t.endSN)-t.startSN,a=t.startSN-e.startSN,s=i;s<=n;s++){var o=e.fragments[a+s],l=t.fragments[s];if(!o||!l)break;r(o,l,s)}}function oe(e,t,r){var i=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),n=i/2;return e&&t.endSN===e.endSN&&(i=n),r&&(i=Math.max(n,i-(window.performance.now()-r))),Math.round(i)}var le={toString:function(e){for(var t="",r=e.length,i=0;i<r;i++)t+="["+e.start(i).toFixed(3)+","+e.end(i).toFixed(3)+"]";return t}};function ue(e,t){var r=e.fragments,i=t.fragments;if(i.length&&r.length){var n=function(e,t){for(var r=null,i=0;i<e.length;i+=1){var n=e[i];if(n&&n.cc===t){r=n;break}}return r}(r,i[0].cc);if(n&&(!n||n.startPTS))return n;z.logger.log("No frag in previous level to align on")}else z.logger.log("No fragments to align")}function ce(r,e){e.fragments.forEach(function(e){if(e){var t=e.start+r;e.start=e.startPTS=t,e.endPTS=t+e.duration}}),e.PTSKnown=!0}function de(e,t,r){!function(e,t,r){if(function(e,t,r){var i=!1;return t&&t.details&&r&&(r.endCC>r.startCC||e&&e.cc<r.startCC)&&(i=!0),i}(e,r,t)){var i=ue(r.details,t);i&&(z.logger.log("Adjusting PTS using last level due to CC increase within current level"),ce(i.start,t))}}(e,r,t),!r.PTSKnown&&t&&function(e,t){if(t&&t.fragments.length){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;var r=t.fragments[0].programDateTime,i=(e.fragments[0].programDateTime-r)/1e3+t.fragments[0].start;Object(j.isFiniteNumber)(i)&&(z.logger.log("adjusting PTS using programDateTime delta, sliding:"+i.toFixed(3)),ce(i,e))}}(r,t.details)}function fe(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Object(j.isFiniteNumber)(t))return null;var i,n,a,s,o;if(t<(e[0].programDateTime||0))return null;if((e[e.length-1].endProgramDateTime||0)<=t)return null;r=r||0;for(var l=0;l<e.length;++l){var u=e[l];if(i=t,n=r,a=u,0,s=1e3*Math.min(n,a.duration+(a.deltaPTS?a.deltaPTS:0)),o=a.endProgramDateTime||0,i<o-s)return u}return null}function he(e,t,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=e?t[e.sn-t[0].sn+1]:null;return n&&!pe(r,i,n)?n:W.search(t,pe.bind(null,r,i))}function pe(e,t,r){void 0===e&&(e=0),void 0===t&&(t=0);var i=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=e?1:r.start-i>e&&r.start?-1:0}var ge=function(){function e(e,t,r,i){this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var t=e.prototype;return t.poll=function(e){var t=this.config,r=this.media,i=this.stalled,n=r.currentTime,a=r.seeking,s=this.seeking&&!a,o=!this.seeking&&a;if(this.seeking=a,n===e){if((o||s)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var l=H.bufferInfo(r,n,0),u=0<l.len,c=l.nextStart||0;if(u||c){if(a){var d=2<l.len,f=!c||2<c-n&&!this.fragmentTracker.getPartialFragment(n);if(d||f)return;this.moved=!1}if(!this.moved&&this.stalled){var h=Math.max(c,l.start||0)-n;if(0<h&&h<=2)return void this._trySkipBufferHole(null)}var p=self.performance.now();if(null!==i){var g=p-i;!a&&250<=g&&this._reportStall(l.len);var m=H.bufferInfo(r,n,t.maxBufferHole);this._tryFixBufferStall(m,g)}else this.stalled=p}}}else if(this.moved=!0,null!==i){if(this.stallReported){var y=self.performance.now()-i;z.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(y)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},t._tryFixBufferStall=function(e,t){var r=this.config,i=this.fragmentTracker,n=this.media.currentTime,a=i.getPartialFragment(n);if(a&&this._trySkipBufferHole(a))return;e.len>r.maxBufferHole&&t>1e3*r.highBufferWatchdogPeriod&&(z.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},t._reportStall=function(e){var t=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,z.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+e+")"),t.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:e}))},t._trySkipBufferHole=function(e){for(var t=this.config,r=this.hls,i=this.media,n=i.currentTime,a=0,s=0;s<i.buffered.length;s++){var o=i.buffered.start(s);if(n+t.maxBufferHole>=a&&n<o){var l=Math.max(o+.05,i.currentTime+.1);return z.logger.warn("skipping hole, adjusting currentTime from "+n+" to "+l),this.moved=!0,this.stalled=null,i.currentTime=l,e&&r.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+l,frag:e}),l}a=i.buffered.end(s)}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,i=r.currentTime,n=(this.nudgeRetry||0)+1;if((this.nudgeRetry=n)<e.nudgeMaxRetry){var a=i+n*e.nudgeOffset;z.logger.warn("Nudging 'currentTime' from "+i+" to "+a),r.currentTime=a,t.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else z.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+e.nudgeMaxRetry+" nudges"),t.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},e}();var me=function(a){var e,t;function r(e){for(var t,r=arguments.length,i=new Array(1<r?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return(t=a.call.apply(a,[this,e].concat(i))||this)._boundTick=void 0,t._tickTimer=null,t._tickInterval=null,t._tickCallCount=0,t._boundTick=t.tick.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)),t}t=a,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var i=r.prototype;return i.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},i.hasInterval=function(){return!!this._tickInterval},i.hasNextTick=function(){return!!this._tickTimer},i.setInterval=function(e){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,e),!0)},i.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),!(this._tickInterval=null))},i.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),!(this._tickTimer=null))},i.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},i.doTick=function(){},r}(u);var ye="STOPPED",ve="STARTING",be="IDLE",Se="PAUSED",Te="KEY_LOADING",_e="FRAG_LOADING",Ie="FRAG_LOADING_WAITING_RETRY",Me="WAITING_TRACK",Ae="PARSING",De="PARSED",we="BUFFER_FLUSHING",Ee="ENDED",Ce="ERROR",Le="WAITING_INIT_PTS",Oe="WAITING_LEVEL",Ne=function(e){var t,r;function i(){return e.apply(this,arguments)||this}r=e,(t=i).prototype=Object.create(r.prototype),(t.prototype.constructor=t).__proto__=r;var n=i.prototype;return n.doTick=function(){},n.startLoad=function(){},n.stopLoad=function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragmentTracker.removeFragment(e)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ye},n._streamEnded=function(e,t){var r=this.fragCurrent,i=this.fragmentTracker;if(t.live||!r||r.backtracked||r.sn!==t.endSN||e.nextStart)return!1;var n=i.getState(r);return n===Y||n===G},n.onMediaSeeking=function(){var e=this.config,t=this.media,r=this.mediaBuffer,i=this.state,n=t?t.currentTime:null,a=H.bufferInfo(r||t,n,this.config.maxBufferHole);if(Object(j.isFiniteNumber)(n)&&z.logger.log("media seeking to "+n.toFixed(3)),i===_e){var s=this.fragCurrent;if(0===a.len&&s){var o=e.maxFragLookUpTolerance,l=s.start-o,u=s.start+s.duration+o;n<l||u<n?(s.loader&&(z.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),s.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=be):z.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else i===Ee&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=be);t&&(this.lastCurrentTime=n),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=n),this.tick()},n.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},n.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},n.onHandlerDestroyed=function(){this.state=ye,this.fragmentTracker=null},n.computeLivePosition=function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)},i}(me);function ke(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xe,Re=function(i){var e,t;function r(e,t){var r;return(r=i.call(this,e,P.default.MEDIA_ATTACHED,P.default.MEDIA_DETACHING,P.default.MANIFEST_LOADING,P.default.MANIFEST_PARSED,P.default.LEVEL_LOADED,P.default.LEVELS_UPDATED,P.default.KEY_LOADED,P.default.FRAG_LOADED,P.default.FRAG_LOAD_EMERGENCY_ABORTED,P.default.FRAG_PARSING_INIT_SEGMENT,P.default.FRAG_PARSING_DATA,P.default.FRAG_PARSED,P.default.ERROR,P.default.AUDIO_TRACK_SWITCHING,P.default.AUDIO_TRACK_SWITCHED,P.default.BUFFER_CREATED,P.default.BUFFER_APPENDED,P.default.BUFFER_FLUSHED)||this).fragmentTracker=t,r.config=e.config,r.audioCodecSwap=!1,r._state=ye,r.stallReported=!1,r.gapController=null,r.altAudio=!1,r.bitrateTest=!1,r}t=i,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n,a,s,o=r.prototype;return o.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(r.config.testBandwidth?(i=0,this.bitrateTest=!0):i=r.nextAutoLevel),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}0<t&&-1===e&&(z.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=be,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=ye},o.stopLoad=function(){this.forceStartLoad=!1,i.prototype.stopLoad.call(this)},o.doTick=function(){switch(this.state){case we:this.fragLoadError=0;break;case be:this._doTickIdle();break;case Oe:var e=this.levels[this.level];e&&e.details&&(this.state=be);break;case Ie:var t=window.performance.now(),r=this.retryDate;(!r||r<=t||this.media&&this.media.seeking)&&(z.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=be)}this._checkBuffer(),this._checkFragmentChanged()},o._doTickIdle=function(){var e=this.hls,t=e.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&t.startFragPrefetch)){var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var n=e.nextLoadLevel,a=this.levels[n];if(a){var s,o=a.bitrate;s=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,s=Math.min(s,t.maxMaxBufferLength);var l=i<t.maxBufferHole?Math.max(2,t.maxBufferHole):t.maxBufferHole,u=H.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,l),c=u.len;if(!(s<=c)){z.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+s.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=n;var d=a.details;if(!d||d.live&&this.levelLastLoaded!==n)this.state=Oe;else{if(this._streamEnded(u,d)){var f={};return this.altAudio&&(f.type="video"),this.hls.trigger(P.default.BUFFER_EOS,f),void(this.state=Ee)}this._fetchPayloadOrEos(i,u,d)}}}}},o._fetchPayloadOrEos=function(e,t,r){var i=this.fragPrevious,n=(this.level,r.fragments),a=n.length;if(0!==a){var s,o=n[0].start,l=n[a-1].start+n[a-1].duration,u=t.end;if(r.initSegment&&!r.initSegment.data)s=r.initSegment;else if(r.live){var c=this.config.initialLiveManifestSize;if(a<c)return void z.logger.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+c);if(null===(s=this._ensureFragmentAtLivePoint(r,u,o,l,i,n)))return}else u<o&&(s=n[0]);(s=s||this._findFragment(o,i,a,n,u,l,r))&&(s.encrypted?this._loadKey(s,r):this._loadFragment(s,r,e,u))}},o._ensureFragmentAtLivePoint=function(e,t,r,i,n,a){var s,o=this.hls.config,l=this.media,u=1/0;if(void 0!==o.liveMaxLatencyDuration?u=o.liveMaxLatencyDuration:Object(j.isFiniteNumber)(o.liveMaxLatencyDurationCount)&&(u=o.liveMaxLatencyDurationCount*e.targetduration),t<Math.max(r-o.maxFragLookUpTolerance,i-u)){var c=this.liveSyncPosition=this.computeLivePosition(r,e);t=c,l&&!l.paused&&l.readyState&&l.duration>c&&c>l.currentTime&&(z.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),l.currentTime=c),this.nextLoadPosition=c}if(e.PTSKnown&&i<t&&l&&l.readyState)return null;if(this.startFragRequested&&!e.PTSKnown&&n)if(e.hasProgramDateTime)z.logger.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),s=fe(a,n.endProgramDateTime,o.maxFragLookUpTolerance);else{var d=n.sn+1;if(d>=e.startSN&&d<=e.endSN){var f=a[d-e.startSN];n.cc===f.cc&&(s=f,z.logger.log("live playlist, switching playlist, load frag with next SN: "+s.sn))}s||(s=W.search(a,function(e){return n.cc-e.cc}))&&z.logger.log("live playlist, switching playlist, load frag with same CC: "+s.sn)}return s},o._findFragment=function(e,t,r,i,n,a,s){var o,l=this.hls.config;n<a?o=he(t,i,n,n>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):o=i[r-1];if(o){var u=o.sn-s.startSN,c=t&&o.level===t.level,d=i[u-1],f=i[1+u];if(t&&o.sn===t.sn)if(c&&!o.backtracked)if(o.sn<s.endSN){var h=t.deltaPTS;h&&h>l.maxBufferHole&&t.dropped&&u?(o=d,z.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(o=f,z.logger.log("Re-loading fragment with SN: "+o.sn))}else o=null;else o.backtracked&&(f&&f.backtracked?(z.logger.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+o.sn+". Loading fragment "+f.sn),o=f):(z.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),o.dropped=0,d?(o=d).backtracked=!0:u&&(o=null)))}return o},o._loadKey=function(e,t){z.logger.log("Loading key for "+e.sn+" of ["+t.startSN+" ,"+t.endSN+"],level "+this.level),this.state=Te,this.hls.trigger(P.default.KEY_LOADING,{frag:e})},o._loadFragment=function(e,t,r,i){var n=this.fragmentTracker.getState(e);"initSegment"!==(this.fragCurrent=e).sn&&(this.startFragRequested=!0),Object(j.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),e.backtracked||n===U||n===Y?(e.autoLevel=this.hls.autoLevelEnabled,e.bitrateTest=this.bitrateTest,z.logger.log("Loading "+e.sn+" of ["+t.startSN+" ,"+t.endSN+"],level "+this.level+", currentTime:"+r.toFixed(3)+",bufferEnd:"+i.toFixed(3)),this.hls.trigger(P.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new te(this.hls,"main")),this.state=_e):n===B&&this._reduceMaxBufferLength(e.duration)&&this.fragmentTracker.removeFragment(e)},o.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,l.MAIN)},o.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.endPTS+.5):null},o._checkFragmentChanged=function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),H.isBuffered(r,t)?e=this.getBufferedFrag(t):H.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var i=e;if(i!==this.fragPlaying){this.hls.trigger(P.default.FRAG_CHANGED,{frag:i});var n=i.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(P.default.LEVEL_SWITCHED,{level:n}),this.fragPlaying=i}}},o.immediateLevelSwitch=function(){if(z.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e,t=this.media;t?(e=t.paused,t.pause()):e=!0,this.previouslyPaused=e}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},o.immediateLevelSwitchEnd=function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,H.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())},o.nextLevelSwitch=function(){var e=this.media;if(e&&e.readyState){var t,r,i;if((r=this.getBufferedFrag(e.currentTime))&&1<r.startPTS&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var n=this.hls.nextLoadLevel,a=this.levels[n],s=this.fragLastKbps;t=s&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*s)+1:0}if(i=(i=this.getBufferedFrag(e.currentTime+t))&&this.followingBufferedFrag(i)){var o=this.fragCurrent;o&&o.loader&&o.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,Number.POSITIVE_INFINITY)}}},o.flushMainBuffer=function(e,t){this.state=we;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(P.default.BUFFER_FLUSHING,r)},o.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new ge(r,t,this.fragmentTracker,this.hls)},o.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(z.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},o.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:void 0;Object(j.isFiniteNumber)(t)&&z.logger.log("media seeked to "+t.toFixed(3)),this.tick()},o.onManifestLoading=function(){z.logger.log("trigger BUFFER_RESET"),this.hls.trigger(P.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},o.onManifestParsed=function(e){var t,r=!1,i=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&z.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=e.altAudio,this.levels=e.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},o.onLevelLoaded=function(e){var t=e.details,r=e.level,i=this.levels[this.levelLastLoaded],n=this.levels[r],a=t.totalduration,s=0;if(z.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+a),t.live){var o=n.details;o&&0<t.fragments.length?(ae(o,t),s=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(s,o),t.PTSKnown&&Object(j.isFiniteNumber)(s)?z.logger.log("live playlist sliding:"+s.toFixed(3)):(z.logger.log("live playlist - outdated PTS, unknown sliding"),de(this.fragPrevious,i,t))):(z.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,de(this.fragPrevious,i,t))}else t.PTSKnown=!1;if(n.details=t,this.levelLastLoaded=r,this.hls.trigger(P.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var l=t.startTimeOffset;Object(j.isFiniteNumber)(l)?(l<0&&(z.logger.log("negative start time offset "+l+", count from end of last fragment"),l=s+a+l),z.logger.log("start time offset found in playlist, adjust startPosition to "+l),this.startPosition=l):t.live?(this.startPosition=this.computeLivePosition(s,t),z.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===Oe&&(this.state=be),this.tick()},o.onKeyLoaded=function(){this.state===Te&&(this.state=be,this.tick())},o.onFragLoaded=function(e){var t=this.fragCurrent,r=this.hls,i=this.levels,n=this.media,a=e.frag;if(this.state===_e&&t&&"main"===a.type&&a.level===t.level&&a.sn===t.sn){var s=e.stats,o=i[t.level],l=o.details;if(this.bitrateTest=!1,this.stats=s,z.logger.log("Loaded "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level),a.bitrateTest&&r.nextLoadLevel)this.state=be,this.startFragRequested=!1,s.tparsed=s.tbuffered=window.performance.now(),r.trigger(P.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=be,s.tparsed=s.tbuffered=window.performance.now(),l.initSegment.data=e.payload,r.trigger(P.default.FRAG_BUFFERED,{stats:s,frag:t,id:"main"}),this.tick();else{z.logger.log("Parsing "+t.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+t.level+", cc "+t.cc),this.state=Ae,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var u=!(n&&n.seeking)&&(l.PTSKnown||!l.live),c=l.initSegment?l.initSegment.data:[],d=this._getAudioCodec(o);(this.demuxer=this.demuxer||new te(this.hls,"main")).push(e.payload,c,d,o.videoCodec,t,l.totalduration,u)}}this.fragLoadError=0},o.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ae){var i,n,a=e.tracks;if(a.audio&&this.altAudio&&delete a.audio,n=a.audio){var s=this.levels[this.level].audioCodec,o=navigator.userAgent.toLowerCase();s&&this.audioCodecSwap&&(z.logger.log("swapping playlist audio codec"),s=-1!==s.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===o.indexOf("firefox")&&(s="mp4a.40.5"),-1!==o.indexOf("android")&&"audio/mpeg"!==n.container&&(s="mp4a.40.2",z.logger.log("Android: force audio codec to "+s)),n.levelCodec=s,n.id=e.id}for(i in(n=a.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=e.id),this.hls.trigger(P.default.BUFFER_CODECS,a),a){n=a[i],z.logger.log("main track:"+i+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var l=n.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(P.default.BUFFER_APPENDING,{type:i,data:l,parent:"main",content:"initSegment"}))}this.tick()}},o.onFragParsingData=function(t){var r=this,e=this.fragCurrent,i=t.frag;if(e&&"main"===t.id&&i.sn===e.sn&&i.level===e.level&&("audio"!==t.type||!this.altAudio)&&this.state===Ae){var n=this.levels[this.level],a=e;if(Object(j.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),!0===t.hasAudio&&a.addElementaryStream(f.AUDIO),!0===t.hasVideo&&a.addElementaryStream(f.VIDEO),z.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(a.dropped=t.dropped,a.dropped)if(a.backtracked)z.logger.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var s=n.details;if(!s||a.sn!==s.startSN)return z.logger.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=be,this.fragPrevious=a,void this.tick();z.logger.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var o=ne(n.details,a,t.startPTS,t.endPTS,t.startDTS,t.endDTS),l=this.hls;l.trigger(P.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:o,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(e){e&&e.length&&r.state===Ae&&(r.appended=!0,r.pendingBuffering=!0,l.trigger(P.default.BUFFER_APPENDING,{type:t.type,data:e,parent:"main",content:"data"}))}),this.tick()}},o.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ae&&(this.stats.tparsed=window.performance.now(),this.state=De,this._checkAppendedParsed())},o.onAudioTrackSwitching=function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){z.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(z.logger.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=be}var n=this.hls;n.trigger(P.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(P.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}},o.onAudioTrackSwitched=function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(z.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},o.onBufferCreated=function(e){var t,r,i=e.tracks,n=!1;for(var a in i){var s=i[a];"main"===s.id?(t=s,"video"===(r=a)&&(this.videoBuffer=i[a].buffer)):n=!0}n&&t?(z.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=t.buffer):this.mediaBuffer=this.media},o.onBufferAppended=function(e){if("main"===e.parent){var t=this.state;t!==Ae&&t!==De||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},o._checkAppendedParsed=function(){if(!(this.state!==De||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;z.logger.log("main buffered : "+le.toString(t.buffered)),this.fragPrevious=e;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(P.default.FRAG_BUFFERED,{stats:r,frag:e,id:"main"}),this.state=be}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},o.onError=function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=!!this.media&&H.isBuffered(this.media,this.media.currentTime)&&H.isBuffered(this.media,this.media.currentTime+.5);switch(e.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);z.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=Ie}else z.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ce;break;case y.ErrorDetails.LEVEL_LOAD_ERROR:case y.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==Ce&&(e.fatal?(this.state=Ce,z.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==Oe||(this.state=be));break;case y.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==Ae&&this.state!==De||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=be):(z.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},o._reduceMaxBufferLength=function(e){var t=this.config;return t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,z.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},o._checkBuffer=function(){var e=this.media;if(e&&0!==e.readyState){var t=(this.mediaBuffer?this.mediaBuffer:e).buffered;!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t)}},o.onFragLoadEmergencyAborted=function(){this.state=be,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},o.onBufferFlushed=function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;e&&this.fragmentTracker.detectEvictedFragments(f.VIDEO,e.buffered),this.state=be,this.fragPrevious=null},o.onLevelsUpdated=function(e){this.levels=e.levels},o.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},o._seekToStartPos=function(){var e=this.media,t=this.startPosition,r=e.currentTime;if(r!==t&&0<=t){if(e.seeking)return void z.logger.log("could not seek to "+t+", already seeking at "+r);z.logger.log("seek to target start position "+t+" from current time "+r+". ready state "+e.readyState),e.currentTime=t}},o._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&(z.logger.log("swapping playlist audio codec"),t=t&&(-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},n=r,(a=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,z.logger.log("main stream-controller: "+t+"->"+e),this.hls.trigger(P.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}])&&ke(n.prototype,a),s&&ke(n,s),r}(Ne);function je(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pe=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.MANIFEST_LOADED,P.default.LEVEL_LOADED,P.default.AUDIO_TRACK_SWITCHED,P.default.FRAG_LOADED,P.default.ERROR)||this).canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,xe=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n,a,s,o=i.prototype;return o.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},o.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},o.startLoad=function(){var e=this._levels;this.canload=!0,this.levelRetryCount=0,e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),null!==this.timer&&this.loadLevel()},o.stopLoad=function(){this.canload=!1},o.onManifestLoaded=function(e){var t,r=[],i=[],n={},a=null,s=!1,o=!1;if(e.levels.forEach(function(e){var t=e.attrs;e.loadError=0,e.fragmentError=!1,s=s||!!e.videoCodec,o=o||!!e.audioCodec,xe&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(a=n[e.bitrate])?a.url.push(e.url):(e.url=[e.url],e.urlId=0,n[e.bitrate]=e,r.push(e)),t&&(t.AUDIO&&(o=!0,re(a||e,"audio",t.AUDIO)),t.SUBTITLES&&re(a||e,"text",t.SUBTITLES))}),s&&o&&(r=r.filter(function(e){return!!e.videoCodec})),r=r.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||T(t,"audio"))&&(!r||T(r,"video"))}),e.audioTracks&&(i=e.audioTracks.filter(function(e){return!e.audioCodec||T(e.audioCodec,"audio")})).forEach(function(e,t){e.id=t}),0<r.length){t=r[0].bitrate,r.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=r;for(var l=0;l<r.length;l++)if(r[l].bitrate===t){this._firstLevel=l,z.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+t);break}this.hls.trigger(P.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:e.stats,audio:o,video:s,altAudio:i.some(function(e){return!!e.url})})}else this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},o.setLevelInternal=function(e){var t=this._levels,r=this.hls;if(0<=e&&e<t.length){if(this.clearTimer(),this.currentLevelIndex!==e){z.logger.log("switching to level "+e);var i=t[this.currentLevelIndex=e];i.level=e,r.trigger(P.default.LEVEL_SWITCHING,i)}var n=t[e],a=n.details;if(!a||a.live){var s=n.urlId;r.trigger(P.default.LEVEL_LOADING,{url:n.url[s],level:e,id:s})}}else r.trigger(P.default.ERROR,{type:y.ErrorTypes.OTHER_ERROR,details:y.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})},o.onError=function(e){if(e.fatal)e.type===y.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,r=!1,i=!1;switch(e.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:t=e.frag.level,i=!0;break;case y.ErrorDetails.LEVEL_LOAD_ERROR:case y.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=e.context.level,r=!0;break;case y.ErrorDetails.REMUX_ALLOC_ERROR:t=e.level,r=!0}void 0!==t&&this.recoverLevel(e,t,r,i)}},o.recoverLevel=function(e,t,r,i){var n,a,s,o=this,l=this.hls.config,u=e.details,c=this._levels[t];if(c.loadError++,c.fragmentError=i,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return z.logger.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(e.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return o.loadLevel()},a),e.levelRetry=!0,this.levelRetryCount++,z.logger.warn("level controller, "+u+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&(1<(n=c.url.length)&&c.loadError<n?(c.urlId=(c.urlId+1)%n,c.details=void 0,z.logger.warn("level controller, "+u+" for level "+t+": switching to redundant URL-id "+c.urlId)):-1===this.manualLevelIndex?(s=0===t?this._levels.length-1:t-1,z.logger.warn("level controller, "+u+": switch to "+s),this.hls.nextAutoLevel=this.currentLevelIndex=s):i&&(z.logger.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},o.onFragLoaded=function(e){var t=e.frag;if(void 0!==t&&"main"===t.type){var r=this._levels[t.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},o.onLevelLoaded=function(e){var t=this,r=e.level,i=e.details;if(r===this.currentLevelIndex){var n=this._levels[r];if(n.fragmentError||(n.loadError=0,this.levelRetryCount=0),i.live){var a=oe(n.details,i,e.stats.trequest);z.logger.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return t.loadLevel()},a)}else this.clearTimer()}},o.onAudioTrackSwitched=function(e){var t=this.hls.audioTracks[e.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,n=0;n<r.audioGroupIds.length;n++)if(r.audioGroupIds[n]===t){i=n;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},o.loadLevel=function(){if(z.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var e=this._levels[this.currentLevelIndex];if("object"==typeof e&&0<e.url.length){var t=this.currentLevelIndex,r=e.urlId,i=e.url[r];z.logger.log("Attempt loading level index "+t+" with URL-id "+r),this.hls.trigger(P.default.LEVEL_LOADING,{url:i,level:t,id:r})}}},o.removeLevel=function(r,i){var e=this.levels.filter(function(e,t){return t!==r||1<e.url.length&&void 0!==i&&(e.url=e.url.filter(function(e,t){return t!==i}),!(e.urlId=0))}).map(function(e,t){var r=e.details;return r&&r.fragments&&r.fragments.forEach(function(e){e.level=t}),e});this._levels=e,this.hls.trigger(P.default.LEVELS_UPDATED,{levels:e})},n=i,(a=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;t&&(e=Math.min(e,t.length-1),this.currentLevelIndex===e&&t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0!==this._startLevel)return this._startLevel;var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}])&&je(n.prototype,a),s&&je(n,s),i}(u),ze=r("./src/demux/id3.js");function Fe(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function Ue(e){if(null!=e&&e.cues)for(;0<e.cues.length;)e.removeCue(e.cues[0])}var Be=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.MEDIA_ATTACHED,P.default.MEDIA_DETACHING,P.default.FRAG_PARSING_METADATA,P.default.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,t.media=void 0,t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n=i.prototype;return n.destroy=function(){u.prototype.destroy.call(this)},n.onMediaAttached=function(e){this.media=e.media,this.media},n.onMediaDetaching=function(){Ue(this.id3Track),this.id3Track=void 0,this.media=void 0},n.getID3Track=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return Fe(r,this.media),r}return this.media.addTextTrack("metadata","id3")},n.onFragParsingMetadata=function(e){var t=e.frag,r=e.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<r.length;n++){var a=ze.default.getID3Frames(r[n].data);if(a){var s=Math.max(r[n].pts,0),o=n<r.length-1?r[n+1].pts:t.endPTS;s===(o=o||t.start+t.duration)?o+=1e-4:o<s&&(z.logger.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),o=s+.25);for(var l=0;l<a.length;l++){var u=a[l];if(!ze.default.isTimeStampFrame(u)){var c=new i(s,o,"");c.value=u,this.id3Track.addCue(c)}}}}},n.onLiveBackBufferReached=function(e){var t=e.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var i=function(e,t){if(t<e[0].endTime)return e[0];if(t>e[e.length-1].endTime)return e[e.length-1];for(var r=0,i=e.length-1;r<=i;){var n=Math.floor((i+r)/2);if(t<e[n].endTime)i=n-1;else{if(!(t>e[n].endTime))return e[n];r=n+1}}return e[r].endTime-t<t-e[i].endTime?e[r]:e[i]}(r.cues,t);if(i)for(;r.cues[0]!==i;)r.removeCue(r.cues[0])}},i}(u);var Ye=function(){function e(e){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=0,this.totalWeight_=0}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_},e}(),Ge=function(){function e(e,t,r,i){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=e,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ye(t),this.fast_=new Ye(r)}var t=e.prototype;return t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/r;this.fast_.sample(r,i),this.slow_.sample(r,i)},t.canEstimate=function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.destroy=function(){},e}();function Ve(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var We=window.performance,He=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.FRAG_LOADING,P.default.FRAG_LOADED,P.default.FRAG_BUFFERED,P.default.ERROR)||this).lastLoadedFragLevel=0,t._nextAutoLevel=-1,t.hls=e,t.timer=null,t._bwEstimator=null,t.onCheck=t._abandonRulesCheck.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)),t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n,a,s,o=i.prototype;return o.destroy=function(){this.clearTimer(),u.prototype.destroy.call(this)},o.onFragLoading=function(e){var t=e.frag;if("main"===t.type&&(this.timer||(this.fragCurrent=t,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,i,n=this.hls,a=n.config,s=t.level;i=n.levels[s].details.live?(r=a.abrEwmaFastLive,a.abrEwmaSlowLive):(r=a.abrEwmaFastVoD,a.abrEwmaSlowVoD),this._bwEstimator=new Ge(n,i,r,a.abrEwmaDefaultEstimate)}},o._abandonRulesCheck=function(){var e=this.hls,t=e.media,r=this.fragCurrent;if(r){var i=r.loader;if(!i||i.stats&&i.stats.aborted)return z.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var n=i.stats;if(t&&n&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var a=We.now()-n.trequest,s=Math.abs(t.playbackRate);if(a>500*r.duration/s){var o=e.levels,l=Math.max(1,n.bw?n.bw/8:1e3*n.loaded/a),u=o[r.level];if(!u)return;var c=u.realBitrate?Math.max(u.realBitrate,u.bitrate):u.bitrate,d=n.total?n.total:Math.max(n.loaded,Math.round(r.duration*c/8)),f=t.currentTime,h=(d-n.loaded)/l,p=(H.bufferInfo(t,f,e.config.maxBufferHole).end-f)/s;if(p<2*r.duration/s&&p<h){var g,m=e.minAutoLevel;for(g=r.level-1;m<g;g--){var y=o[g].realBitrate?Math.max(o[g].realBitrate,o[g].bitrate):o[g].bitrate;if(r.duration*y/(6.4*l)<p)break}void 0<h&&(z.logger.warn("loading too slow, abort fragment loading and switch to level "+g+":fragLoadedDelay["+g+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+h.toFixed(1)+":"+p.toFixed(1)),e.nextLoadLevel=g,this._bwEstimator.sample(a,n.loaded),i.abort(),this.clearTimer(),e.trigger(P.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:n}))}}}}},o.onFragLoaded=function(e){var t=e.frag;if("main"===t.type&&Object(j.isFiniteNumber)(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],i=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,n=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:i,duration:n},r.realBitrate=Math.round(8*i/n)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}},o.onFragBuffered=function(e){var t=e.stats,r=e.frag;if(!0!==t.aborted&&"main"===r.type&&Object(j.isFiniteNumber)(r.sn)&&(!r.bitrateTest||t.tload===t.tbuffered)){var i=t.tparsed-t.trequest;z.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},o.onError=function(e){switch(e.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},o.clearTimer=function(){clearInterval(this.timer),this.timer=null},o._findBestLevel=function(e,t,r,i,n,a,s,o,l){for(var u=n;i<=u;u--){var c=l[u];if(c){var d=c.details,f=d?d.totalduration/d.fragments.length:t,h=!!d&&d.live,p=void 0;p=u<=e?s*r:o*r;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=g*f/p;if(z.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(p)+"/"+g+"/"+f+"/"+a+"/"+m),g<p&&(!m||h&&!this.bitrateTestDelay||m<a))return u}}return-1},n=i,(a=[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,i=e.config,n=e.minAutoLevel,a=e.media,s=this.lastLoadedFragLevel,o=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,c=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,d=(H.bufferInfo(a,l,i.maxBufferHole).end-l)/u,f=this._findBestLevel(s,o,c,n,t,d,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(0<=f)return f;z.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var h=o?Math.min(o,i.maxStarvationDelay):i.maxStarvationDelay,p=i.abrBandWidthFactor,g=i.abrBandWidthUpFactor;if(0==d){var m=this.bitrateTestDelay;if(m)h=(o?Math.min(o,i.maxLoadingDelay):i.maxLoadingDelay)-m,z.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),p=g=1}return f=this._findBestLevel(s,o,c,n,t,d+h,p,g,r),Math.max(f,0)}}])&&Ve(n.prototype,a),s&&Ve(n,s),i}(u);var $e=Z(),Qe=function(t){var e,r;function i(e){var o;return(o=t.call(this,e,P.default.MEDIA_ATTACHING,P.default.MEDIA_DETACHING,P.default.MANIFEST_PARSED,P.default.BUFFER_RESET,P.default.BUFFER_APPENDING,P.default.BUFFER_CODECS,P.default.BUFFER_EOS,P.default.BUFFER_FLUSHING,P.default.LEVEL_PTS_UPDATED,P.default.LEVEL_UPDATED)||this)._msDuration=null,o._levelDuration=null,o._levelTargetDuration=10,o._live=null,o._objectUrl=null,o._needsFlush=!1,o._needsEos=!1,o.config=void 0,o.audioTimestampOffset=void 0,o.bufferCodecEventsExpected=0,o._bufferCodecEventsTotal=0,o.media=null,o.mediaSource=null,o.segments=[],o.parent=void 0,o.appending=!1,o.appended=0,o.appendError=0,o.flushBufferCounter=0,o.tracks={},o.pendingTracks={},o.sourceBuffer={},o.flushRange=[],o._onMediaSourceOpen=function(){z.logger.log("media source opened"),o.hls.trigger(P.default.MEDIA_ATTACHED,{media:o.media});var e=o.mediaSource;e&&e.removeEventListener("sourceopen",o._onMediaSourceOpen),o.checkPendingTracks()},o._onMediaSourceClose=function(){z.logger.log("media source closed")},o._onMediaSourceEnded=function(){z.logger.log("media source ended")},o._onSBUpdateEnd=function(){if(o.audioTimestampOffset&&o.sourceBuffer.audio){var e=o.sourceBuffer.audio;z.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+o.audioTimestampOffset),e.timestampOffset=o.audioTimestampOffset,delete o.audioTimestampOffset}o._needsFlush&&o.doFlush(),o._needsEos&&o.checkEos(),o.appending=!1;var r=o.parent,t=o.segments.reduce(function(e,t){return t.parent===r?e+1:e},0),i={},n=o.sourceBuffer;for(var a in n){var s=n[a];if(!s)throw Error("handling source buffer update end error: source buffer for "+a+" uninitilized and unable to update buffered TimeRanges.");i[a]=s.buffered}o.hls.trigger(P.default.BUFFER_APPENDED,{parent:r,pending:t,timeRanges:i}),o._needsFlush||o.doAppending(),o.updateMediaElementDuration(),0===t&&o.flushLiveBackBuffer()},o._onSBUpdateError=function(e){z.logger.error("sourceBuffer error:",e),o.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},o.config=e.config,o}r=t,(e=i).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var n=i.prototype;return n.destroy=function(){u.prototype.destroy.call(this)},n.onLevelPtsUpdated=function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(!i)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(.1<Math.abs(i.timestampOffset-e.start)){var n=i.updating;try{i.abort()}catch(e){z.logger.warn("can not abort audio buffer: "+e)}n?this.audioTimestampOffset=e.start:(z.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+e.start),i.timestampOffset=e.start)}}},n.onManifestParsed=function(e){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e.altAudio?2:1,z.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},n.onMediaAttaching=function(e){var t=this.media=e.media;if(t&&$e){var r=this.mediaSource=new $e;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),t.src=window.URL.createObjectURL(r),this._objectUrl=t.src}},n.onMediaDetaching=function(){z.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){z.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this._onMediaSourceOpen),e.removeEventListener("sourceended",this._onMediaSourceEnded),e.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):z.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(P.default.MEDIA_DETACHED)},n.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.pendingTracks,r=Object.keys(t).length;(r&&!e||2===r)&&(this.createSourceBuffers(t),this.pendingTracks={},this.doAppending())},n.onBufferReset=function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},n.onBufferCodecs=function(t){var r=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach(function(e){r.pendingTracks[e]=t[e]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},n.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var i in e)if(!t[i]){var n=e[i];if(!n)throw Error("source buffer exists for track "+i+", however track does not");var a=n.levelCodec||n.codec,s=n.container+";codecs="+a;z.logger.log("creating sourceBuffer("+s+")");try{var o=t[i]=r.addSourceBuffer(s);o.addEventListener("updateend",this._onSBUpdateEnd),o.addEventListener("error",this._onSBUpdateError),this.tracks[i]={buffer:o,codec:a,id:n.id,container:n.container,levelCodec:n.levelCodec}}catch(e){z.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(P.default.BUFFER_CREATED,{tracks:this.tracks})},n.onBufferAppending=function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())},n.onBufferEos=function(e){for(var t in this.sourceBuffer)if(!e.type||e.type===t){var r=this.sourceBuffer[t];r&&!r.ended&&(r.ended=!0,z.logger.log(t+" sourceBuffer now EOS"))}this.checkEos()},n.checkEos=function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var i=e[r];if(i){if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}}z.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){z.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},n.onBufferFlushing=function(e){e.type?this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}):(this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"video"}),this.flushRange.push({start:e.startOffset,end:e.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},n.flushLiveBackBuffer=function(){if(this._live){var e=this.config.liveBackBufferLength;if(isFinite(e)&&!(e<0))if(this.media)for(var t=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),n=t-Math.max(e,this._levelTargetDuration),a=i.length-1;0<=a;a--){var s=i[a],o=r[s];if(o){var l=o.buffered;0<l.length&&n>l.start(0)&&this.removeBufferRange(s,o,0,n)&&this.hls.trigger(P.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n})}}else z.logger.error("flushLiveBackBuffer called without attaching media")}},n.onLevelUpdated=function(e){var t=e.details;0<t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},n.updateMediaElementDuration=function(){var e,t=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var i=this.sourceBuffer[r];if(i&&!0===i.updating)return}e=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===t.liveDurationInfinity?(z.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>e||!Object(j.isFiniteNumber)(e))&&(z.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},n.doFlush=function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var i in r){var n=r[i];n&&(t+=n.buffered.length)}}catch(e){z.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(P.default.BUFFER_FLUSHED)}},n.doAppending=function(){var t=this.config,r=this.hls,i=this.segments,e=this.sourceBuffer;if(Object.keys(e).length){if(!this.media||this.media.error)return this.segments=[],void z.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var n=i.shift();if(n)try{var a=e[n.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void i.unshift(n);a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0}catch(e){z.logger.error("error while trying to append buffer:"+e.message),i.unshift(n);var s={type:y.ErrorTypes.MEDIA_ERROR,parent:n.parent,details:"",fatal:!1};22===e.code?(this.segments=[],s.details=y.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,s.details=y.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>t.appendErrorMaxRetry&&(z.logger.log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],s.fatal=!0)),r.trigger(P.default.ERROR,s)}}}},n.flushBuffer=function(e,t,r){var i=this.sourceBuffer;if(!Object.keys(i).length)return!0;var n="null";if(this.media&&(n=this.media.currentTime.toFixed(3)),z.logger.log("flushBuffer,pos/start/end: "+n+"/"+e+"/"+t),this.flushBufferCounter>=this.appended)return z.logger.warn("abort flushing too many retries"),!0;var a=i[r];if(a){if(a.ended=!1,a.updating)return z.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,a,e,t))return this.flushBufferCounter++,!1}return z.logger.log("buffer flushed"),!0},n.removeBufferRange=function(e,t,r,i){try{for(var n=0;n<t.buffered.length;n++){var a=t.buffered.start(n),s=t.buffered.end(n),o=Math.max(a,r),l=Math.min(s,i);if(.5<Math.min(l,s)-o){var u="null";return this.media&&(u=this.media.currentTime.toString()),z.logger.log("sb remove "+e+" ["+o+","+l+"], of ["+a+","+s+"], pos:"+u),t.remove(o,l),!0}}}catch(e){z.logger.warn("removeBufferRange failed",e)}return!1},i}(u);function Ke(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ze=function(r){var e,t;function n(e){var t;return(t=r.call(this,e,P.default.FPS_DROP_LEVEL_CAPPING,P.default.MEDIA_ATTACHING,P.default.MANIFEST_PARSED,P.default.LEVELS_UPDATED,P.default.BUFFER_CODECS,P.default.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,t.firstLevel=null,t.levels=[],t.media=null,t.restrictedLevels=[],t.timer=null,t.clientRect=null,t}t=r,(e=n).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var i,a,s,o=n.prototype;return o.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},o.onFpsDropLevelCapping=function(e){n.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)},o.onMediaAttaching=function(e){this.media=e.media instanceof window.HTMLVideoElement?e.media:null},o.onManifestParsed=function(e){var t=this.hls;this.restrictedLevels=[],this.levels=e.levels,this.firstLevel=e.firstLevel,t.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onBufferCodecs=function(e){this.hls.config.capLevelToPlayerSize&&e.video&&this.startCapping()},o.onLevelsUpdated=function(e){this.levels=e.levels},o.onMediaDetaching=function(){this.stopCapping()},o.detectPlayerSize=function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},o.getMaxLevel=function(r){var i=this;if(!this.levels)return-1;var e=this.levels.filter(function(e,t){return n.isLevelAllowed(t,i.restrictedLevels)&&t<=r});return this.clientRect=null,n.getMaxLevelByMediaSize(e,this.mediaWidth,this.mediaHeight)},o.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},o.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},o.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t},n.isLevelAllowed=function(e,t){return void 0===t&&(t=[]),-1===t.indexOf(e)},n.getMaxLevelByMediaSize=function(e,t,r){if(!e||e&&!e.length)return-1;for(var i,n,a=e.length-1,s=0;s<e.length;s+=1){var o=e[s];if((o.width>=t||o.height>=r)&&(i=o,!(n=e[s+1])||i.width!==n.width||i.height!==n.height)){a=s;break}}return a},i=n,s=[{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}],(a=[{key:"mediaWidth",get:function(){return this.getDimensions().width*n.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*n.contentScaleFactor}}])&&Ke(i.prototype,a),s&&Ke(i,s),n}(u);var Xe=window.performance,Je=function(t){var e,r;function i(e){return t.call(this,e,P.default.MEDIA_ATTACHING)||this}r=t,(e=i).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var n=i.prototype;return n.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},n.onMediaAttaching=function(e){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=e.media instanceof window.HTMLVideoElement?e.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},n.checkFPS=function(e,t,r){var i=Xe.now();if(t){if(this.lastTime){var n=i-this.lastTime,a=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,o=1e3*a/n,l=this.hls;if(l.trigger(P.default.FPS_DROP,{currentDropped:a,currentDecoded:s,totalDroppedFrames:r}),0<o&&a>l.config.fpsDroppedMonitoringThreshold*s){var u=l.currentLevel;z.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),0<u&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(--u,l.trigger(P.default.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,l.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},n.checkFPSInterval=function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},i}(u),qe=function(){function e(e){e&&e.xhrSetup&&(this.xhrSetup=e.xhrSetup)}var t=e.prototype;return t.destroy=function(){this.abort(),this.loader=null},t.abort=function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},t.load=function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()},t.loadInternal=function(){var t,r=this.context;t=this.loader=new window.XMLHttpRequest;var e=this.stats;e.tfirst=0,e.loaded=0;var i=this.xhrSetup;try{if(i)try{i(t,r.url)}catch(e){t.open("GET",r.url,!0),i(t,r.url)}t.readyState||t.open("GET",r.url,!0)}catch(e){return void this.callbacks.onError({code:t.status,text:e.message},r,t)}r.rangeEnd&&t.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=r.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},t.readystatechange=function(e){var t=e.currentTarget,r=t.readyState,i=this.stats,n=this.context,a=this.config;if(!i.aborted&&2<=r)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(window.performance.now(),i.trequest)),4===r){var s=t.status;if(200<=s&&s<300){var o,l;i.tload=Math.max(i.tfirst,window.performance.now()),l="arraybuffer"===n.responseType?(o=t.response).byteLength:(o=t.responseText).length,i.loaded=i.total=l;var u={url:t.responseURL,data:o};this.callbacks.onSuccess(u,i,n,t)}else i.retry>=a.maxRetry||400<=s&&s<499?(z.logger.error(s+" while loading "+n.url),this.callbacks.onError({code:s,text:t.statusText},n,t)):(z.logger.warn(s+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},t.loadtimeout=function(){z.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},t.loadprogress=function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,t)},e}();function et(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var tt=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.MANIFEST_LOADING,P.default.MANIFEST_PARSED,P.default.AUDIO_TRACK_LOADED,P.default.AUDIO_TRACK_SWITCHED,P.default.LEVEL_LOADED,P.default.ERROR)||this)._trackId=-1,t._selectDefaultTrack=!0,t.tracks=[],t.trackIdBlacklist=Object.create(null),t.audioGroupId=null,t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n,a,s,o=i.prototype;return o.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},o.onManifestParsed=function(e){var t=this.tracks=e.audioTracks||[];this.hls.trigger(P.default.AUDIO_TRACKS_UPDATED,{audioTracks:t}),this._selectAudioGroup(this.hls.nextLoadLevel)},o.onAudioTrackLoaded=function(e){if(e.id>=this.tracks.length)z.logger.warn("Invalid audio track id:",e.id);else{if(z.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.hasInterval()){var t=1e3*e.details.targetduration;this.setInterval(t)}!e.details.live&&this.hasInterval()&&this.clearInterval()}},o.onAudioTrackSwitched=function(e){var t=this.tracks[e.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},o.onLevelLoaded=function(e){this._selectAudioGroup(e.level)},o.onError=function(e){e.type===y.ErrorTypes.NETWORK_ERROR&&(e.fatal&&this.clearInterval(),e.details===y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(z.logger.warn("Network failure on audio-track id:",e.context.id),this._handleLoadError()))},o._setAudioTrack=function(e){if(this._trackId===e&&this.tracks[this._trackId].details)z.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(e<0||e>=this.tracks.length)z.logger.warn("Invalid id passed to audio-track controller");else{var t=this.tracks[e];z.logger.log("Now switching to audio-track index "+e),this.clearInterval(),this._trackId=e;var r=t.url,i=t.type,n=t.id;this.hls.trigger(P.default.AUDIO_TRACK_SWITCHING,{id:n,type:i,url:r}),this._loadTrackDetailsIfNeeded(t)}},o.doTick=function(){this._updateTrack(this._trackId)},o._selectAudioGroup=function(e){var t=this.hls.levels[e];if(t&&t.audioGroupIds){var r=t.audioGroupIds[t.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},o._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var n=e.filter(function(e){return e.default});n.length?e=n:z.logger.warn("No default audio tracks defined")}var a=!1,s=function(){e.forEach(function(e){a||t.audioGroupId&&e.groupId!==t.audioGroupId||i&&i!==e.name||(t._setAudioTrack(e.id),a=!0)})};s(),a||(i=null,s()),a||(z.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},o._needsTrackLoading=function(e){var t=e.details,r=e.url;return!(t&&!t.live)&&!!r},o._loadTrackDetailsIfNeeded=function(e){if(this._needsTrackLoading(e)){var t=e.url,r=e.id;z.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(P.default.AUDIO_TRACK_LOADING,{url:t,id:r})}},o._updateTrack=function(e){if(!(e<0||e>=this.tracks.length)){this.clearInterval(),this._trackId=e,z.logger.log("trying to update audio-track "+e);var t=this.tracks[e];this._loadTrackDetailsIfNeeded(t)}},o._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var e=this._trackId,t=this.tracks[e],r=t.name,i=t.language,n=t.groupId;z.logger.warn("Loading failed on audio track id: "+e+", group-id: "+n+', name/language: "'+r+'" / "'+i+'"');for(var a=e,s=0;s<this.tracks.length;s++){if(!this.trackIdBlacklist[s])if(this.tracks[s].name===r){a=s;break}}a!==e?(z.logger.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):z.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},n=i,(a=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(e){this._setAudioTrack(e),this._selectDefaultTrack=!1}}])&&et(n.prototype,a),s&&et(n,s),i}(me);function rt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function it(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}}var nt=window.performance,at=function(i){var e,t;function r(e,t){var r;return(r=i.call(this,e,P.default.MEDIA_ATTACHED,P.default.MEDIA_DETACHING,P.default.AUDIO_TRACKS_UPDATED,P.default.AUDIO_TRACK_SWITCHING,P.default.AUDIO_TRACK_LOADED,P.default.KEY_LOADED,P.default.FRAG_LOADED,P.default.FRAG_PARSING_INIT_SEGMENT,P.default.FRAG_PARSING_DATA,P.default.FRAG_PARSED,P.default.ERROR,P.default.BUFFER_RESET,P.default.BUFFER_CREATED,P.default.BUFFER_APPENDED,P.default.BUFFER_FLUSHED,P.default.INIT_PTS_FOUND)||this).fragmentTracker=t,r.config=e.config,r.audioCodecSwap=!1,r._state=ye,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r}t=i,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n,a,s,o=r.prototype;return o.onInitPtsFound=function(e){var t=e.id,r=e.frag.cc,i=e.initPTS;"main"===t&&(this.initPTS[r]=i,this.videoTrackCC=r,z.logger.log("InitPTS for cc: "+r+" found from video track: "+i),this.state===Le&&this.tick())},o.startLoad=function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),(this.fragLoadError=0)<t&&-1===e?(z.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=be):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=ve),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=ye},o.doTick=function(){var e,t,r,i,n,a=this.hls,s=a.config;switch(this.state){case Ce:case Se:case we:break;case ve:this.state=Me,this.loadedmetadata=!1;break;case be:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!s.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var l=this.mediaBuffer?this.mediaBuffer:this.media,u=this.videoBuffer?this.videoBuffer:this.media,c=e<s.maxBufferHole?Math.max(2,s.maxBufferHole):s.maxBufferHole,d=H.bufferInfo(l,e,c),f=H.bufferInfo(u,e,c),h=d.len,p=d.end,g=this.fragPrevious,m=Math.min(s.maxBufferLength,s.maxMaxBufferLength),y=Math.max(m,f.len),v=this.audioSwitch,b=this.trackId;if((h<y||v)&&b<o.length){if(void 0===(r=o[b].details)){this.state=Me;break}if(!v&&this._streamEnded(d,r))return this.hls.trigger(P.default.BUFFER_EOS,{type:"audio"}),void(this.state=Ee);var S,T=r.fragments,_=T.length,I=T[0].start,M=T[_-1].start+T[_-1].duration;if(v)if(r.live&&!r.PTSKnown)z.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),p=0;else if(p=e,r.PTSKnown&&e<I){if(!(d.end>I||d.nextStart))return;z.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=I+.05}if(r.initSegment&&!r.initSegment.data)S=r.initSegment;else if(p<=I){if(S=T[0],null!==this.videoTrackCC&&S.cc!==this.videoTrackCC&&(i=T,n=this.videoTrackCC,S=W.search(i,function(e){return e.cc<n?1:e.cc>n?-1:0})),r.live&&S.loadIdx&&S.loadIdx===this.fragLoadIdx){var A=d.nextStart?d.nextStart:I;return z.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var D,w=s.maxFragLookUpTolerance,E=g?T[g.sn-T[0].sn+1]:void 0,C=function(e){var t=Math.min(w,e.duration);return e.start+e.duration-t<=p?1:e.start-t>p&&e.start?-1:0};(D=p<M?(M-w<p&&(w=0),E&&!C(E)?E:W.search(T,C)):T[_-1])&&(I=(S=D).start,g&&S.level===g.level&&S.sn===g.sn&&(S.sn<r.endSN?(S=T[S.sn+1-r.startSN],z.logger.log("SN just loaded, load next one: "+S.sn)):S=null))}S&&(S.encrypted?(z.logger.log("Loading key for "+S.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+b),this.state=Te,a.trigger(P.default.KEY_LOADING,{frag:S})):(this.fragCurrent=S,!v&&this.fragmentTracker.getState(S)!==U||(z.logger.log("Loading "+S.sn+", cc: "+S.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+b+", currentTime:"+e+",bufferEnd:"+p.toFixed(3)),"initSegment"!==S.sn&&(this.startFragRequested=!0),Object(j.isFiniteNumber)(S.sn)&&(this.nextLoadPosition=S.start+S.duration),a.trigger(P.default.FRAG_LOADING,{frag:S}),this.state=_e)))}break;case Me:(t=this.tracks[this.trackId])&&t.details&&(this.state=be);break;case Ie:var L=nt.now(),O=this.retryDate,N=(l=this.media)&&l.seeking;(!O||O<=L||N)&&(z.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=be);break;case Le:var k=this.videoTrackCC;if(void 0===this.initPTS[k])break;var x=this.waitingFragment;if(x){var R=x.frag.cc;k!==R?(t=this.tracks[this.trackId]).details&&t.details.live&&(z.logger.warn("Waiting fragment CC ("+R+") does not match video track CC ("+k+")"),this.waitingFragment=null,this.state=be):(this.state=_e,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=be}},o.onMediaAttached=function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},o.onMediaDetaching=function(){var e=this.media;e&&e.ended&&(z.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},o.onAudioTracksUpdated=function(e){z.logger.log("audio tracks updated"),this.tracks=e.audioTracks},o.onAudioTrackSwitching=function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=Se,this.waitingFragment=null,t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=be),this.tick()},o.onAudioTrackLoaded=function(e){var t=e.details,r=e.id,i=this.tracks[r],n=t.totalduration,a=0;if(z.logger.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+n),t.live){var s=i.details;s&&0<t.fragments.length?(ae(s,t),a=t.fragments[0].start,t.PTSKnown?z.logger.log("live audio playlist sliding:"+a.toFixed(3)):z.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,z.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(i.details=t,!this.startFragRequested){if(-1===this.startPosition){var o=t.startTimeOffset;Object(j.isFiniteNumber)(o)?(z.logger.log("start time offset found in playlist, adjust startPosition to "+o),this.startPosition=o):t.live?(this.startPosition=this.computeLivePosition(a,t),z.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===Me&&(this.state=be),this.tick()},o.onKeyLoaded=function(){this.state===Te&&(this.state=be,this.tick())},o.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag;if(this.state===_e&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var i=this.tracks[this.trackId],n=i.details,a=n.totalduration,s=t.level,o=t.sn,l=t.cc,u=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",c=this.stats=e.stats;if("initSegment"===o)this.state=be,c.tparsed=c.tbuffered=nt.now(),n.initSegment.data=e.payload,this.hls.trigger(P.default.FRAG_BUFFERED,{stats:c,frag:t,id:"audio"}),this.tick();else{this.state=Ae,this.appended=!1,this.demuxer||(this.demuxer=new te(this.hls,"audio"));var d=this.initPTS[l],f=n.initSegment?n.initSegment.data:[];if(n.initSegment||void 0!==d){this.pendingBuffering=!0,z.logger.log("Demuxing "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s);this.demuxer.push(e.payload,f,u,null,t,a,!1,d)}else z.logger.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+o+" of ["+n.startSN+" ,"+n.endSN+"],track "+s),this.waitingFragment=e,this.state=Le}}this.fragLoadError=0},o.onFragParsingInitSegment=function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ae){var i,n=e.tracks;if(n.video&&delete n.video,i=n.audio){i.levelCodec=i.codec,i.id=e.id,this.hls.trigger(P.default.BUFFER_CODECS,n),z.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var a=i.initSegment;if(a){var s={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(P.default.BUFFER_APPENDING,s))}this.tick()}}},o.onFragParsingData=function(t){var r=this,e=this.fragCurrent,i=t.frag;if(e&&"audio"===t.id&&"audio"===t.type&&i.sn===e.sn&&i.level===e.level&&this.state===Ae){var n=this.trackId,a=this.tracks[n],s=this.hls;Object(j.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),e.addElementaryStream(f.AUDIO),z.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),ne(a.details,e,t.startPTS,t.endPTS);var o=this.audioSwitch,l=this.media,u=!1;if(o)if(l&&l.readyState){var c=l.currentTime;z.logger.log("switching audio track : currentTime:"+c),c>=t.startPTS&&(z.logger.log("switching audio track : flushing all audio"),this.state=we,s.trigger(P.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,this.audioSwitch=!1,s.trigger(P.default.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,s.trigger(P.default.AUDIO_TRACK_SWITCHED,{id:n});var d=this.pendingData;if(!d)return z.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(P.default.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&d.push({type:t.type,data:e,parent:"audio",content:"data"})}),!u&&d.length&&(d.forEach(function(e){r.state===Ae&&(r.pendingBuffering=!0,r.hls.trigger(P.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}},o.onFragParsed=function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===Ae&&(this.stats.tparsed=nt.now(),this.state=De,this._checkAppendedParsed())},o.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},o.onBufferCreated=function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0),e.tracks.video&&(this.videoBuffer=e.tracks.video.buffer)},o.onBufferAppended=function(e){if("audio"===e.parent){var t=this.state;t!==Ae&&t!==De||(this.pendingBuffering=0<e.pending,this._checkAppendedParsed())}},o._checkAppendedParsed=function(){if(!(this.state!==De||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=nt.now(),r.trigger(P.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;i&&z.logger.log("audio buffered : "+le.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(P.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=be}this.tick()}},o.onError=function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:var r=e.frag;if(r&&"audio"!==r.type)break;if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i;var a=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);z.logger.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=nt.now()+a,this.state=Ie}else z.logger.error("AudioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=Ce}break;case y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case y.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==Ce&&(this.state=e.fatal?Ce:be,z.logger.warn("AudioStreamController: "+e.details+" while loading frag, now switching to "+this.state+" state ..."));break;case y.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===Ae||this.state===De)){var s=this.mediaBuffer,o=this.media.currentTime;if(s&&H.isBuffered(s,o)&&H.isBuffered(s,o+.5)){var l=this.config;l.maxMaxBufferLength>=l.maxBufferLength&&(l.maxMaxBufferLength/=2,z.logger.warn("AudioStreamController: reduce max buffer length to "+l.maxMaxBufferLength+"s")),this.state=be}else z.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=we,this.hls.trigger(P.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},o.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(z.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach(function(e){t.hls.trigger(P.default.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=De):(this.state=be,this.fragPrevious=null,this.tick())},n=r,(a=[{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,z.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}])&&rt(n.prototype,a),s&&rt(n,s),r}(Ne),st=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var b={"":!0,lr:!0,rl:!0},t={start:!0,middle:!0,end:!0,left:!0,right:!0};function S(e){return"string"==typeof e&&(!!t[e.toLowerCase()]&&e.toLowerCase())}function T(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)e[i]=r[i]}return e}function e(e,t,r){var i=this,n={enumerable:!0};i.hasBeenReset=!1;var a="",s=!1,o=e,l=t,u=r,c=null,d="",f=!0,h="auto",p="start",g=50,m="middle",y=50,v="middle";Object.defineProperty(i,"id",T({},n,{get:function(){return a},set:function(e){a=""+e}})),Object.defineProperty(i,"pauseOnExit",T({},n,{get:function(){return s},set:function(e){s=!!e}})),Object.defineProperty(i,"startTime",T({},n,{get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");o=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"endTime",T({},n,{get:function(){return l},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");l=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"text",T({},n,{get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}})),Object.defineProperty(i,"region",T({},n,{get:function(){return c},set:function(e){c=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"vertical",T({},n,{get:function(){return d},set:function(e){var t,r="string"==typeof(t=e)&&!!b[t.toLowerCase()]&&t.toLowerCase();if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");d=r,this.hasBeenReset=!0}})),Object.defineProperty(i,"snapToLines",T({},n,{get:function(){return f},set:function(e){f=!!e,this.hasBeenReset=!0}})),Object.defineProperty(i,"line",T({},n,{get:function(){return h},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"lineAlign",T({},n,{get:function(){return p},set:function(e){var t=S(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"position",T({},n,{get:function(){return g},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"positionAlign",T({},n,{get:function(){return m},set:function(e){var t=S(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(i,"size",T({},n,{get:function(){return y},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(i,"align",T({},n,{get:function(){return v},set:function(e){var t=S(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),i.displayState=void 0}return e.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},e}();function ot(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new it,this.regionList=[]}function lt(){this.values=Object.create(null)}function ut(e,t,r,i){var n=i?e.split(i):[e];for(var a in n)if("string"==typeof n[a]){var s=n[a].split(r);if(2===s.length)t(s[0],s[1])}}lt.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var ct=new st(0,0,0),dt="middle"===ct.align?"middle":"center";function ft(i,e,s){var n=i;function t(){var e,t=(e=i.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/))?e[3]?r(e[1],e[2],e[3].replace(":",""),e[4]):59<e[1]?r(e[1],e[2],0,e[4]):r(0,e[1],e[2],e[4]):null;function r(e,t,r,i){return 3600*(0|e)+60*(0|t)+(0|r)+(0|i)/1e3}if(null===t)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),t}function r(){i=i.replace(/^\s+/,"")}if(r(),e.startTime=t(),r(),"--\x3e"!==i.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);i=i.substr(3),r(),e.endTime=t(),r(),function(e,t){var a=new lt;ut(e,function(e,t){switch(e){case"region":for(var r=s.length-1;0<=r;r--)if(s[r].id===t){a.set(e,s[r].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var i=t.split(","),n=i[0];a.integer(e,n),a.percent(e,n)&&a.set("snapToLines",!1),a.alt(e,n,["auto"]),2===i.length&&a.alt("lineAlign",i[1],["start",dt,"end"]);break;case"position":i=t.split(","),a.percent(e,i[0]),2===i.length&&a.alt("positionAlign",i[1],["start",dt,"end","line-left","line-right","auto"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start",dt,"end","left","right"])}},/:/,/\s/),t.region=a.get("region",null),t.vertical=a.get("vertical","");var r=a.get("line","auto");"auto"===r&&-1===ct.line&&(r=-1),t.line=r,t.lineAlign=a.get("lineAlign","start"),t.snapToLines=a.get("snapToLines",!0),t.size=a.get("size",100),t.align=a.get("align",dt);var i=a.get("position","auto");"auto"===i&&50===ct.position&&(i="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=i}(i,e)}function ht(e){return e.replace(/<br(?: \/)?>/gi,"\n")}ot.prototype={parse:function(e){var i=this;function t(){var e=i.buffer,t=0;for(e=ht(e);t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var r=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,i.buffer=e.substr(t),r}e&&(i.buffer+=i.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===i.state){if(!/\r\n|\n/.test(i.buffer))return this;var n=(r=t()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");i.state="HEADER"}for(var a=!1;i.buffer;){if(!/\r\n|\n/.test(i.buffer))return this;switch(a?a=!1:r=t(),i.state){case"HEADER":/:/.test(r)?ut(r,function(e,t){},/:/):r||(i.state="ID");continue;case"NOTE":r||(i.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){i.state="NOTE";break}if(!r)continue;if(i.cue=new st(0,0,""),i.state="CUE",-1===r.indexOf("--\x3e")){i.cue.id=r;continue}case"CUE":try{ft(r,i.cue,i.regionList)}catch(e){i.cue=null,i.state="BADCUE";continue}i.state="CUETEXT";continue;case"CUETEXT":var s=-1!==r.indexOf("--\x3e");if(!r||s&&(a=!0)){i.oncue&&i.oncue(i.cue),i.cue=null,i.state="ID";continue}i.cue.text&&(i.cue.text+="\n"),i.cue.text+=r;continue;case"BADCUE":r||(i.state="ID");continue}}}catch(e){"CUETEXT"===i.state&&i.cue&&i.oncue&&i.oncue(i.cue),i.cue=null,i.state="INITIAL"===i.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&"HEADER"!==this.state||(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}};var pt=ot;function gt(e,t,r,i){for(var n,a,s,o,l,u=[],c=window.VTTCue||TextTrackCue,d=0;d<i.rows.length;d++)if(s=!0,o=0,l="",!(n=i.rows[d]).isEmpty()){for(var f=0;f<n.chars.length;f++)n.chars[f].uchar.match(/\s/)&&s?o++:(l+=n.chars[f].uchar,s=!1);(n.cueStartTime=t)===r&&(r+=1e-4),a=new c(t,r,ht(l.trim())),16<=o?o--:o++,navigator.userAgent.match(/Firefox\//)?a.line=d+1:a.line=7<d?d-2:d+1,a.align="left",a.position=Math.max(0,Math.min(100,o/32*100)),u.push(a),e&&e.addCue(a)}return u}function mt(e){var t=e;return bt.hasOwnProperty(e)&&(t=bt[e]),String.fromCharCode(t)}var yt,vt,bt={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},St={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Tt={17:2,18:4,21:6,22:8,23:10,19:13,20:15},_t={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},It={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Mt=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(vt=yt=yt||{})[vt.ERROR=0]="ERROR",vt[vt.TEXT=1]="TEXT",vt[vt.WARNING=2]="WARNING",vt[vt.INFO=2]="INFO",vt[vt.DEBUG=3]="DEBUG",vt[vt.DATA=3]="DATA";function At(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t}var Dt={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&console.log(this.time+" ["+e+"] "+t)}},wt=function(){function e(e,t,r,i,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=i||"black",this.flash=n||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Et=function(){function e(e,t,r,i,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new wt(t,r,i,n,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),Ct=function(){function e(){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.chars=[];for(var e=0;e<100;e++)this.chars.push(new Et);this.pos=0,this.currPenState=new wt}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<100;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<100;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(Dt.log("DEBUG","Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(Dt.log("DEBUG","Too large cursor position "+this.pos),this.pos=100)},t.moveCursor=function(e){var t=this.pos+e;if(1<e)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){144<=e&&this.backSpace();var t=mt(e);100<=this.pos?Dt.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<100;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<100;r++){var i=this.chars[r].uchar;" "!==i&&(t=!1),e.push(i)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Lt=function(){function e(){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.rows=[];for(var e=0;e<15;e++)this.rows.push(new Ct);this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},t.equals=function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){Dt.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){Dt.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[i].cueStartTime;if(a&&Dt.time&&a<Dt.time)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(n.rows[i+s])}}this.currRow=t;var o=this.rows[this.currRow];if(null!==e.indent){var l=e.indent,u=Math.max(l-1,0);o.setCursor(e.indent),e.color=o.chars[u].penState.foreground}var c={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(c)},t.setBkgData=function(e){Dt.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){if(null!==this.nrRollUpRows){Dt.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),Dt.log("INFO","Rolling up")}else Dt.log("DEBUG","roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",i=-1,n=0;n<15;n++){var a=this.rows[n].getTextString();a&&(i=n+1,e?t.push("Row "+i+": '"+a+"'"):t.push(a.trim()))}return 0<t.length&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),Ot=function(){function e(e,t){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.lastCueEndTime=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Lt,this.nonDisplayedMemory=new Lt,this.lastOutputScreen=new Lt,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,Dt.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";Dt.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(Dt.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},t.ccRCL=function(){Dt.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){Dt.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){Dt.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){Dt.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){Dt.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){Dt.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){Dt.log("INFO","TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){Dt.log("INFO","RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){Dt.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){Dt.log("INFO","CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){Dt.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){if(Dt.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,Dt.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},t.ccTO=function(e){Dt.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=46<=e,t.italics)t.foreground="white";else{t.foreground=["white","green","blue","cyan","red","yellow","magenta"][Math.floor(e/2)-16]}Dt.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=Dt.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}();function Nt(e,t,r){r&&(r.a=e,r.b=t)}function kt(e,t,r){return r&&(r.a===e&&r.b===t)}function xt(){return{1:{a:null,b:null},3:{a:null,b:null}}}function Rt(e,t,r){return e.substr(r||0,t.length)===t}function jt(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()}var Pt=function(){function e(e,t,r,i){this.outputs=void 0,this.channels=void 0,this.currChNr=0,this.cmdHistory=void 0,this.outputs=[e,t],this.channels=[null,new Ot(1,e),new Ot(2,t),new Ot(3,r),new Ot(4,i)],this.cmdHistory=xt()}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t,r){var i,n,a,s=!1;Dt.setTime(e);for(var o=0;o<t.length;o+=2)if(n=127&t[o],a=127&t[o+1],0!=n||0!=a){if(Dt.log("DATA","["+At([t[o],t[o+1]])+"] -> ("+At([n,a])+")"),!(i=(i=(i=(i=this.parseCmd(n,a,r))||this.parseMidrow(n,a,r))||this.parsePAC(n,a,r))||this.parseBackgroundAttributes(n,a,r))&&(s=this.parseChars(n,a,r))){var l=this.currChNr;if(l&&0<l)if(3===r&&2<l||1===r&&l<3)this.channels[l].insertChars(s);else Dt.log("WARNING","The last seen channel number does not fall within the current field. Deferring character insertion until the field and channel match.");else Dt.log("WARNING","No channel found yet. TEXT-MODE?")}i||s||Dt.log("WARNING","Couldn't parse cleaned data "+At([n,a])+" orig: "+At([t[o],t[o+1]]))}},t.parseCmd=function(e,t,r){var i,n=this.cmdHistory,a=function(e){{if(20===e)return 1;if(28===e)return 2;if(21===e)return 3;if(29===e)return 4}return 0}(e),s=function(e,t){var r=null;23===e?r=t:31===e&&(r=t+1);return r}(t,r);return!!(a&&32<=t&&t<=47||s&&33<=t&&t<=35)&&(kt(e,t,n[r])?(Nt(null,null,n[r]),Dt.log("DEBUG","Repeated command ("+At([e,t])+") is dropped")):(a?(i=this.channels[a],32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC()):(i=this.channels[s]).ccTO(t-32),Nt(e,t,n[r]),this.currChNr=a),!0)},t.parseMidrow=function(e,t,r){var i=0;if((17===e||25===e)&&32<=t&&t<=47){if((i=17===e?r:r+1)!==this.currChNr)return Dt.log("ERROR","Mismatch channel in midrow parsing"),!1;var n=this.channels[i];return n?(n.ccMIDROW(t),Dt.log("DEBUG","MIDROW ("+At([e,t])+")"),!0):!1}return!1},t.parsePAC=function(e,t,r){var i,n,a=0,s=this.cmdHistory;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;if(kt(e,t,s[r]))return Nt(null,null,s[r]),!0;a=e<=23?(n=1,r):(n=2,r+1),i=64<=t&&t<=95?1===n?St[e]:_t[e]:1===n?Tt[e]:It[e];var o=this.channels[a];return!!o&&(o.setPAC(this.interpretPAC(i,t)),Nt(e,t,s[r]),this.currChNr=a,!0)},t.interpretPAC=function(e,t){var r=t,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=95<t?t-96:t-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},t.parseChars=function(e,t,r){var i=null,n=null,a=null;if(17<=(a=25<=e?(i=2,e-8):(i=1,e))&&a<=19){var s=t;s=17===a?t+80:18===a?t+112:t+144,Dt.log("INFO","Special char '"+mt(s)+"' in channel "+i),n=[s]}else 32<=e&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var o=At(n);Dt.log("DEBUG","Char codes =  "+o.join(",")),Nt(e,t,this.cmdHistory[r])}return n},t.parseBackgroundAttributes=function(e,t,r){var i;if(!((16===e||24===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&45<=t&&t<=47))return!1;var n={};16===e||24===e?(i=Math.floor((t-32)/2),n.background=Mt[i],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));var a=e<24?r:r+1;return this.channels[a].setBkgData(n),Nt(e,t,this.cmdHistory[r]),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory=xt()},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}(),zt=function(){function e(e,t){this.timelineController=void 0,this.trackName=void 0,this.startTime=void 0,this.endTime=void 0,this.screen=void 0,this.timelineController=e,this.trackName=t,this.startTime=null,this.endTime=null,this.screen=null}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e}(),Ft={parse:function(e,t,i,n,r,a){var s,o=Object(ze.utf8ArrayToStr)(new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),l="00:00.000",u=0,c=0,d=0,f=[],h=!0,p=!1,g=new pt;g.oncue=function(e){var t=i[n],r=i.ccOffset;t&&t.new&&(void 0!==c?r=i.ccOffset=t.start:function(e,t,r){var i=e[t],n=e[i.prevCC];if(!n||!n.new&&i.new)return e.ccOffset=e.presentationOffset=i.start,i.new=!1;for(;n&&n.new;)e.ccOffset+=i.start-n.start,i.new=!1,n=e[(i=n).prevCC];e.presentationOffset=r}(i,n,d)),d&&(r=d-i.presentationOffset),p&&(e.startTime+=r-c,e.endTime+=r-c),e.id=jt(e.startTime.toString())+jt(e.endTime.toString())+jt(e.text),e.text=decodeURIComponent(encodeURIComponent(e.text)),0<e.endTime&&f.push(e)},g.onparsingerror=function(e){s=e},g.onflush=function(){s&&a?a(s):r(f)},o.forEach(function(e){if(h){if(Rt(e,"X-TIMESTAMP-MAP=")){p=!(h=!1),e.substr(16).split(",").forEach(function(e){Rt(e,"LOCAL:")?l=e.substr(6):Rt(e,"MPEGTS:")&&(u=parseInt(e.substr(7)))});try{t+(9e4*i[n].start||0)<0&&(t+=8589934592),u-=t,c=function(e){var t=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),i=parseInt(e.substr(-9,2)),n=9<e.length?parseInt(e.substr(0,e.indexOf(":"))):0;if(!(Object(j.isFiniteNumber)(t)&&Object(j.isFiniteNumber)(r)&&Object(j.isFiniteNumber)(i)&&Object(j.isFiniteNumber)(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,t+=6e4*i,t+=36e5*n}(l)/1e3,d=u/9e4}catch(e){p=!1,s=e}return}""===e&&(h=!1)}g.parse(e+"\n")}),g.flush()}};function Ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bt(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}var Yt=function(s){var e,t;function r(e){var t;if((t=s.call(this,e,P.default.MEDIA_ATTACHING,P.default.MEDIA_DETACHING,P.default.FRAG_PARSING_USERDATA,P.default.FRAG_DECRYPTED,P.default.MANIFEST_LOADING,P.default.MANIFEST_LOADED,P.default.FRAG_LOADED,P.default.INIT_PTS_FOUND)||this).media=null,t.config=void 0,t.enabled=!0,t.Cues=void 0,t.textTracks=[],t.tracks=[],t.initPTS=[],t.unparsedVttFrags=[],t.cueRanges=[],t.captionsTracks={},t.nonNativeCaptionsTracks={},t.captionsProperties=void 0,t.cea608Parser=void 0,t.lastSn=-1,t.prevCC=-1,t.vttCCs=Bt(),t.hls=e,t.config=e.config,t.Cues=e.config.cueHandler,t.captionsProperties={textTrack1:{label:t.config.captionsTextTrack1Label,languageCode:t.config.captionsTextTrack1LanguageCode},textTrack2:{label:t.config.captionsTextTrack2Label,languageCode:t.config.captionsTextTrack2LanguageCode},textTrack3:{label:t.config.captionsTextTrack3Label,languageCode:t.config.captionsTextTrack3LanguageCode},textTrack4:{label:t.config.captionsTextTrack4Label,languageCode:t.config.captionsTextTrack4LanguageCode}},t.config.enableCEA708Captions){var r=new zt(Ut(t),"textTrack1"),i=new zt(Ut(t),"textTrack2"),n=new zt(Ut(t),"textTrack3"),a=new zt(Ut(t),"textTrack4");t.cea608Parser=new Pt(r,i,n,a)}return t}t=s,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var i=r.prototype;return i.addCues=function(e,t,r,i){for(var n,a,s,o,l=this.cueRanges,u=!1,c=l.length;c--;){var d=l[c],f=(n=d[0],a=d[1],s=t,o=r,Math.min(a,o)-Math.max(n,s));if(0<=f&&(d[0]=Math.min(d[0],t),d[1]=Math.max(d[1],r),u=!0,.5<f/(r-t)))return}if(u||l.push([t,r]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[e],t,r,i);else{var h=this.Cues.newCue(null,t,r,i);this.hls.trigger(P.default.CUES_PARSED,{type:"captions",cues:h,track:e})}},i.onInitPtsFound=function(e){var t=this,r=e.frag,i=e.id,n=e.initPTS,a=this.unparsedVttFrags;"main"===i&&(this.initPTS[r.cc]=n),a.length&&(this.unparsedVttFrags=[],a.forEach(function(e){t.onFragLoaded(e)}))},i.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var i=t.textTracks[r];if(i[e])return i}return null},i.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},i.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,i=this.media,n=t[e],a=n.label,s=n.languageCode,o=this.getExistingTrack(e);if(o)r[e]=o,Ue(r[e]),Fe(r[e],i);else{var l=this.createTextTrack("captions",a,s);l&&(l[e]=!0,r[e]=l)}}},i.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(P.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},i.createTextTrack=function(e,t,r){var i=this.media;if(i)return i.addTextTrack(e,t,r)},i.destroy=function(){s.prototype.destroy.call(this)},i.onMediaAttaching=function(e){this.media=e.media,this._cleanTracks()},i.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){Ue(t[e]),delete t[e]}),this.nonNativeCaptionsTracks={}},i.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=Bt(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},i._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Ue(t[r])}},i.onManifestLoaded=function(e){var o=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT){var t=e.subtitles||[],r=this.tracks&&t&&this.tracks.length===t.length;if(this.tracks=e.subtitles||[],this.config.renderTextTracksNatively){var l=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,t){var r,i,n;if(t<l.length){for(var a=null,s=0;s<l.length;s++)if(i=l[s],n=e,i&&i.label===n.name&&!i.textTrack1&&!i.textTrack2){a=l[s];break}a&&(r=a)}r=r||o.createTextTrack("subtitles",e.name,e.lang),e.default?r.mode=o.hls.subtitleDisplay?"showing":"hidden":r.mode="disabled",o.textTracks.push(r)})}else if(!r&&this.tracks&&this.tracks.length){var i=this.tracks.map(function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}});this.hls.trigger(P.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:i})}}this.config.enableCEA708Captions&&e.captions&&e.captions.forEach(function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var r="textTrack"+t[1],i=o.captionsProperties[r];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}})},i.onFragLoaded=function(e){var t=e.frag,r=e.payload,i=this.cea608Parser,n=this.initPTS,a=this.lastSn,s=this.unparsedVttFrags;if("main"===t.type){var o=t.sn;t.sn!==a+1&&i&&i.reset(),this.lastSn=o}else if("subtitle"===t.type)if(r.byteLength){if(!Object(j.isFiniteNumber)(n[t.cc]))return s.push(e),void(n.length&&this.hls.trigger(P.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));var l=t.decryptdata;null!=l&&null!=l.key&&"AES-128"===l.method||this._parseVTTs(t,r)}else this.hls.trigger(P.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},i._parseVTTs=function(r,e){var n=this,a=this.hls,t=this.prevCC,s=this.textTracks,i=this.vttCCs;i[r.cc]||(i[r.cc]={start:r.start,prevCC:t,new:!0},this.prevCC=r.cc),Ft.parse(e,this.initPTS[r.cc],i,r.cc,function(e){if(n.config.renderTextTracksNatively){var i=s[r.level];if("disabled"===i.mode)return void a.trigger(P.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r});e.forEach(function(t){if(!i.cues.getCueById(t.id))try{if(i.addCue(t),!i.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(e){z.logger.debug("Failed occurred on adding cues: "+e);var r=new window.TextTrackCue(t.startTime,t.endTime,t.text);r.id=t.id,i.addCue(r)}})}else{var t=n.tracks[r.level].default?"default":"subtitles"+r.level;a.trigger(P.default.CUES_PARSED,{type:"subtitles",cues:e,track:t})}a.trigger(P.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},function(e){z.logger.log("Failed to parse VTT cue: "+e),a.trigger(P.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r})})},i.onFragDecrypted=function(e){var t=e.frag,r=e.payload;if("subtitle"===t.type){if(!Object(j.isFiniteNumber)(this.initPTS[t.cc]))return void this.unparsedVttFrags.push(e);this._parseVTTs(t,r)}},i.onFragParsingUserdata=function(e){if(this.enabled&&this.cea608Parser)for(var t=this.cea608Parser,r=0;r<e.samples.length;r++){var i=e.samples[r].bytes;if(i){var n=this.extractCea608Data(i);t.addData(e.samples[r].pts,n[0],1),t.addData(e.samples[r].pts,n[1],3)}}},i.extractCea608Data=function(e){for(var t=31&e[0],r=2,i=[[],[]],n=0;n<t;n++){var a=e[r++],s=127&e[r++],o=127&e[r++],l=3&a;0==s&&0==o||0!=(4&a)&&(0!=l&&1!=l||(i[l].push(s),i[l].push(o)))}return i},r}(u);function Gt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vt(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];"subtitles"===i.kind&&i.label&&t.push(e[r])}return t}var Wt=function(r){var e,t;function i(e){var t;return(t=r.call(this,e,P.default.MEDIA_ATTACHED,P.default.MEDIA_DETACHING,P.default.MANIFEST_LOADED,P.default.SUBTITLE_TRACK_LOADED)||this).tracks=[],t.trackId=-1,t.media=null,t.stopped=!0,t.subtitleDisplay=!0,t.queuedDefaultTrack=null,t}t=r,(e=i).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n,a,s,o=i.prototype;return o.destroy=function(){u.prototype.destroy.call(this)},o.onMediaAttached=function(e){var t=this;this.media=e.media,this.media&&(Object(j.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},o.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(j.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Vt(this.media.textTracks).forEach(function(e){Ue(e)}),this.subtitleTrack=-1,this.media=null)},o.onManifestLoaded=function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.hls.trigger(P.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e.default&&(t.media?t.subtitleTrack=e.id:t.queuedDefaultTrack=e.id)})},o.onSubtitleTrackLoaded=function(e){var t=this,r=e.id,i=e.details,n=this.trackId,a=this.tracks,s=a[n];if(r>=a.length||r!==n||!s||this.stopped)this._clearReloadTimer();else if(z.logger.log("subtitle track "+r+" loaded"),i.live){var o=oe(s.details,i,e.stats.trequest);z.logger.log("Reloading live subtitle playlist in "+o+"ms"),this.timer=setTimeout(function(){t._loadCurrentTrack()},o)}else this._clearReloadTimer()},o.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},o.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},o._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},o._loadCurrentTrack=function(){var e=this.trackId,t=this.tracks,r=this.hls,i=t[e];e<0||!i||i.details&&!i.details.live||(z.logger.log("Loading subtitle track "+e),r.trigger(P.default.SUBTITLE_TRACK_LOADING,{url:i.url,id:e}))},o._toggleTrackModes=function(e){var t=this.media,r=this.subtitleDisplay,i=this.trackId;if(t){var n=Vt(t.textTracks);if(-1===e)[].slice.call(n).forEach(function(e){e.mode="disabled"});else{var a=n[i];a&&(a.mode="disabled")}var s=n[e];s&&(s.mode=r?"showing":"hidden")}},o._setSubtitleTrackInternal=function(e){var t=this.hls,r=this.tracks;!Object(j.isFiniteNumber)(e)||e<-1||e>=r.length||(this.trackId=e,z.logger.log("Switching to subtitle track "+e),t.trigger(P.default.SUBTITLE_TRACK_SWITCH,{id:e}),this._loadCurrentTrack())},o._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=Vt(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack=e}},n=i,(a=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&(this._toggleTrackModes(e),this._setSubtitleTrackInternal(e))}}])&&Gt(n.prototype,a),s&&Gt(n,s),i}(u),Ht=r("./src/crypt/decrypter.js");var $t,Qt,Kt=window.performance,Zt=function(i){var e,t;function r(e,t){var r;return(r=i.call(this,e,P.default.MEDIA_ATTACHED,P.default.MEDIA_DETACHING,P.default.ERROR,P.default.KEY_LOADED,P.default.FRAG_LOADED,P.default.SUBTITLE_TRACKS_UPDATED,P.default.SUBTITLE_TRACK_SWITCH,P.default.SUBTITLE_TRACK_LOADED,P.default.SUBTITLE_FRAG_PROCESSED,P.default.LEVEL_UPDATED)||this).fragmentTracker=t,r.config=e.config,r.state=ye,r.tracks=[],r.tracksBuffered=[],r.currentTrackId=-1,r.decrypter=new Ht.default(e,e.config),r.lastAVStart=0,r._onMediaSeeking=r.onMediaSeeking.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}t=i,(e=r).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var n=r.prototype;return n.onSubtitleFragProcessed=function(e){var t=e.frag,r=e.success;if(this.fragPrevious=t,this.state=be,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var n,a=t.start,s=0;s<i.length;s++)if(a>=i[s].start&&a<=i[s].end){n=i[s];break}var o=t.start+t.duration;n?n.end=o:(n={start:a,end:o},i.push(n))}}},n.onMediaAttached=function(e){var t=e.media;(this.media=t).addEventListener("seeking",this._onMediaSeeking),this.state=be},n.onMediaDetaching=function(){var t=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]}),this.media=null,this.state=ye)},n.onError=function(e){var t=e.frag;t&&"subtitle"===t.type&&(this.state=be)},n.onSubtitleTracksUpdated=function(e){var t=this;z.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=e.subtitleTracks,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]})},n.onSubtitleTrackSwitch=function(e){if(this.currentTrackId=e.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},n.onSubtitleTrackLoaded=function(e){var t=e.id,r=e.details,i=this.currentTrackId,n=this.tracks,a=n[i];t>=n.length||t!==i||!a||(r.live&&function(e,t,r){void 0===r&&(r=0);var i=-1;se(e,t,function(e,t,r){t.start=e.start,i=r});var n=t.fragments;if(i<0)n.forEach(function(e){e.start+=r});else for(var a=i+1;a<n.length;a++)n[a].start=n[a-1].start+n[a-1].duration}(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},n.onKeyLoaded=function(){this.state===Te&&(this.state=be)},n.onFragLoaded=function(e){var t=this.fragCurrent,r=e.frag.decryptdata,i=e.frag,n=this.hls;if(this.state===_e&&t&&"subtitle"===e.frag.type&&t.sn===e.frag.sn&&0<e.payload.byteLength&&r&&r.key&&"AES-128"===r.method){var a=Kt.now();this.decrypter.decrypt(e.payload,r.key.buffer,r.iv.buffer,function(e){var t=Kt.now();n.trigger(P.default.FRAG_DECRYPTED,{frag:i,payload:e,stats:{tstart:a,tdecrypt:t}})})}},n.onLevelUpdated=function(e){var t=e.details.fragments;this.lastAVStart=t.length?t[0].start:0},n.doTick=function(){if(this.media)switch(this.state){case be:var e=this.config,t=this.currentTrackId,r=this.fragmentTracker,i=this.media,n=this.tracks;if(!n||!n[t]||!n[t].details)break;var a,s=e.maxBufferHole,o=e.maxFragLookUpTolerance,l=Math.min(e.maxBufferLength,e.maxMaxBufferLength),u=H.bufferedInfo(this._getBuffered(),i.currentTime,s),c=u.end,d=u.len,f=n[t].details,h=f.fragments,p=h.length,g=h[p-1].start+h[p-1].duration;if(l<d)return;var m=this.fragPrevious;(a=c<g?(m&&f.hasProgramDateTime&&(a=fe(h,m.endProgramDateTime,o)),a||he(m,h,c,o)):h[p-1])&&a.encrypted?(z.logger.log("Loading key for "+a.sn),this.state=Te,this.hls.trigger(P.default.KEY_LOADING,{frag:a})):a&&r.getState(a)===U&&(this.fragCurrent=a,this.state=_e,this.hls.trigger(P.default.FRAG_LOADING,{frag:a}))}else this.state=be},n.stopLoad=function(){this.lastAVStart=0,i.prototype.stopLoad.call(this)},n._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},n.onMediaSeeking=function(){this.fragPrevious=null},r}(Ne);(Qt=$t=$t||{}).WIDEVINE="com.widevine.alpha",Qt.PLAYREADY="com.microsoft.playready";var Xt="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Jt(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qt(e,t,r,i){switch(e){case $t.WIDEVINE:return n=r,a=i,s={audioCapabilities:[],videoCapabilities:[]},t.forEach(function(e){s.audioCapabilities.push({contentType:'audio/mp4; codecs="'+e+'"',robustness:a.audioRobustness||""})}),n.forEach(function(e){s.videoCapabilities.push({contentType:'video/mp4; codecs="'+e+'"',robustness:a.videoRobustness||""})}),[s];default:throw new Error("Unknown key-system: "+e)}var n,a,s}var er=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,P.default.MEDIA_ATTACHED,P.default.MEDIA_DETACHED,P.default.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(t){if(z.logger.log('Media is encrypted using "'+t.initDataType+'" init data type'),!r.mediaKeysPromise)return z.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void r.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});function e(e){r._media&&(r._attemptSetMediaKeys(e),r._generateRequestWithPreferredKeySession(t.initDataType,t.initData))}r.mediaKeysPromise.then(e).catch(e)},r._config=e.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=e.config.drmSystemOptions,r}r=t,(e=i).prototype=Object.create(r.prototype),(e.prototype.constructor=e).__proto__=r;var n,a,s,o=i.prototype;return o.getLicenseServerUrl=function(e){switch(e){case $t.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+e+'"')},o._attemptKeySystemAccess=function(t,e,r){var i=this,n=qt(t,e,r,this._drmSystemOptions);z.logger.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(t,n);this.mediaKeysPromise=a.then(function(e){return i._onMediaKeySystemAccessObtained(t,e)}),a.catch(function(e){z.logger.error('Failed to obtain key-system "'+t+'" access:',e)})},o._onMediaKeySystemAccessObtained=function(t,e){var r=this;z.logger.log('Access for key-system "'+t+'" obtained');var i={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(i);var n=Promise.resolve().then(function(){return e.createMediaKeys()}).then(function(e){return i.mediaKeys=e,z.logger.log('Media-keys created for key-system "'+t+'"'),r._onMediaKeysCreated(),e});return n.catch(function(e){z.logger.error("Failed to create media-keys:",e)}),n},o._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},o._onNewMediaKeySession=function(t){var r=this;z.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(e){r._onKeySessionMessage(t,e.message)},!1)},o._onKeySessionMessage=function(t,e){z.logger.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){z.logger.log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session"),t.update(e)})},o._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return z.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});z.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},o._generateRequestWithPreferredKeySession=function(e,t){var r=this,i=this._mediaKeysList[0];if(!i)return z.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(i.mediaKeysSessionInitialized)z.logger.warn("Key-Session already initialized but requested again");else{var n=i.mediaKeysSession;if(!n)return z.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!t)return z.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});z.logger.log('Generating key-session request for "'+e+'" init data type'),i.mediaKeysSessionInitialized=!0,n.generateRequest(e,t).then(function(){z.logger.debug("Key-session generation succeeded")}).catch(function(e){z.logger.error("Error generating key-session request:",e),r.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},o._createLicenseXhr=function(t,e,r){var i=new XMLHttpRequest,n=this._licenseXhrSetup;try{if(n)try{n(i,t)}catch(e){i.open("POST",t,!0),n(i,t)}i.readyState||i.open("POST",t,!0)}catch(e){throw new Error("issue setting up KeySystem license XHR "+e)}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,e,r),i},o._onLicenseRequestReadyStageChange=function(e,t,r,i){switch(e.readyState){case 4:if(200===e.status)this._requestLicenseFailureCount=0,z.logger.log("License request succeeded"),"arraybuffer"!==e.responseType&&z.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),i(e.response);else{if(z.logger.error("License Request XHR failed ("+t+"). Status: "+e.status+" ("+e.statusText+")"),this._requestLicenseFailureCount++,3<this._requestLicenseFailureCount)return void this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var n=3-this._requestLicenseFailureCount+1;z.logger.warn("Retrying license request, "+n+" attempts left"),this._requestLicense(r,i)}}},o._generateLicenseRequestChallenge=function(e,t){switch(e.mediaKeySystemDomain){case $t.WIDEVINE:return t}throw new Error("unsupported key-system: "+e.mediaKeySystemDomain)},o._requestLicense=function(e,t){z.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return z.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),n=this._createLicenseXhr(i,e,t);z.logger.log("Sending license request to URL: "+i);var a=this._generateLicenseRequestChallenge(r,e);n.send(a)}catch(e){z.logger.error("Failure requesting DRM license: "+e),this.hls.trigger(P.default.ERROR,{type:y.ErrorTypes.KEY_SYSTEM_ERROR,details:y.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},o.onMediaAttached=function(e){if(this._emeEnabled){var t=e.media;(this._media=t).addEventListener("encrypted",this._onMediaEncrypted)}},o.onMediaDetached=function(){var e=this._media,t=this._mediaKeysList;e&&(e.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(e){if(e.mediaKeysSession)return e.mediaKeysSession.close().catch(function(){})})).then(function(){return e.setMediaKeys(null)}).catch(function(){}))},o.onManifestParsed=function(e){if(this._emeEnabled){var t=e.levels.map(function(e){return e.audioCodec}),r=e.levels.map(function(e){return e.videoCodec});this._attemptKeySystemAccess($t.WIDEVINE,t,r)}},n=i,(a=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Jt(n.prototype,a),s&&Jt(n,s),i}(u);function tr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function rr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?tr(Object(r),!0).forEach(function(e){ir(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tr(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function ir(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var nr=rr(rr({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:qe,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:He,bufferController:Qe,capLevelController:Ze,fpsController:Je,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Xt,testBandwidth:!0},{cueHandler:i,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Zt,subtitleTrackController:Wt,timelineController:Yt,audioStreamController:at,audioTrackController:tt,emeController:er});function ar(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function sr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ar(Object(r),!0).forEach(function(e){or(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function or(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ur(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cr(e,t,r){return t&&ur(e.prototype,t),r&&ur(e,r),e}var dr=function(S){var e,t;function T(e){var t;void 0===e&&(e={}),(t=S.call(this)||this).config=void 0,t._autoLevelCapping=void 0,t.abrController=void 0,t.capLevelController=void 0,t.levelController=void 0,t.streamController=void 0,t.networkControllers=void 0,t.audioTrackController=void 0,t.subtitleTrackController=void 0,t.emeController=void 0,t.coreComponents=void 0,t.media=null,t.url=null;var r=T.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");t.config=sr(sr({},r),e);var i=lr(t).config;if(void 0!==i.liveMaxLatencyDurationCount&&i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==i.liveMaxLatencyDuration&&(void 0===i.liveSyncDuration||i.liveMaxLatencyDuration<=i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(z.enableLogs)(i.debug),t._autoLevelCapping=-1;var n=t.abrController=new i.abrController(lr(t)),a=new i.bufferController(lr(t)),s=t.capLevelController=new i.capLevelController(lr(t)),o=new i.fpsController(lr(t)),l=new D(lr(t)),u=new R(lr(t)),c=new F(lr(t)),d=new Be(lr(t)),f=t.levelController=new Pe(lr(t)),h=new V(lr(t)),p=[f,t.streamController=new Re(lr(t),h)],g=i.audioStreamController;g&&p.push(new g(lr(t),h)),t.networkControllers=p;var m=[l,u,c,n,a,s,o,d,h];if(g=i.audioTrackController){var y=new g(lr(t));t.audioTrackController=y,m.push(y)}if(g=i.subtitleTrackController){var v=new g(lr(t));t.subtitleTrackController=v,p.push(v)}if(g=i.emeController){var b=new g(lr(t));t.emeController=b,m.push(b)}return(g=i.subtitleStreamController)&&p.push(new g(lr(t),h)),(g=i.timelineController)&&m.push(new g(lr(t))),t.coreComponents=m,t}t=S,(e=T).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t,T.isSupported=function(){return function(){var e=Z();if(!e)return!1;var t=self.SourceBuffer||self.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!i}()},cr(T,null,[{key:"version",get:function(){return"0.13.3-canary.5621"}},{key:"Events",get:function(){return P.default}},{key:"ErrorTypes",get:function(){return y.ErrorTypes}},{key:"ErrorDetails",get:function(){return y.ErrorDetails}},{key:"DefaultConfig",get:function(){return T.defaultConfig?T.defaultConfig:nr},set:function(e){T.defaultConfig=e}}]);var r=T.prototype;return r.destroy=function(){z.logger.log("destroy"),this.trigger(P.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},r.attachMedia=function(e){z.logger.log("attachMedia"),this.media=e,this.trigger(P.default.MEDIA_ATTACHING,{media:e})},r.detachMedia=function(){z.logger.log("detachMedia"),this.trigger(P.default.MEDIA_DETACHING),this.media=null},r.loadSource=function(e){e=s.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),z.logger.log("loadSource:"+e),this.url=e,this.trigger(P.default.MANIFEST_LOADING,{url:e})},r.startLoad=function(t){void 0===t&&(t=-1),z.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},r.stopLoad=function(){z.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})},r.swapAudioCodec=function(){z.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},r.recoverMediaError=function(){z.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),e&&this.attachMedia(e)},r.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},cr(T,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){z.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){z.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){z.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){z.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){z.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){z.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"bandwidthEstimate",get:function(){var e=this.abrController._bwEstimator;return e?e.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,i=0;i<r;i++){if(t<(e[i].realBitrate?Math.max(e[i].realBitrate,e[i].bitrate):e[i].bitrate))return i}return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}}]),T}(J);dr.defaultConfig=void 0},"./src/polyfills/number-isFinite.js":function(e,t,r){r.r(t),r.d(t,"isFiniteNumber",function(){return i});var i=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}},"./src/utils/get-self-scope.js":function(e,t,r){function i(){return"undefined"==typeof window?self:window}r.r(t),r.d(t,"getSelfScope",function(){return i})},"./src/utils/logger.js":function(e,t,r){r.r(t),r.d(t,"enableLogs",function(){return u}),r.d(t,"logger",function(){return c});var i=r("./src/utils/get-self-scope.js");function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n},s=a;var o=Object(i.getSelfScope)();function l(a){var s=o.console[a];return s?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var i,n;t[0]&&(t[0]=(i=a,n=t[0],n="["+i+"] > "+n)),s.apply(o.console,t)}:n}var u=function(e){if(o.console&&!0===e||"object"==typeof e){!function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];r.forEach(function(e){s[e]=t[e]?t[e].bind(t):l(e)})}(e,"debug","log","info","warn","error");try{s.log()}catch(e){s=a}}else s=a},c=s}},n.c=i,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s="./src/hls.ts").default;function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}var r,i},e.exports=r())}),Hls=unwrapExports(hls),VideoProxy=function(){function r(e){var t=e.muted;_classCallCheck(this,r),this.clips=[],this.currentClip=0,this.paused=!0,this.muted=t,this.volume=1,this.clipLoadGracePeriod=500,this.isFullScreen=!1,this.originalVideoWidth=0,this.originalVideoHeight=0,this.clientWidth=0,this.currentClipLoadTime=Date.now()}var e;return _createClass(r,[{key:"currentClipEl",value:function(){return this.clips[this.currentClip].ref.element}},{key:"loadHLS",value:function(e){var t=!!e.ref.element.canPlayType&&(""!=e.ref.element.canPlayType("application/vnd.apple.mpegURL")||""!=e.ref.element.canPlayType("audio/mpegurl")),r=!1;if(!t&&Hls.isSupported){var i=new Hls;i.attachMedia(e.ref.element),i.on(Hls.Events.MEDIA_ATTACHED,function(){i.loadSource(e.src)}),r=!0}else t&&(e.ref.element.setAttribute("src",e.src),e.ref.element.load(),r=!0);return r}},{key:"addClip",value:function(e){var t=!0;this.clips.push(e),1===this.clips.length&&(e.isHLS?t=this.loadHLS(e):(e.ref.element.setAttribute("src",e.src),e.ref.element.load())),!t&&e.isHLS&&e.fallbackSrc&&(e.ref.element.setAttribute("src",e.fallbackSrc),e.ref.element.load())}},{key:"isPaused",value:function(){return this.paused}},{key:"hasEnded",value:function(){return this.clips[this.clips.length-1].ref.element.ended}},{key:"readyState",value:function(){return Date.now()-this.currentClipLoadTime<this.clipLoadGracePeriod?4:this.currentClipEl().readyState}},{key:"duration",value:function(){var e=this.clips.reduce(function(e,t){return e+t.duration},0);return e}},{key:"getInvisibleStylemap",value:function(){return convertStyleMapToInlineStyles({display:"none"})}},{key:"getVisibleStylemap",value:function(){var e=convertStyleMapToInlineStyles({display:"block",height:this.isFullScreen?null:"100%",width:this.isFullScreen?"100%":null});return this.isFullScreen&&this.originalVideoWidth<this.originalVideoHeight&&(e=convertStyleMapToInlineStyles({"max-height":"".concat(this.clientWidth/(16/9),"px"),"align-self":"center"})),e}},{key:"parseTime",value:function(e){return parseFloat(e.toFixed(3))}},{key:"updateClipForCurrentTime",value:function(e){if(0!==this.clips.length){var t=this.getVisibleStylemap(),r=this.clips[this.clips.length-1],i=this.clips[0],n=this.parseTime(e),a=this.parseTime(i.startTime),s=this.parseTime(r.endTime),o=s<=n||n<a;if(o){for(var l=0;l<this.clips.length;l++){var u=this.clips[l];u.ref.element.style=convertStyleMapToInlineStyles({display:"none"}),u.ref.element.pause()}return this.pause(),i.ref.element.style=this.getInvisibleStylemap(),e<a&&(i.ref.element.currentTime=i.fragmentStart),void(this.currentClip=0)}var c=0;if(a<=n)for(var d=0;d<this.clips.length;d++){var f=this.clips[d];if(this.parseTime(f.startTime)<=n&&this.parseTime(f.endTime)>n){c=d;break}}var h=this.clips[c];if(this.currentClip!==c){this.currentClipLoadTime=Date.now();var p=this.clips[this.currentClip].ref;p.element.style=convertStyleMapToInlineStyles({display:"none"}),p.element.pause(),h.ref.element.style=t,this.currentClip=c,this.currentClipEl().currentTime=n+h.fragmentStart-this.parseTime(h.startTime),this.currentClipEl().muted=this.muted,this.currentClipEl().volume=this.volume}if(this.currentClip<this.clips.length-1&&1<this.clips.length){var g=this.clips[this.currentClip+1],m=g.ref.element;m.paused&&(m.muted=!0,m.setCurrentTime=g.fragmentStart+.5,m.setCurrentTime=g.fragmentStart,m.play().catch(function(){}))}!o&&n<s-.1&&(!this.paused&&this.currentClipEl().paused?this.currentClipEl().play().catch(function(){}):this.paused&&!this.currentClipEl().paused&&this.currentClipEl().pause()),!o&&this.currentClipEl()&&"none"===this.currentClipEl().style.display&&(this.currentClipEl().style=t)}}},{key:"setMuted",value:function(e){this.muted=e,this.currentClipEl().muted=e}},{key:"setVolume",value:function(e){this.volume=e,this.currentClipEl().volume=e}},{key:"play",value:(e=_asyncToGenerator(regenerator.mark(function e(){var i,t,r,n=this;return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.currentClipEl(),t=new Promise(function(r){i.addEventListener("timeupdate",function e(t){4===t.target.readyState&&(i.removeEventListener("timeupdate",e),r(n.currentTime()))})}),r=i.play(),this.paused=!1,void 0!==r)return e.abrupt("return",r.catch(function(e){}).then(function(){return t}));e.next=6;break;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"pause",value:function(){this.currentClipEl().pause(),this.paused=!0}},{key:"setCurrentTime",value:function(e,t){this.currentClipLoadTime=Date.now(),this.updateClipForCurrentTime(t);var r=this.clips[this.currentClip],i=0===this.currentClip?0:r.videoClipStart;r.ref.element.currentTime=r.fragmentStart+e-i}},{key:"currentTime",value:function(){var e=this.clips[this.currentClip],t=this.currentClipEl();return(0===this.currentClip?0:e.videoClipStart)+t.currentTime-e.fragmentStart}},{key:"setDisplayProperties",value:function(e){var t=e.isFullScreen,r=e.originalVideoWidth,i=e.originalVideoHeight,n=e.clientWidth,a=this.isFullScreen!==t||this.clientWidth!==n||this.originalVideoWidth!==r||this.originalVideoHeight!==i;this.isFullScreen=t,this.originalVideoWidth=r,this.originalVideoHeight=i,this.clientWidth=n,a&&(this.currentClipEl().style=this.getVisibleStylemap())}},{key:"clearClips",value:function(){for(var e=0;e<this.clips.length;e++){var t=this.clips[e].ref.element;0<e&&t&&(t.pause(),t.setAttribute("src",""),t.innerHTML="",t.remove())}this.clips=[]}}]),r}(),styles$1={fullScreen:"styles_fullScreen__23imI",video:"styles_video__16wgh"},Video=function(){_inherits(i,Container);var e,r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this,e)).video=new VideoProxy({muted:e.muted}),t.props=e,t}return _createClass(i,[{key:"root",value:function(e){return jsx("video",{ref:createRef(this,"mainVideo"),className:styles$1.video,styles:{display:"block",width:"100%"},controls:!1,preload:"yes",playsInline:!0,"webkit-playsinline":!0,muted:e.muted},e.src&&jsx("source",{src:transformVideoSource(e.src),type:"video/mp4"}))}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({measurements:t.store.measurements,isFullScreen:t.store.isFullScreen,originalVideoWidth:t.store.originalVideoWidth,originalVideoHeight:t.store.originalVideoHeight,currentTime:t.store.currentTime})},autorunConfig)}},{key:"updateClipForCurrentTime",value:function(e){this.video.updateClipForCurrentTime(e)}},{key:"update",value:function(e){var t=e.isFullScreen,r=e.originalVideoWidth,i=e.originalVideoHeight,n=e.currentTime,a=e.measurements.clientWidth;this.video&&(this.video.setDisplayProperties({originalVideoWidth:r,originalVideoHeight:i,isFullScreen:t,clientWidth:a}),this.updateClipForCurrentTime(n))}},{key:"paused",value:function(){return this.video.isPaused()}},{key:"ended",value:function(){return this.video.hasEnded()}},{key:"readyState",value:function(){return this.video.readyState()}},{key:"duration",value:function(){return this.video.duration()}},{key:"play",value:(e=_asyncToGenerator(regenerator.mark(function e(){return regenerator.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.video.play());case 1:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"pause",value:function(){return this.video.pause()}},{key:"setCurrentTime",value:function(e,t){this.video.setCurrentTime(e,t)}},{key:"currentTime",value:function(){return this.video.currentTime()}},{key:"setVolume",value:function(e){this.video.setVolume(e)}},{key:"setMuted",value:function(e){this.video.setMuted(e)}},{key:"toggleMuted",value:function(){this.video.setMuted(!this.video.muted)}},{key:"clientHeight",value:function(){return this.element.clientHeight}},{key:"clientWidth",value:function(){return this.element.clientWidth}},{key:"videoHeight",value:function(){return this.element.videoHeight}},{key:"videoWidth",value:function(){return this.element.videoWidth}},{key:"setFullScreen",value:function(){this.element.classList.add(styles$1.fullScreen)}},{key:"removeFullScreen",value:function(){this.element.classList.remove(styles$1.fullScreen)}},{key:"load",value:function(){this.element.load()}},{key:"hasEnded",value:function(){return this.video.hasEnded()}},{key:"preload",value:function(){var i=this;return new Promise(function(e){if(browserDetection.isSafari){var t=i.element.muted;i.element.muted=!0;var r=i.element.play();void 0!==r?r.then(function(){i.element.pause(),i.element.currentTime=0,i.element.muted=t,e()}):(i.element.pause(),i.element.currentTime=0,i.element.muted=t,e())}else e()})}},{key:"clearClips",value:function(){this.video.clearClips()}},{key:"fixNewClipTimes",value:function(e){if(null!==e.startTime&&void 0!==e.startTime&&null!==e.endTime&&void 0!==e.endTime&&null!==e.videoClipStart&&void 0!==e.videoClipStart)return e;var t=_toConsumableArray(this.video.clips).sort(function(e,t){return e.startTime>t.startTime?-1:1})[0];return _objectSpread2(_objectSpread2({},e),{},{startTime:t.endTime,endTime:t.endTime+e.duration,videoClipStart:t.videoClipStart+t.duration})}},{key:"trimClipTimes",value:function(e){var t=e.src.split("#");if(1<t.length&&0===t[1].indexOf("t=")){var r=t[1].slice(2).split(","),i=parseFloat(r[0]);r[1];return _objectSpread2(_objectSpread2({},e),{},{fragmentStart:i})}return _objectSpread2(_objectSpread2({},e),{},{fragmentStart:0})}},{key:"addClip",value:function(e,t){var r=this.trimClipTimes(this.fixNewClipTimes(e)),i=transformVideoSource(r.srcHLS?r.srcHLS:r.src),n=r.srcHLS?transformVideoSource(r.src):null,a=this.refs.mainVideo;if(1<=this.video.clips.length){var s="videoClip_".concat(this.video.clips.length,"_").concat(r.startTime),o=jsx("video",{styles:{display:"none",width:"100%"},controls:!1,preload:"auto",src:i,playsInline:!0,"webkit-playsinline":!0,ref:createRef(this,s),type:"video/mp4"});attachToDOM(t,o),a=this.refs[s]}var l=!!r.srcHLS;this.video.addClip({startTime:r.startTime,endTime:r.startTime+r.duration,videoClipStart:r.videoClipStart,duration:r.duration,fragmentStart:r.fragmentStart,isHLS:l,src:i,fallbackSrc:n,ref:a})}},{key:"clear",value:function(){this.element.pause(),this.element.setAttribute("src",""),this.element.innerHTML="",this.element.remove(),this.video&&this.video.clearClips()}}]),i}(),Video$1=createFactory(Video);function capitalizeString(e){return e.charAt(0).toUpperCase()+e.slice(1)}function prefixProperty(e,t,r){if(e.hasOwnProperty(t)){for(var i={},n=e[t],a=capitalizeString(t),s=Object.keys(r),o=0;o<s.length;o++){var l=s[o];if(l===t)for(var u=0;u<n.length;u++)i[n[u]+a]=r[t];i[l]=r[l]}return i}return r}function prefixValue(e,t,r,i,n){for(var a=0,s=e.length;a<s;++a){var o=e[a](t,r,i,n);if(o)return o}}function addIfNew(e,t){-1===e.indexOf(t)&&e.push(t)}function addNewValuesOnly(e,t){if(Array.isArray(t))for(var r=0,i=t.length;r<i;++r)addIfNew(e,t[r]);else addIfNew(e,t)}function isObject$1(e){return e instanceof Object&&!Array.isArray(e)}function createPrefixer(e){var l=e.prefixMap,u=e.plugins;return function e(t){for(var r in t){var i=t[r];if(isObject$1(i))t[r]=e(i);else if(Array.isArray(i)){for(var n=[],a=0,s=i.length;a<s;++a){addNewValuesOnly(n,prefixValue(u,r,i[a],t,l)||i[a])}0<n.length&&(t[r]=n)}else{var o=prefixValue(u,r,i,t,l);o&&(t[r]=o),t=prefixProperty(l,r,t)}}return t}}var w=["Webkit"],m=["Moz"],ms=["ms"],wm=["Webkit","Moz"],wms=["Webkit","ms"],wmms=["Webkit","Moz","ms"],data={plugins:[],prefixMap:{appearance:wm,textEmphasisPosition:w,textEmphasis:w,textEmphasisStyle:w,textEmphasisColor:w,boxDecorationBreak:w,maskImage:w,maskMode:w,maskRepeat:w,maskPosition:w,maskClip:w,maskOrigin:w,maskSize:w,maskComposite:w,mask:w,maskBorderSource:w,maskBorderMode:w,maskBorderSlice:w,maskBorderWidth:w,maskBorderOutset:w,maskBorderRepeat:w,maskBorder:w,maskType:w,textDecorationStyle:w,textDecorationSkip:w,textDecorationLine:w,textDecorationColor:w,userSelect:wmms,backdropFilter:w,fontKerning:w,scrollSnapType:wms,scrollSnapPointsX:wms,scrollSnapPointsY:wms,scrollSnapDestination:wms,scrollSnapCoordinate:wms,clipPath:w,shapeImageThreshold:w,shapeImageMargin:w,shapeImageOutside:w,filter:w,hyphens:wms,flowInto:wms,flowFrom:wms,breakBefore:wms,breakAfter:wms,breakInside:wms,regionFragment:wms,writingMode:w,textOrientation:w,tabSize:m,fontFeatureSettings:w,columnCount:w,columnFill:w,columnGap:w,columnRule:w,columnRuleColor:w,columnRuleStyle:w,columnRuleWidth:w,columns:w,columnSpan:w,columnWidth:w,wrapFlow:ms,wrapThrough:ms,wrapMargin:ms,textSizeAdjust:w}};function backgroundClip(e,t){if("string"==typeof t&&"text"===t)return["-webkit-text","text"]}var prefixes=["-webkit-","-moz-",""],values={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};function cursor(e,t){if("cursor"===e&&values.hasOwnProperty(t))return prefixes.map(function(e){return e+t})}var isPrefixedValue_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e&&r.test(e)};var r=/-webkit-|-moz-|-ms-/;e.exports=t.default}),isPrefixedValue=unwrapExports(isPrefixedValue_1),prefixes$1=["-webkit-",""];function crossFade(e,t){if("string"==typeof t&&!isPrefixedValue(t)&&-1<t.indexOf("cross-fade("))return prefixes$1.map(function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")})}var prefixes$2=["-webkit-",""];function filter(e,t){if("string"==typeof t&&!isPrefixedValue(t)&&-1<t.indexOf("filter("))return prefixes$2.map(function(e){return t.replace(/filter\(/g,e+"filter(")})}var values$1={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};function flex(e,t){if("display"===e&&values$1.hasOwnProperty(t))return values$1[t]}var alternativeValues={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},alternativeProps={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines",flexGrow:"WebkitBoxFlex"};function flexboxOld(e,t,r){"flexDirection"===e&&"string"==typeof t&&(-1<t.indexOf("column")?r.WebkitBoxOrient="vertical":r.WebkitBoxOrient="horizontal",-1<t.indexOf("reverse")?r.WebkitBoxDirection="reverse":r.WebkitBoxDirection="normal"),alternativeProps.hasOwnProperty(e)&&(r[alternativeProps[e]]=alternativeValues[t]||t)}var prefixes$3=["-webkit-","-moz-",""],values$2=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/gi;function gradient(e,r){if("string"==typeof r&&!isPrefixedValue(r)&&values$2.test(r))return prefixes$3.map(function(t){return r.replace(values$2,function(e){return t+e})})}var _slicedToArray$1=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,a=e}finally{try{!i&&o.return&&o.return()}finally{if(n)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function isSimplePositionValue(e){return"number"==typeof e&&!isNaN(e)}function isComplexSpanValue(e){return"string"==typeof e&&e.includes("/")}var alignmentValues=["center","end","start","stretch"],displayValues={"inline-grid":["-ms-inline-grid","inline-grid"],grid:["-ms-grid","grid"]},propertyConverters={alignSelf:function(e,t){-1<alignmentValues.indexOf(e)&&(t.msGridRowAlign=e)},gridColumn:function(e,t){if(isSimplePositionValue(e))t.msGridColumn=e;else if(isComplexSpanValue(e)){var r=e.split("/"),i=_slicedToArray$1(r,2),n=i[0],a=i[1];propertyConverters.gridColumnStart(+n,t);var s=a.split(/ ?span /),o=_slicedToArray$1(s,2),l=o[0],u=o[1];""===l?propertyConverters.gridColumnEnd(+n+ +u,t):propertyConverters.gridColumnEnd(+a,t)}else propertyConverters.gridColumnStart(e,t)},gridColumnEnd:function(e,t){var r=t.msGridColumn;isSimplePositionValue(e)&&isSimplePositionValue(r)&&(t.msGridColumnSpan=e-r)},gridColumnStart:function(e,t){isSimplePositionValue(e)&&(t.msGridColumn=e)},gridRow:function(e,t){if(isSimplePositionValue(e))t.msGridRow=e;else if(isComplexSpanValue(e)){var r=e.split("/"),i=_slicedToArray$1(r,2),n=i[0],a=i[1];propertyConverters.gridRowStart(+n,t);var s=a.split(/ ?span /),o=_slicedToArray$1(s,2),l=o[0],u=o[1];""===l?propertyConverters.gridRowEnd(+n+ +u,t):propertyConverters.gridRowEnd(+a,t)}else propertyConverters.gridRowStart(e,t)},gridRowEnd:function(e,t){var r=t.msGridRow;isSimplePositionValue(e)&&isSimplePositionValue(r)&&(t.msGridRowSpan=e-r)},gridRowStart:function(e,t){isSimplePositionValue(e)&&(t.msGridRow=e)},gridTemplateColumns:function(e,t){t.msGridColumns=e},gridTemplateRows:function(e,t){t.msGridRows=e},justifySelf:function(e,t){-1<alignmentValues.indexOf(e)&&(t.msGridColumnAlign=e)}};function grid(e,t,r){if("display"===e&&t in displayValues)return displayValues[t];e in propertyConverters&&(0,propertyConverters[e])(t,r)}var prefixes$4=["-webkit-",""];function imageSet(e,t){if("string"==typeof t&&!isPrefixedValue(t)&&-1<t.indexOf("image-set("))return prefixes$4.map(function(e){return t.replace(/image-set\(/g,e+"image-set(")})}var alternativeProps$1={marginBlockStart:["WebkitMarginBefore"],marginBlockEnd:["WebkitMarginAfter"],marginInlineStart:["WebkitMarginStart","MozMarginStart"],marginInlineEnd:["WebkitMarginEnd","MozMarginEnd"],paddingBlockStart:["WebkitPaddingBefore"],paddingBlockEnd:["WebkitPaddingAfter"],paddingInlineStart:["WebkitPaddingStart","MozPaddingStart"],paddingInlineEnd:["WebkitPaddingEnd","MozPaddingEnd"],borderBlockStart:["WebkitBorderBefore"],borderBlockStartColor:["WebkitBorderBeforeColor"],borderBlockStartStyle:["WebkitBorderBeforeStyle"],borderBlockStartWidth:["WebkitBorderBeforeWidth"],borderBlockEnd:["WebkitBorderAfter"],borderBlockEndColor:["WebkitBorderAfterColor"],borderBlockEndStyle:["WebkitBorderAfterStyle"],borderBlockEndWidth:["WebkitBorderAfterWidth"],borderInlineStart:["WebkitBorderStart","MozBorderStart"],borderInlineStartColor:["WebkitBorderStartColor","MozBorderStartColor"],borderInlineStartStyle:["WebkitBorderStartStyle","MozBorderStartStyle"],borderInlineStartWidth:["WebkitBorderStartWidth","MozBorderStartWidth"],borderInlineEnd:["WebkitBorderEnd","MozBorderEnd"],borderInlineEndColor:["WebkitBorderEndColor","MozBorderEndColor"],borderInlineEndStyle:["WebkitBorderEndStyle","MozBorderEndStyle"],borderInlineEndWidth:["WebkitBorderEndWidth","MozBorderEndWidth"]};function logical(e,t,r){if(Object.prototype.hasOwnProperty.call(alternativeProps$1,e))for(var i=alternativeProps$1[e],n=0,a=i.length;n<a;++n)r[i[n]]=t}function position$1(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]}var prefixes$5=["-webkit-","-moz-",""],properties={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},values$3={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};function sizing(e,t){if(properties.hasOwnProperty(e)&&values$3.hasOwnProperty(t))return prefixes$5.map(function(e){return e+t})}var uppercasePattern=/[A-Z]/g,msPattern=/^ms-/,cache={};function toHyphenLower(e){return"-"+e.toLowerCase()}function hyphenateStyleName(e){if(cache.hasOwnProperty(e))return cache[e];var t=e.replace(uppercasePattern,toHyphenLower);return cache[e]=msPattern.test(t)?"-"+t:t}var hyphenateProperty_1=createCommonjsModule(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,i=(r=hyphenateStyleName)&&r.__esModule?r:{default:r};e.exports=t.default}),hyphenateProperty=unwrapExports(hyphenateProperty_1),properties$1={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},prefixMapping={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};function prefixValue$1(e,t){if(isPrefixedValue(e))return e;for(var r=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),i=0,n=r.length;i<n;++i){var a=r[i],s=[a];for(var o in t){var l=hyphenateProperty(o);if(-1<a.indexOf(l)&&"order"!==l)for(var u=t[o],c=0,d=u.length;c<d;++c)s.unshift(a.replace(l,prefixMapping[u[c]]+l))}r[i]=s.join(",")}return r.join(",")}function transition(e,t,r,i){if("string"==typeof t&&properties$1.hasOwnProperty(e)){var n=prefixValue$1(t,i),a=n.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(e){return!/-moz-|-ms-/.test(e)}).join(",");if(-1<e.indexOf("Webkit"))return a;var s=n.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter(function(e){return!/-webkit-|-ms-/.test(e)}).join(",");return-1<e.indexOf("Moz")?s:(r["Webkit"+capitalizeString(e)]=a,r["Moz"+capitalizeString(e)]=s,n)}}var plugins=[backgroundClip,crossFade,cursor,filter,flexboxOld,gradient,grid,imageSet,logical,position$1,sizing,transition,flex],prefix=createPrefixer({prefixMap:data.prefixMap,plugins:plugins}),getValue=function a(t){return Array.isArray(t)?t.map(function(e){return"object"===_typeof(e)&&null!==e?"".concat(e.value).concat(e.unit||""):e}):"object"===_typeof(t)?null===t||!t.value&&0!==t.value?t.values?a(t.values.map(function(e){return{value:e.value||0===e.value?e.value:e,unit:e.unit||t.unit}})):Object.entries(t).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,a(n)))},{}):"".concat(t.value).concat(t.unit||""):t},parseTransformValue=function(e,t){var r=t;Array.isArray(t)&&t.length<3&&r.push("0px");var i=Array.isArray(r)?r.reduce(function(e,t){return"".concat(e,",").concat(t)},"").substring(1):r,n="translate"===e&&Array.isArray(r)&&3===r.length?"translate3d":e;return"".concat(n,"(").concat(i,")")},mapTransformStyle=function(e){return Object.entries(e).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];return"".concat(e," ").concat(parseTransformValue(i,getValue(n)))},"").trim()},mapShadowStyle=function(e){return"".concat(e.offset.value[0]).concat(e.offset.unit," ").concat(e.offset.value[1]).concat(e.offset.unit," ").concat(e.radius.value).concat(e.radius.unit," ").concat(e.color)},mapPaddingStyle=function(e){var r=e.unit;return e.values&&0!==e.values.length?e.values.reduce(function(e,t){return"".concat(e," ").concat(t).concat(r)},"").trim():null},convertLayerStylesToStyleMap=function(e,t){var r=0<arguments.length&&void 0!==e?e:{};return prefix(_objectSpread2(_objectSpread2({},1<arguments.length&&void 0!==t?t:{}),Object.entries(r).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];if("transform"===i)return _objectSpread2(_objectSpread2({},e),{},{transform:mapTransformStyle(n)});if("padding"===i||"textPadding"===i)return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,mapPaddingStyle(n)));if("box-shadow"===i||"text-shadow"===i)return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,mapShadowStyle(n)));var a=null;return a=Array.isArray(n)?"will-change"===i?n.join(", "):n.join(" "):getValue(n),Array.isArray(a)&&(a=a.join(" ")),_objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,a))},{})))},linkStyles=convertLayerStylesToStyleMap({display:"block","text-decoration":"none"}),Layer=function(){_inherits(i,Component);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this)).defaultStyles={margin:0,padding:0,"max-width":"inherit","max-height":"inherit",transform:"translate3d(0px 0px 0px)"},t.create(e),t}return _createClass(i,[{key:"create",value:function(e){e&&(_get(_getPrototypeOf(i.prototype),"create",this).call(this,e),this.type=e.type)}},{key:"getType",value:function(){return this.type}},{key:"root",value:function(e,t){var r=1<arguments.length&&void 0!==t?t:{},i=this.elementName;this.id=e.id;var n=e.trigger?e.triggerEventListeners:e.link?e.linkEventListeners:null;return jsx(i,{id:e.id,styles:convertLayerStylesToStyleMap(e.styles,this.defaultStyles),attributes:r,textContent:e.textValue||"",eventListeners:n,"data-link":e.link})}},{key:"applyStyles",value:function(e,t,r){var i=this.element,n=t||r?{cursor:"pointer"}:null;if(i.setAttribute("style",convertStyleMapToInlineStyles(convertLayerStylesToStyleMap(_objectSpread2(_objectSpread2({},e),n),this.defaultStyles))),t){var a="string"==typeof t;a||"OPEN"===t.action?(this.element.setAttribute("data-href",a?t:t.url),this.element.setAttribute("data-method",a?"LEGACY":t.action)):(this.element.setAttribute("data-href",t.url),this.element.setAttribute("data-method",t.action),this.element.setAttribute("data-params",t.requestParameters),this.element.setAttribute("data-headers",t.headers?JSON.stringify(t.headers):void 0))}r&&(i.setAttribute("data-triggerevent",r.event),i.setAttribute("data-triggerstate",r.applyState)),(t||r)&&i.setAttribute("data-layer-id",this.id)}},{key:"update",value:function(e){var t=e.styles,r=e.link,i=e.trigger;_objectWithoutProperties(e,["styles","link","trigger"]);this.applyStyles(t,r,i)}},{key:"remove",value:function(){this.element.remove()}}]),i}(),BlockLayer=function(){_inherits(i,Layer);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this)).elementName="div",t.create(e),t}return i}(),BlockLayer$1=createFactory(BlockLayer),ImageLayer=function(){_inherits(a,Layer);var r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this)).elementName="img",t.create(e),t}return _createClass(a,[{key:"update",value:function(e){var t=e.styles,r=e.src,i=e.link;_get(_getPrototypeOf(a.prototype),"update",this).call(this,{styles:t,link:i});var n=this.element.getAttribute("src");r&&r!==n&&this.element.setAttribute("src",r)}},{key:"root",value:function(e){var t={};return e.src&&(t={src:e.src}),_get(_getPrototypeOf(a.prototype),"root",this).call(this,e,t)}}]),a}(),ImageLayer$1=createFactory(ImageLayer),featureDetection={hasObjectFit:!(!document.body.style.objectFit&&""!==document.body.style.objectFit),hasPointerEvents:!!window.PointerEvent},InfographicLayer=function(){_inherits(g,Layer);var i=_createSuper(g);function g(e,t){var r;return _classCallCheck(this,g),(r=i.call(this)).type=INFOGRAPHIC,featureDetection.hasObjectFit?(r.elementName="img",r.defaultStyles=_objectSpread2(_objectSpread2({},r.defaultStyles),{},{position:"relative","background-color":"#000","object-fit":"contain",height:"100%",width:"100%",transform:"translateZ(0)",opacity:0})):(r.wrapperElementName="div",r.elementName="img",r.defaultStyles=_objectSpread2(_objectSpread2({},r.defaultStyles),{},{"background-color":"#000",height:"100%",width:"100%","text-align":"center",transform:"translateZ(0)",opacity:0})),r.element=r.root(e,t),r.attachRef(e),r}return _createClass(g,[{key:"root",value:function(e){var t=this.elementName;if(this.wrapperElementName){var r=this.wrapperElementName;return jsx(r,{ref:createRef(this,"wrapper"),styles:convertLayerStylesToStyleMap(this.defaultStyles)},jsx(t,{src:e.src,ref:createRef(this,"infographic"),styles:convertLayerStylesToStyleMap({height:"100%",width:"initial",margin:"0 auto",right:"0px"})}))}return jsx(t,{styles:convertLayerStylesToStyleMap(this.defaultStyles),src:e.src})}},{key:"update",value:function(e,t){var r=e.styles,i=e.src,n=e.imageScale,a=e.imagePositionX,s=e.imagePositionY,o=(_objectWithoutProperties(e,["styles","src","imageScale","imagePositionX","imagePositionY"]),t.measurements),l=o.aspectRatioPercent,u=o.width,c=o.height,d=(this.element.naturalWidth,this.element.naturalHeight,n&&null!=a&&null!=s);if(this.wrapperElementName)this.refs.wrapper.element.setAttribute("style",convertStyleMapToInlineStyles(convertLayerStylesToStyleMap(_objectSpread2({},r),this.defaultStyles)));else if(d){var f=this.element.naturalWidth*n*l||r.width.value,h=this.element.naturalHeight*n*l||r.height.value,p=_objectSpread2(_objectSpread2({},r),{},{width:{value:f,unit:r.width.unit},height:{value:h,unit:r.height.unit},left:{value:a*l,unit:"px"},top:{value:s*l,unit:"px"}});_get(_getPrototypeOf(g.prototype),"update",this).call(this,{styles:p,src:i})}else _get(_getPrototypeOf(g.prototype),"update",this).call(this,{styles:r,src:i})}}]),g}(),InfographicLayer$1=createFactory(InfographicLayer),TextLayer=function(){_inherits(a,Layer);var r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this)).elementName="p",t.create(e),t}return _createClass(a,[{key:"getStyles",value:function(e){var t=e.height,r=e.width,i=e.left,n=e.top,a=e.position,s=e.transform,o=e.opacity,l=_objectWithoutProperties(e,["height","width","left","top","position","transform","opacity"]),u=null;l["text-align"]&&("left"===l["text-align"]?u="flex-start":"center"===l["text-align"]?u=l["text-align"]:"right"===l["text-align"]&&(u="flex-end"));var c=omitNullProps({height:t,width:r,left:i,top:n,position:a,transform:s,opacity:o,"z-index":l["z-index"],"will-change":l["will-change"],display:u?"inline-flex":null,"justify-content":u}),d=l.textPadding,f=l["background-color"],h=l["border-radius"],p=_objectWithoutProperties(l,["textPadding","background-color","border-radius"]),g=null;if(d)switch(d.values.length){case 1:case 2:g={unit:"px",values:[d.values[0],0,d.values[0],0]};break;default:g={unit:"px",values:[d.values[0],0,d.values[2],0]}}return{wrapperStyles:c,pStyles:omitNullProps(_objectSpread2(_objectSpread2({"line-height":"normal"},p),{},{"will-change":null,"box-shadow":l["background-color"]?l["box-shadow"]:null,overflow:"hidden",padding:g})),spanStyles:omitNullProps({"text-shadow":l["background-color"]?null:l["box-shadow"],"-webkit-box-decoration-break":"clone","box-decoration-break":"clone",padding:d,"background-color":f,"border-radius":h})}}},{key:"root",value:function(e,t){var r=1<arguments.length&&void 0!==t?t:{};this.id=e.id;var i=this.getStyles(e.styles),n=i.wrapperStyles,a=i.pStyles,s=i.spanStyles,o=jsx("p",{styles:convertLayerStylesToStyleMap(a,this.defaultStyles),ref:createRef(this,"p")},jsx("span",{id:"".concat(e.id,".span"),styles:convertLayerStylesToStyleMap(s),textContent:"".concat(e.textValue," ")||"",ref:createRef(this,"span")})),l=e.trigger?e.triggerEventListeners:e.link?e.linkEventListeners:null;return jsx("div",{id:e.id,styles:convertLayerStylesToStyleMap(n,this.defaultStyles),attributes:r,eventListeners:l},o)}},{key:"applyStyles",value:function(e,t,r){var i=this.getStyles(e),n=i.wrapperStyles,a=i.pStyles,s=i.spanStyles,o={};if((t||r)&&(o={cursor:"pointer"}),this.element.setAttribute("style",convertStyleMapToInlineStyles(convertLayerStylesToStyleMap(_objectSpread2(_objectSpread2({},n),o),this.defaultStyles))),this.refs.p.getElement().setAttribute("style",convertStyleMapToInlineStyles(convertLayerStylesToStyleMap(a,this.defaultStyles))),t){var l="string"==typeof t;l||"OPEN"===t.action?(this.element.setAttribute("data-href",l?t:t.url),this.element.setAttribute("data-method",l?"LEGACY":t.action),this.element.setAttribute("data-layer-id",this.id)):(this.element.setAttribute("data-href",t.url),this.element.setAttribute("data-method",t.action),this.element.setAttribute("data-params",t.requestParameters),this.element.setAttribute("data-headers",t.headers?JSON.stringify(t.headers):void 0))}r&&(this.element.setAttribute("data-triggerevent",r.event),this.element.setAttribute("data-triggerstate",r.applyState)),(t||r)&&this.element.setAttribute("data-layer-id",this.id),this.refs.span.getElement().setAttribute("style",convertStyleMapToInlineStyles(convertLayerStylesToStyleMap(s)))}},{key:"update",value:function(e){var t=e.styles,r=e.textValue,i=e.link,n=e.trigger;_get(_getPrototypeOf(a.prototype),"update",this).call(this,{styles:t,link:i,trigger:n}),r!==this.refs.span.getElement().textContent&&(this.refs.span.getElement().textContent="".concat(r," "))}}]),a}(),TextLayer$1=createFactory(TextLayer),VideoLayer=function(){_inherits(i,Layer);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this,e)).elementName="video",t.props=e,t.videoReady=!1,t.onChangeLoadState=null,t.shouldFixTime=!0,t}return _createClass(i,[{key:"getType",value:function(){return VIDEO}},{key:"root",value:function(e){return jsx("video",{ref:createRef(this,"video"),styles:{display:"none",width:"100%",position:"absolute",top:0,left:0,right:0,bottom:0,inset:0},controls:!1,playsInline:!0,"webkit-playsInline":!0,muted:!0,src:transformVideoSource(e.src)})}},{key:"setTime",value:function(e,t,r){var i=this.element;if(t<=e&&e<=r){var n=e-t;i.currentTime=n}}},{key:"preload",value:function(){var i=this;return new Promise(function(e){if(browserDetection.isSafari){var t=i.element.muted;i.element.muted=!0;var r=i.element.play();void 0!==r?r.then(function(){i.element.pause(),i.element.currentTime=0,i.element.muted=t,e()}).catch(function(e){return console.log("error while trying to preload ",e)}):(i.element.pause(),i.element.currentTime=0,i.element.muted=t,e())}else e()})}},{key:"update",value:function(e,t){var r=this,i=(e.styles,e.src,e.absoluteBeginTime),n=e.absoluteEndTime,a=e.onChangeLoadState,s=(e.audioDisabled,_objectWithoutProperties(e,["styles","src","absoluteBeginTime","absoluteEndTime","onChangeLoadState","audioDisabled"]),t.currentTime),o=t.currentState,l=(t.muted,this.element);l.muted||(l.muted=!0),this.onChangeLoadState=a,this.videoReady||(a(!0),this.preload().then(function(){r.videoReady=!0,a(!1)}));var u=i<=s&&s<=n;u&&"none"===l.style.display?l.style.display="block":u||"none"===l.style.display||(l.style.display="none"),this.videoReady&&(o===SEEKING&&(this.setTime(s,i,n),this.shouldFixTime=!0),this.shouldFixTime&&(this.setTime(s,i,n),this.shouldFixTime=!1),o===PLAYING&&l.paused&&u&&2<l.readyState?l.play():(o===PAUSED||o===SEEKING||o===LOADING$1||o===LAYER_LOADING||l.readyState<2)&&!l.paused&&l.pause())}}]),i}(),VideoLayer$1=createFactory(VideoLayer),createLayer$1=function(e){switch(e){case INFOGRAPHIC:return InfographicLayer$1;case IMAGE:return ImageLayer$1;case TEXT:return TextLayer$1;case VIDEO:return VideoLayer$1;case BLOCK:default:return BlockLayer$1}},styles$2={root:"styles_root__2UBKF",controlsShowing:"styles_controlsShowing__2XUFE"},LayerContainer=function(){_inherits(i,Container);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this,e)).layers={},t.stateBeforeLoad=null,t.videoLayerElementContainerId=e.videoLayerElementContainerId,t}return _createClass(i,[{key:"root",value:function(e){return this.linkEventListeners=e.linkEventListeners,this.triggerEventListeners=e.triggerEventListeners,jsx("div",{className:styles$2.root})}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({layers:t.store.layers,imageMap:t.store.imageMap,measurements:t.store.measurements,controls:t.store.controls,currentTime:t.store.currentTime,videoBackgroundColour:t.store.videoBackgroundColour,absoluteBumperBeginTime:t.store.absoluteBumperBeginTime,showSubtitles:t.store.showSubtitles,isFullScreen:t.store.isFullScreen,muted:t.store.muted,currentState:t.store.currentState,previousState:t.store.previousState})},autorunConfig)}},{key:"update",value:function(e){var u=this,t=e.layers,c=e.imageMap,d=e.measurements,f=e.currentTime,h=e.showSubtitles,r=e.controls,p=e.muted,g=e.isFullScreen,m=e.currentState,y=e.previousState,v=!1;if(t){var b=new DocumentFragment,S=new DocumentFragment;this.layers=Object.entries(t).reduce(function(e,t){var r=_slicedToArray(t,2),i=r[0],n=r[1];if(!n||!h&&n.parentType===SUBTITLE)return e;function a(e){var t=Date.now()-1e3*f;u.store.currentState!==LAYER_LOADING&&e?(u.stateBeforeLoad=m!==LAYER_LOADING?m:u.stateBeforeLoad,u.store.update({state:LAYER_LOADING,startTime:t})):u.store.currentState!==LAYER_LOADING||e||u.store.update({state:u.stateBeforeLoad,startTime:t})}var s=n.parentType===INFOGRAPHIC?INFOGRAPHIC:n.type,o=null,l=!1;return i in u.layers?(o=u.layers[i],"video"===s&&(v=!0),s!==o.getType()?(l=!0,o=createLayer$1(s)(_objectSpread2(_objectSpread2({},n),{},{linkEventListeners:u.linkEventListeners,triggerEventListeners:u.triggerEventListeners,id:i,src:u.getAbsoluteAssetSrc(c,n.src),onChangeLoadState:a}),{imageMap:c,measurements:d})):o.update(_objectSpread2(_objectSpread2({},n),{},{src:u.getAbsoluteAssetSrc(c,n.src),onChangeLoadState:a}),{imageMap:c,measurements:d,isFullScreen:g,currentTime:f,currentState:m,previousState:y,muted:p})):(l=!0,o=createLayer$1(s)(_objectSpread2(_objectSpread2({},n),{},{linkEventListeners:u.linkEventListeners,triggerEventListeners:u.triggerEventListeners,id:i,src:u.getAbsoluteAssetSrc(c,n.src),onChangeLoadState:a}),{imageMap:c,measurements:d})),"video"===o.type&&l?S.appendChild(o.getElement()):"video"!==o.type&&b.appendChild(o.getElement()),_objectSpread2(_objectSpread2({},e),{},_defineProperty({},i,o))},{}),this.element.innerHTML="",this.addElementToSelf(b);var i=document.getElementById(this.videoLayerElementContainerId);0<S.childElementCount&&i?(i.innerHTML="",this.addElementToTarget(S,i)):!v&&i&&(i.innerHTML="")}r.showControls&&!this.element.classList.contains(styles$2.controlsShowing)?this.element.classList.add(styles$2.controlsShowing):!r.showControls&&this.element.classList.contains(styles$2.controlsShowing)&&this.element.classList.remove(styles$2.controlsShowing)}},{key:"getAbsoluteAssetSrc",value:function(e,t){return e&&t&&e[t]?e[t].url:t}}]),i}(),LayerContainer$1=createFactory(LayerContainer),classnames=createCommonjsModule(function(e){function s(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"==i||"number"==i)e.push(r);else if(Array.isArray(r)&&r.length){var n=s.apply(null,r);n&&e.push(n)}else if("object"==i)for(var a in r)o.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}var o;o={}.hasOwnProperty,e.exports?(s.default=s,e.exports=s):window.classNames=s}),styles$3={handle:"styles_handle__342EU",handleHover:"styles_handleHover__13ddH",innerProgressBar:"styles_innerProgressBar__17mj_",progressBar:"styles_progressBar__3NvWY",mobile:"styles_mobile__3J9BG",progressBarContainer:"styles_progressBarContainer__1x6ob",progressBarHover:"styles_progressBarHover__xIS4R"},InnerProgressBar=function(){_inherits(t,Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{className:styles$3.innerProgressBar})}},{key:"update",value:function(e){this.element.style.width=e}}]),t}(),InnerProgressBar$1=createFactory(InnerProgressBar),Handle=function(){_inherits(t,Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{className:styles$3.handle})}},{key:"update",value:function(e){this.element.style.left=e}}]),t}(),Handle$1=createFactory(Handle),ProgressBar=function(){_inherits(a,Component);var n=_createSuper(a);function a(e){var t,r=e.eventListeners,i=_objectWithoutProperties(e,["eventListeners"]);return _classCallCheck(this,a),(t=n.call(this,i)).attachListeners({eventListeners:r(t.refs.progressBar.getElement(),t.addHoverClass.bind(_assertThisInitialized(t)),t.removeHoverClass.bind(_assertThisInitialized(t)))}),t}return _createClass(a,[{key:"addHoverClass",value:function(){this.addClass(styles$3.progressBarHover),this.refs.handle.addClass(styles$3.handleHover)}},{key:"removeHoverClass",value:function(){document.body.style.cursor="",this.removeClass(styles$3.progressBarHover),this.refs.handle.removeClass(styles$3.handleHover)}},{key:"root",value:function(){return jsx("div",{className:classnames(styles$3.progressBarContainer,_defineProperty({},styles$3.mobile,browserDetection.isMobileOrTablet))},jsx("div",{className:classnames(styles$3.progressBar,_defineProperty({},styles$3.mobile,browserDetection.isMobileOrTablet)),ref:createRef(this,"progressBar")},jsx(InnerProgressBar$1,{ref:createRef(this,"innerProgressBar")}),jsx(Handle$1,{ref:createRef(this,"handle")})))}},{key:"update",value:function(e){var t=e.currentTime,r=e.duration,i="".concat(t/r*100||0,"%");this.refs.innerProgressBar.update(i),this.refs.handle.update(i)}}]),a}(),ProgressBar$1=createFactory(ProgressBar),getAssetUrl=function(e){return window.assetUrl?"".concat(window.assetUrl,"/assets/").concat(e):"/assets/".concat(e)},Icon=function(){_inherits(a,Component);var n=_createSuper(a);function a(){var e;_classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).src="",e}return _createClass(a,[{key:"root",value:function(e){return this.src=e.src.startsWith("data")?e.src:getAssetUrl(e.src),jsx("img",{src:this.src})}},{key:"setIcon",value:function(e){var t=e.startsWith("data")?e:getAssetUrl(e);t!==this.src&&(this.src=t,this.element.src=this.src)}}]),a}(),Icon$1=createFactory(Icon),styles$4={root:"styles_root__2NmxH"},play="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzNweCIgaGVpZ2h0PSI0MHB4IiB2aWV3Qm94PSIwIDAgMzMgNDAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5JY29uczQ4eDQ4L1BsYXk8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iVmlkZW8tUGxheWVyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iUGxheWVyLUNvbnRyb2xzLS0tQWR2YW5jZWQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yNjguMDAwMDAwLCAtMTQwLjAwMDAwMCkiIGZpbGw9IiNGRkZGRkYiPgogICAgICAgICAgICA8ZyBpZD0idmlkZW8tY29udHJvbHMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3Mi4wMDAwMDAsIDEzNi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSI0OHg0OC9QbGF5IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4OC4wMDAwMDAsIDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgPGcgaWQ9Imljb24iPgogICAgICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMzkuMDUzMzA1NSwyMC44ODgxMjQzIEwxMy4zMzcyODY5LDQuNTUwOTMzNDUgQzExLjAwODI4OSwzLjA2NTczNDI4IDgsNC43NDg5NjAwMSA4LDcuNjIwMzQ1MDcgTDgsNDAuMzkzNzQwMSBDOCw0My4xNjYxMTE5IDExLjAwODI4OSw0NC45NDgzNTA5IDEzLjMzNzI4NjksNDMuNDYzMTUxNyBMMzkuMDUzMzA1NSwyNy4xMjU5NjA5IEM0MS4yODUyNjE4LDI1LjU0MTc0ODQgNDEuMjg1MjYxOCwyMi4yNzQzMTAyIDM5LjA1MzMwNTUsMjAuODg4MTI0MyBaIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",pause="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDhweCIgaGVpZ2h0PSI0OHB4IiB2aWV3Qm94PSIwIDAgNDggNDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5BcnRib2FyZDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik0yLjY0LDIwIEwzNi45NiwyMCBDMzguNDE4MDMxNywyMCAzOS42LDIxLjE5MzkwNzMgMzkuNiwyMi42NjY2NjY3IEwzOS42LDMwLjY2NjY2NjcgQzM5LjYsMzIuMTM5NDI2IDM4LjQxODAzMTcsMzMuMzMzMzMzMyAzNi45NiwzMy4zMzMzMzMzIEwyLjY0LDMzLjMzMzMzMzMgQzEuMTgxOTY4MjYsMzMuMzMzMzMzMyAxLjc4NTU3MzllLTE2LDMyLjEzOTQyNiAwLDMwLjY2NjY2NjcgTDAsMjIuNjY2NjY2NyBDLTEuNzg1NTczOWUtMTYsMjEuMTkzOTA3MyAxLjE4MTk2ODI2LDIwIDIuNjQsMjAgWiBNMi42NCwwIEwzNi45NiwwIEMzOC40MTgwMzE3LDAgMzkuNiwxLjE5MzkwNzMzIDM5LjYsMi42NjY2NjY2NyBMMzkuNiwxMC42NjY2NjY3IEMzOS42LDEyLjEzOTQyNiAzOC40MTgwMzE3LDEzLjMzMzMzMzMgMzYuOTYsMTMuMzMzMzMzMyBMMi42NCwxMy4zMzMzMzMzIEMxLjE4MTk2ODI2LDEzLjMzMzMzMzMgMS43ODU1NzM5ZS0xNiwxMi4xMzk0MjYgMCwxMC42NjY2NjY3IEwwLDIuNjY2NjY2NjcgQy0xLjc4NTU3MzllLTE2LDEuMTkzOTA3MzMgMS4xODE5NjgyNiwwIDIuNjQsMCBaIiBpZD0icGF0aC0xIj48L3BhdGg+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iQXJ0Ym9hcmQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJQYXVzZV8zMHgzMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDQuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTcuMTY2NjY3LCAyMC4yMDAwMDApIHJvdGF0ZSg5MC4wMDAwMDApIHRyYW5zbGF0ZSgtMTcuMTY2NjY3LCAtMjAuMjAwMDAwKSB0cmFuc2xhdGUoLTIuODMzMzMzLCAzLjIwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9IkNvbG91cnMvQHdoaXRlLUNsaXBwZWQiPgogICAgICAgICAgICAgICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIGZpbGw9IndoaXRlIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgICAgICAgICAgPGcgaWQ9InBhdGgtMSI+PC9nPgogICAgICAgICAgICAgICAgICAgIDxnIGlkPSJDb2xvdXJzL0B3aGl0ZSIgbWFzaz0idXJsKCNtYXNrLTIpIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICAgICAgICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgLTQuMDAwMDAwKSIgaWQ9IlNoYXBlIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIzOS42IiBoZWlnaHQ9IjQwIj48L3JlY3Q+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",buttonIcons={play:play,pause:pause},defaultValue=buttonIcons.play,PlayButton=function(){_inherits(n,Component);var i=_createSuper(n);function n(e){var t=e.eventListeners,r=_objectWithoutProperties(e,["eventListeners"]);return _classCallCheck(this,n),i.call(this,_objectSpread2(_objectSpread2({},r),{},{eventListeners:t()}))}return _createClass(n,[{key:"root",value:function(){return jsx("button",{type:"button",className:styles$4.root},jsx(Icon$1,{src:defaultValue,ref:createRef(this,"icon")}))}},{key:"update",value:function(e){var t=e.currentState;this.refs.icon&&this.refs.icon.setIcon(t===PLAYING?buttonIcons.pause:buttonIcons.play)}}]),n}(),PlayButton$1=createFactory(PlayButton),formatTime=function(e,t){if(t){var r=Math.floor(e/60),i=Math.floor(e%60),n=Math.floor(1e3*e-1e3*i);return"".concat(r,":").concat((i<10?"0":"")+i,":").concat(n.toString().padStart(3,"0"))}var a=Math.floor(e/60),s=Math.floor(e%60);return"".concat(a,":").concat((s<10?"0":"")+s)},styles$5={root:"styles_root__1dw90",currentTime:"styles_currentTime__-6Xh1",duration:"styles_duration__1FWMW"},defaultValue$1={currentTime:"0:00",duration:"0:00"},TimeDisplay=function(){_inherits(t,Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{className:styles$5.root},jsx("div",{ref:createRef(this,"currentTime"),className:styles$5.currentTime},defaultValue$1.currentTime)," ","/"," ",jsx("div",{ref:createRef(this,"duration"),className:styles$5.duration},defaultValue$1.duration))}},{key:"update",value:function(e){var t=e.useTimeInMillis,r=e.currentTime,i=e.duration;this.refs.currentTime.getElement().textContent=formatTime(r,t),this.refs.duration.getElement().textContent=formatTime(i,t)}}]),t}(),TimeDisplay$1=createFactory(TimeDisplay),styles$6={root:"styles_root__2Kbw9"},smallScreenImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjJweCIgaGVpZ2h0PSIyMnB4IiB2aWV3Qm94PSIwIDAgMjIgMjIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5JY29ucy8yNHgyNC9TbWFsbCBTY3JlZW48L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNNy40ODUyODEzNywxNSBMNCwxNSBDMy40NDc3MTUyNSwxNSAzLDE0LjU1MjI4NDcgMywxNCBDMywxMy40NDc3MTUzIDMuNDQ3NzE1MjUsMTMgNCwxMyBMMTAsMTMgQzEwLjU1MjI4NDcsMTMgMTEsMTMuNDQ3NzE1MyAxMSwxNCBMMTEsMjAgQzExLDIwLjU1MjI4NDcgMTAuNTUyMjg0NywyMSAxMCwyMSBDOS40NDc3MTUyNSwyMSA5LDIwLjU1MjI4NDcgOSwyMCBMOSwxNi4zMTM3MDg1IEwzLjEyMTMyMDM0LDIyLjE5MjM4ODIgQzIuNzMwNzk2MDUsMjIuNTgyOTEyNCAyLjA5NzYzMTA3LDIyLjU4MjkxMjQgMS43MDcxMDY3OCwyMi4xOTIzODgyIEMxLjMxNjU4MjQ5LDIxLjgwMTg2MzkgMS4zMTY1ODI0OSwyMS4xNjg2OTg5IDEuNzA3MTA2NzgsMjAuNzc4MTc0NiBMNy40ODUyODEzNywxNSBaIE0xNi4zMTM3MDg1LDkgTDIwLDkgQzIwLjU1MjI4NDcsOSAyMSw5LjQ0NzcxNTI1IDIxLDEwIEMyMSwxMC41NTIyODQ3IDIwLjU1MjI4NDcsMTEgMjAsMTEgTDE0LDExIEMxMy40NDc3MTUzLDExIDEzLDEwLjU1MjI4NDcgMTMsMTAgTDEzLDQgQzEzLDMuNDQ3NzE1MjUgMTMuNDQ3NzE1MywzIDE0LDMgQzE0LjU1MjI4NDcsMyAxNSwzLjQ0NzcxNTI1IDE1LDQgTDE1LDcuNDg1MjgxMzcgTDIwLjc3ODE3NDYsMS43MDcxMDY3OCBDMjEuMTY4Njk4OSwxLjMxNjU4MjQ5IDIxLjgwMTg2MzksMS4zMTY1ODI0OSAyMi4xOTIzODgyLDEuNzA3MTA2NzggQzIyLjU4MjkxMjQsMi4wOTc2MzEwNyAyMi41ODI5MTI0LDIuNzMwNzk2MDUgMjIuMTkyMzg4MiwzLjEyMTMyMDM0IEwxNi4zMTM3MDg1LDkgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlZpZGVvLVBsYXllciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlBsYXllci1Db250cm9scy0tLUFkdmFuY2VkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTI1LjAwMDAwMCwgLTIxLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iMjR4MjQvU21hbGwtU2NyZWVuIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MjQuMDAwMDAwLCAyMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIGZpbGw9IndoaXRlIj4KICAgICAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICAgICAgPGcgaWQ9Imljb24iPjwvZz4KICAgICAgICAgICAgICAgIDxnIGlkPSJDb2xvdXJzL0B3aGl0ZSIgbWFzaz0idXJsKCNtYXNrLTIpIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJTaGFwZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48L3JlY3Q+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",fullScreenImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjJweCIgaGVpZ2h0PSIyMnB4IiB2aWV3Qm94PSIwIDAgMjIgMjIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5JY29ucy8yNHgyNC9TbWFsbCBTY3JlZW48L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNMywxOS40ODUyODE0IEw4Ljc3ODE3NDU5LDEzLjcwNzEwNjggQzkuMTY4Njk4ODgsMTMuMzE2NTgyNSA5LjgwMTg2Mzg2LDEzLjMxNjU4MjUgMTAuMTkyMzg4MiwxMy43MDcxMDY4IEMxMC41ODI5MTI0LDE0LjA5NzYzMTEgMTAuNTgyOTEyNCwxNC43MzA3OTYxIDEwLjE5MjM4ODIsMTUuMTIxMzIwMyBMNC4zMTM3MDg1LDIxIEw4LDIxIEM4LjU1MjI4NDc1LDIxIDksMjEuNDQ3NzE1MyA5LDIyIEM5LDIyLjU1MjI4NDcgOC41NTIyODQ3NSwyMyA4LDIzIEwyLDIzIEMxLjQ0NzcxNTI1LDIzIDEsMjIuNTUyMjg0NyAxLDIyIEwxLDE2IEMxLDE1LjQ0NzcxNTMgMS40NDc3MTUyNSwxNSAyLDE1IEMyLjU1MjI4NDc1LDE1IDMsMTUuNDQ3NzE1MyAzLDE2IEwzLDE5LjQ4NTI4MTQgWiBNMjEsNC4zMTM3MDg1IEwxNS4xMjEzMjAzLDEwLjE5MjM4ODIgQzE0LjczMDc5NjEsMTAuNTgyOTEyNCAxNC4wOTc2MzExLDEwLjU4MjkxMjQgMTMuNzA3MTA2OCwxMC4xOTIzODgyIEMxMy4zMTY1ODI1LDkuODAxODYzODYgMTMuMzE2NTgyNSw5LjE2ODY5ODg4IDEzLjcwNzEwNjgsOC43NzgxNzQ1OSBMMTkuNDg1MjgxNCwzIEwxNiwzIEMxNS40NDc3MTUzLDMgMTUsMi41NTIyODQ3NSAxNSwyIEMxNSwxLjQ0NzcxNTI1IDE1LjQ0NzcxNTMsMSAxNiwxIEwyMiwxIEMyMi41NTIyODQ3LDEgMjMsMS40NDc3MTUyNSAyMywyIEwyMyw4IEMyMyw4LjU1MjI4NDc1IDIyLjU1MjI4NDcsOSAyMiw5IEMyMS40NDc3MTUzLDkgMjEsOC41NTIyODQ3NSAyMSw4IEwyMSw0LjMxMzcwODUgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlZpZGVvLVBsYXllciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlBsYXllci1Db250cm9scy0tLUFkdmFuY2VkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNTI1LjAwMDAwMCwgLTIxLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iMjR4MjQvRnVsbC1TY3JlZW4iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUyNC4wMDAwMDAsIDIwLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPG1hc2sgaWQ9Im1hc2stMiIgZmlsbD0id2hpdGUiPgogICAgICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgICAgICA8ZyBpZD0iaWNvbiI+PC9nPgogICAgICAgICAgICAgICAgPGcgaWQ9IkNvbG91cnMvQHdoaXRlIiBtYXNrPSJ1cmwoI21hc2stMikiIGZpbGw9IiNGRkZGRkYiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgICAgICAgICAgPHJlY3QgaWQ9IlNoYXBlIiB4PSIwIiB5PSIwIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",buttonIcons$1={smallScreen:smallScreenImg,fullScreen:fullScreenImg},defaultValue$2=buttonIcons$1.fullScreen,FullScreenButton=function(){_inherits(n,Component);var i=_createSuper(n);function n(e){var t=e.eventListeners,r=_objectWithoutProperties(e,["eventListeners"]);return _classCallCheck(this,n),i.call(this,_objectSpread2(_objectSpread2({},r),{},{eventListeners:t(),id:"FullScreenButton"}))}return _createClass(n,[{key:"root",value:function(){return jsx("button",{"data-playerbuttontype":"fullscreen",type:"button",className:styles$6.root},jsx(Icon$1,{src:defaultValue$2,ref:createRef(this,"icon")}))}},{key:"update",value:function(e){this.refs.icon&&this.refs.icon.setIcon(e?buttonIcons$1.smallScreen:buttonIcons$1.fullScreen)}}]),n}(),FullScreenButton$1=createFactory(FullScreenButton),styles$7={root:"styles_root__XFMj-"},soundOnImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT4zMHgzMC9Wb2x1bWUgRW5hYmxlZDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik0xNi4zMDY1MDE1LDAuMTAzNDkyNTk4IEMxNS45NzAwNjg0LC0wLjA2MzIzNDU3MTQgMTUuNTY3ODU0NiwtMC4wMjY0OTEzOCAxNS4yNjc4Nzg0LDAuMTk5MTAzOTEzIEw2LjQ2OTUwMDQzLDYuODE5MTk5NzcgTDEuNTkxMDIzMTcsNi44MTkxOTk3NyBDMC43MTM2ODE4NzUsNi44MTkxOTk3NyAwLDcuNTMxMTQ4NDkgMCw4LjQwNjI2ODU5IEwwLDE1LjU5NDEwNiBDMCwxNi40Njg4MzEgMC43MTM2ODE4NzUsMTcuMTgwNzc5NyAxLjU5MTAyMzE3LDE3LjE4MDc3OTcgTDYuNDY5NTAwNDMsMTcuMTgwNzc5NyBMMTUuMjY3ODc4NCwyMy44MDA0ODA1IEMxNS40NDMwMjk2LDIzLjkzMjQzOTkgMTUuNjUzNDQ4OSwyNCAxNS44NjUwNTY5LDI0IEMxNi4wMTU2Mzk0LDI0IDE2LjE2NjYxODIsMjMuOTY1NjI3MyAxNi4zMDY1MDE1LDIzLjg5NjA5MTggQzE2LjY0MjkzNDUsMjMuNzI4OTY5NiAxNi44NTUzMzUxLDIzLjM4NjgyMzMgMTYuODU1MzM1MSwyMy4wMTIyNzk4IEwxNi44NTUzMzUxLDAuOTg3Njk5NzIgQzE2Ljg1NTMzNTEsMC42MTMxNTYyMjEgMTYuNjQyOTM0NSwwLjI3MDYxNDg1NiAxNi4zMDY1MDE1LDAuMTAzNDkyNTk4IFogTTIwLjA0Njg5MTksNi44NjM0NDk2NCBDMTkuNjU5NzM2Myw2LjQ3Nzg0MzY3IDE5LjAzMjgzNzYsNi40Nzc4NDM2NyAxOC42NDYwNzgyLDYuODYzNDQ5NjQgQzE4LjI1OTMxODksNy4yNDkwNTU2IDE4LjI1ODkyMjcsNy44NzQ0ODAwMyAxOC42NDYwNzgyLDguMjYwNDgxMDkgQzE5LjY0Nzg0ODMsOS4yNTkyNjM3NSAyMC4xOTk4NTIxLDEwLjU4NzE1NDggMjAuMTk5ODUyMSwxMS45OTk1OTQ3IEMyMC4xOTk4NTIxLDEzLjQxMjQyOTYgMTkuNjQ3ODQ4MywxNC43NDAzMjA3IDE4LjY0NjA3ODIsMTUuNzM5MTAzMyBDMTguMjU4OTIyNywxNi4xMjQ3MDkzIDE4LjI1ODkyMjcsMTYuNzUwMTMzNyAxOC42NDYwNzgyLDE3LjEzNTczOTcgQzE4LjgzOTQ1NzksMTcuMzI4NTQyNyAxOS4wOTMwNzA2LDE3LjQyNDk0NDIgMTkuMzQ2NjgzMiwxNy40MjQ5NDQyIEMxOS42MDAyOTU5LDE3LjQyNDk0NDIgMTkuODUzNTEyMywxNy4zMjg1NDI3IDIwLjA0NzI4ODIsMTcuMTM1NzM5NyBDMjEuNDIzOTI5NCwxNS43NjM5OTM5IDIyLjE4MTU5NzIsMTMuOTM5ODcyMiAyMi4xODE1OTcyLDExLjk5OTU5NDcgQzIyLjE4MTIwMSwxMC4wNTkzMTcxIDIxLjQyMzUzMzEsOC4yMzU1OTA1NCAyMC4wNDY4OTE5LDYuODYzNDQ5NjQgWiBNMjIuNzc4Nzc1OCw0LjE0MDEwNzUxIEMyMi4zOTIwMTY1LDMuNzU0MTA2NDUgMjEuNzY0MzI1MSwzLjc1NDEwNjQ1IDIxLjM3Nzk2MjEsNC4xNDAxMDc1MSBDMjAuOTkwODA2NSw0LjUyNTcxMzQ3IDIwLjk5MDgwNjUsNS4xNTExMzc5IDIxLjM3Nzk2MjEsNS41MzY3NDM4NyBDMjMuMTA5NjYxMSw3LjI2MzI3ODc4IDI0LjA2MzA4NjEsOS41NTg3NDA1MiAyNC4wNjMwODYxLDExLjk5OTk4OTggQzI0LjA2MzA4NjEsMTQuNDQxMjM5IDIzLjEwOTY2MTEsMTYuNzM2NzAwNyAyMS4zNzc5NjIxLDE4LjQ2Mjg0MDYgQzIwLjk5MDgwNjUsMTguODQ4NDQ2NSAyMC45OTA4MDY1LDE5LjQ3Mzg3MSAyMS4zNzc5NjIxLDE5Ljg1OTQ3NjkgQzIxLjU3MTM0MTgsMjAuMDUyMjc5OSAyMS44MjQ5NTQ0LDIwLjE0ODY4MTQgMjIuMDc4NTY3MSwyMC4xNDg2ODE0IEMyMi4zMzIxNzk3LDIwLjE0ODY4MTQgMjIuNTg1Mzk2MSwyMC4wNTIyNzk5IDIyLjc3OTE3MjEsMTkuODU5NDc2OSBDMjQuODg0NTUzNCwxNy43NjAzNzQgMjYuMDQ0NDM1LDE0Ljk2OTQ3MTggMjYuMDQ0NDM1LDExLjk5OTk4OTggQzI2LjA0NDQzNSw5LjAzMDUwNzc1IDI0Ljg4NDU1MzQsNi4yMzk2MDU1NiAyMi43Nzg3NzU4LDQuMTQwMTA3NTEgWiBNMjUuNTgwNzk5NCwxLjM0NjA0NDYxIEMyNS4xOTQwNDAxLDAuOTYwMDQzNTU1IDI0LjU2NjM0ODgsMC45NjAwNDM1NTUgMjQuMTc5OTg1NywxLjM0NjA0NDYxIEMyMy43OTI4MzAyLDEuNzMxNjUwNTcgMjMuNzkyODMwMiwyLjM1NzA3NSAyNC4xNzk5ODU3LDIuNzQyNjgwOTcgQzI5LjI5OTM5NSw3Ljg0NjgyMzg3IDI5LjI5OTM5NSwxNi4xNTI3NjA2IDI0LjE3OTk4NTcsMjEuMjU3Mjk4NiBDMjMuNzkyODMwMiwyMS42NDMyOTk2IDIzLjc5MjgzMDIsMjIuMjY4NzI0IDI0LjE3OTk4NTcsMjIuNjUzOTM0OSBDMjQuMzczMzY1NCwyMi44NDY3Mzc5IDI0LjYyNjk3OCwyMi45NDMxMzk0IDI0Ljg4MDU5MDcsMjIuOTQzMTM5NCBDMjUuMTM0MjAzNCwyMi45NDMxMzk0IDI1LjM4NzgxNiwyMi44NDY3Mzc5IDI1LjU4MTU5MTksMjIuNjUzOTM0OSBDMzEuNDcyOTM0OCwxNi43NzkzNzAzIDMxLjQ3MjkzNDgsNy4yMjAyMTQxNyAyNS41ODA3OTk0LDEuMzQ2MDQ0NjEgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IjMweDMwL1ZvbHVtZS1FbmFibGVkIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iQ29sb3Vycy9Ad2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAzLjAwMDAwMCkiPgogICAgICAgICAgICA8bWFzayBpZD0ibWFzay0yIiBmaWxsPSJ3aGl0ZSI+CiAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgIDx1c2UgaWQ9Ik1hc2siIGZpbGw9IiNGRkZGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",soundOffImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzBweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMzAgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT4zMHgzMC9Wb2x1bWUgRGlzYWJsZWQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNMTYuMzA2NTAxNSwwLjEwMzQ5MjU5OCBDMTUuOTcwMDY4NCwtMC4wNjMyMzQ1NzE0IDE1LjU2Nzg1NDYsLTAuMDI2NDkxMzggMTUuMjY3ODc4NCwwLjE5OTEwMzkxMyBMNi40Njk1MDA0Myw2LjgxOTE5OTc3IEwxLjU5MTAyMzE3LDYuODE5MTk5NzcgQzAuNzEzNjgxODc1LDYuODE5MTk5NzcgMCw3LjUzMTE0ODQ5IDAsOC40MDYyNjg1OSBMMCwxNS41OTQxMDYgQzAsMTYuNDY4ODMxIDAuNzEzNjgxODc1LDE3LjE4MDc3OTcgMS41OTEwMjMxNywxNy4xODA3Nzk3IEw2LjQ2OTUwMDQzLDE3LjE4MDc3OTcgTDE1LjI2Nzg3ODQsMjMuODAwNDgwNSBDMTUuNDQzMDI5NiwyMy45MzI0Mzk5IDE1LjY1MzQ0ODksMjQgMTUuODY1MDU2OSwyNCBDMTYuMDE1NjM5NCwyNCAxNi4xNjY2MTgyLDIzLjk2NTYyNzMgMTYuMzA2NTAxNSwyMy44OTYwOTE4IEMxNi42NDI5MzQ1LDIzLjcyODk2OTYgMTYuODU1MzM1MSwyMy4zODY4MjMzIDE2Ljg1NTMzNTEsMjMuMDEyMjc5OCBMMTYuODU1MzM1MSwwLjk4NzY5OTcyIEMxNi44NTUzMzUxLDAuNjEzMTU2MjIxIDE2LjY0MjkzNDUsMC4yNzA2MTQ4NTYgMTYuMzA2NTAxNSwwLjEwMzQ5MjU5OCBaIE0xNC44NzM5ODYyLDIxLjAyOTMzMjcgTDcuMzk3OTYwNTMsMTUuNDA0ODU4OCBDNy4yMjU5Nzk0NSwxNS4yNzUyNjk5IDcuMDE2NzQ5LDE1LjIwNTMzOTMgNi44MDExNzgyNCwxNS4yMDUzMzkzIEwxLjk4MTM0ODksMTUuMjA1MzM5MyBMMS45ODEzNDg5LDguNzk0NjQwMTcgTDYuODAxMTc4MjQsOC43OTQ2NDAxNyBDNy4wMTYzNTI3Myw4Ljc5NDY0MDE3IDcuMjI1OTc5NDUsOC43MjQ3MDk1OCA3LjM5Nzk2MDUzLDguNTk1NTE1NzggTDE0Ljg3Mzk4NjIsMi45NzA2NDY3OSBMMTQuODczOTg2MiwyMS4wMjkzMzI3IFogTTI0LjkxNDIxMzYsMTIgTDI3Ljc0MjY0MDcsMTQuODI4NDI3MSBDMjguMTMzMTY1LDE1LjIxODk1MTQgMjguMTMzMTY1LDE1Ljg1MjExNjQgMjcuNzQyNjQwNywxNi4yNDI2NDA3IEMyNy4zNTIxMTY0LDE2LjYzMzE2NSAyNi43MTg5NTE0LDE2LjYzMzE2NSAyNi4zMjg0MjcxLDE2LjI0MjY0MDcgTDIzLjUsMTMuNDE0MjEzNiBMMjAuNjcxNTcyOSwxNi4yNDI2NDA3IEMyMC4yODEwNDg2LDE2LjYzMzE2NSAxOS42NDc4ODM2LDE2LjYzMzE2NSAxOS4yNTczNTkzLDE2LjI0MjY0MDcgQzE4Ljg2NjgzNSwxNS44NTIxMTY0IDE4Ljg2NjgzNSwxNS4yMTg5NTE0IDE5LjI1NzM1OTMsMTQuODI4NDI3MSBMMjIuMDg1Nzg2NCwxMiBMMTkuMjU3MzU5Myw5LjE3MTU3Mjg4IEMxOC44NjY4MzUsOC43ODEwNDg1OCAxOC44NjY4MzUsOC4xNDc4ODM2IDE5LjI1NzM1OTMsNy43NTczNTkzMSBDMTkuNjQ3ODgzNiw3LjM2NjgzNTAyIDIwLjI4MTA0ODYsNy4zNjY4MzUwMiAyMC42NzE1NzI5LDcuNzU3MzU5MzEgTDIzLjUsMTAuNTg1Nzg2NCBMMjYuMzI4NDI3MSw3Ljc1NzM1OTMxIEMyNi43MTg5NTE0LDcuMzY2ODM1MDIgMjcuMzUyMTE2NCw3LjM2NjgzNTAyIDI3Ljc0MjY0MDcsNy43NTczNTkzMSBDMjguMTMzMTY1LDguMTQ3ODgzNiAyOC4xMzMxNjUsOC43ODEwNDg1OCAyNy43NDI2NDA3LDkuMTcxNTcyODggTDI0LjkxNDIxMzYsMTIgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IjMweDMwL1ZvbHVtZS1EaXNhYmxlZCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IkNvbG91cnMvQHdoaXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPG1hc2sgaWQ9Im1hc2stMiIgZmlsbD0id2hpdGUiPgogICAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICA8dXNlIGlkPSJNYXNrIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICA8ZyBtYXNrPSJ1cmwoI21hc2stMikiIGZpbGw9IiNGRkZGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgaWQ9IlNoYXBlIj4KICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAtMy4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMzAiIGhlaWdodD0iMzAiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",buttonIcons$2={soundOn:soundOnImg,soundOff:soundOffImg},defaultValue$3=buttonIcons$2.soundOn,MuteButton=function(){_inherits(n,Component);var i=_createSuper(n);function n(e){var t=e.eventListeners,r=_objectWithoutProperties(e,["eventListeners"]);return _classCallCheck(this,n),i.call(this,_objectSpread2(_objectSpread2({},r),{},{eventListeners:t()}))}return _createClass(n,[{key:"root",value:function(){return jsx("button",{type:"button",className:styles$7.root},jsx(Icon$1,{src:defaultValue$3,ref:createRef(this,"icon")}))}},{key:"update",value:function(e){this.refs.icon&&this.refs.icon.setIcon(e?buttonIcons$2.soundOff:buttonIcons$2.soundOn)}}]),n}(),MutedButton=createFactory(MuteButton),styles$8={root:"styles_root__1AJvc",hide:"styles_hide__1vXoU"},subtitlesOnImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMjQgMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5JY29ucy8yNHgyNC9TdWJ0aXRsZUFjdGl2ZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGQ9Ik0xLDMgTDIzLDMgQzIzLjU1MjI4NDcsMyAyNCwzLjQ0NzcxNTI1IDI0LDQgTDI0LDIwIEMyNCwyMC41NTIyODQ3IDIzLjU1MjI4NDcsMjEgMjMsMjEgTDEsMjEgQzAuNDQ3NzE1MjUsMjEgNi43NjM1Mzc1MWUtMTcsMjAuNTUyMjg0NyAwLDIwIEwwLDQgQy02Ljc2MzUzNzUxZS0xNywzLjQ0NzcxNTI1IDAuNDQ3NzE1MjUsMyAxLDMgWiBNNS44LDEyLjQ2MDY2NDEgTDUuOCwxMS41MDg1MTU2IEM1LjgsOS42MzgzOTg0NCA2Ljc4NjMyODEzLDguNTMgOC41MDAxOTUzMSw4LjUzIEM5LjMzMDI3MzQ0LDguNTMgMTAuMDA4OTg0NCw4Ljc4MzkwNjI1IDEwLjQ4MjYxNzIsOS4yNjI0MjE4NyBDMTAuODA5NzY1Niw5LjU4OTU3MDMxIDExLjAxNDg0MzgsMTAuMDA0NjA5NCAxMS4wMTQ4NDM4LDEwLjI5NzU3ODEgQzExLjAxNDg0MzgsMTAuNTg1NjY0MSAxMC44MjQ0MTQxLDEwLjc2NjMyODEgMTAuNTQ2MDkzOCwxMC43NjYzMjgxIEMxMC4zMzEyNSwxMC43NjYzMjgxIDEwLjE4OTY0ODQsMTAuNjgzMzIwMyAxMC4wMTM4NjcyLDEwLjQyNDUzMTIgQzkuNjI4MTI1LDkuNzg5NzY1NjIgOS4xNzg5MDYyNSw5LjQ5Njc5Njg3IDguNTUzOTA2MjUsOS40OTY3OTY4NyBDNy40OTkyMTg3NSw5LjQ5Njc5Njg3IDYuOTAzNTE1NjMsMTAuMjM4OTg0NCA2LjkwMzUxNTYzLDExLjU0MjY5NTMgTDYuOTAzNTE1NjMsMTIuNDMxMzY3MiBDNi45MDM1MTU2MywxMy43NjQzNzUgNy40OTQzMzU5NCwxNC41MDE2Nzk3IDguNTUzOTA2MjUsMTQuNTAxNjc5NyBDOS4xODg2NzE4OCwxNC41MDE2Nzk3IDkuNjcyMDcwMzEsMTQuMjEzNTkzNyAxMC4wMzMzOTg0LDEzLjU5MzQ3NjYgQzEwLjIwOTE3OTcsMTMuMzM5NTcwMyAxMC4zMzYxMzI4LDEzLjI0Njc5NjkgMTAuNTQxMjEwOSwxMy4yNDY3OTY5IEMxMC44MzQxNzk3LDEzLjI0Njc5NjkgMTEuMDE0ODQzOCwxMy40MzIzNDM3IDExLjAxNDg0MzgsMTMuNzE1NTQ2OSBDMTEuMDE0ODQzOCwxNC4wNDI2OTUzIDEwLjc4NTM1MTYsMTQuNDc3MjY1NiAxMC40MTkxNDA2LDE0LjgwNDQxNDEgQzkuOTU1MjczNDQsMTUuMjM0MTAxNiA5LjMwNTg1OTM4LDE1LjQ2ODQ3NjYgOC41MDAxOTUzMSwxNS40Njg0NzY2IEM2Ljc3NjU2MjUsMTUuNDY4NDc2NiA1LjgsMTQuMzY5ODQzNyA1LjgsMTIuNDYwNjY0MSBaIE0xMi45NzY3NTc4LDEyLjQ2MDY2NDEgTDEyLjk3Njc1NzgsMTEuNTA4NTE1NiBDMTIuOTc2NzU3OCw5LjYzODM5ODQ0IDEzLjk2MzA4NTksOC41MyAxNS42NzY5NTMxLDguNTMgQzE2LjUwNzAzMTMsOC41MyAxNy4xODU3NDIyLDguNzgzOTA2MjUgMTcuNjU5Mzc1LDkuMjYyNDIxODcgQzE3Ljk4NjUyMzQsOS41ODk1NzAzMSAxOC4xOTE2MDE2LDEwLjAwNDYwOTQgMTguMTkxNjAxNiwxMC4yOTc1NzgxIEMxOC4xOTE2MDE2LDEwLjU4NTY2NDEgMTguMDAxMTcxOSwxMC43NjYzMjgxIDE3LjcyMjg1MTYsMTAuNzY2MzI4MSBDMTcuNTA4MDA3OCwxMC43NjYzMjgxIDE3LjM2NjQwNjMsMTAuNjgzMzIwMyAxNy4xOTA2MjUsMTAuNDI0NTMxMiBDMTYuODA0ODgyOCw5Ljc4OTc2NTYyIDE2LjM1NTY2NDEsOS40OTY3OTY4NyAxNS43MzA2NjQxLDkuNDk2Nzk2ODcgQzE0LjY3NTk3NjYsOS40OTY3OTY4NyAxNC4wODAyNzM0LDEwLjIzODk4NDQgMTQuMDgwMjczNCwxMS41NDI2OTUzIEwxNC4wODAyNzM0LDEyLjQzMTM2NzIgQzE0LjA4MDI3MzQsMTMuNzY0Mzc1IDE0LjY3MTA5MzgsMTQuNTAxNjc5NyAxNS43MzA2NjQxLDE0LjUwMTY3OTcgQzE2LjM2NTQyOTcsMTQuNTAxNjc5NyAxNi44NDg4MjgxLDE0LjIxMzU5MzcgMTcuMjEwMTU2MywxMy41OTM0NzY2IEMxNy4zODU5Mzc1LDEzLjMzOTU3MDMgMTcuNTEyODkwNiwxMy4yNDY3OTY5IDE3LjcxNzk2ODgsMTMuMjQ2Nzk2OSBDMTguMDEwOTM3NSwxMy4yNDY3OTY5IDE4LjE5MTYwMTYsMTMuNDMyMzQzNyAxOC4xOTE2MDE2LDEzLjcxNTU0NjkgQzE4LjE5MTYwMTYsMTQuMDQyNjk1MyAxNy45NjIxMDk0LDE0LjQ3NzI2NTYgMTcuNTk1ODk4NCwxNC44MDQ0MTQxIEMxNy4xMzIwMzEzLDE1LjIzNDEwMTYgMTYuNDgyNjE3MiwxNS40Njg0NzY2IDE1LjY3Njk1MzEsMTUuNDY4NDc2NiBDMTMuOTUzMzIwMywxNS40Njg0NzY2IDEyLjk3Njc1NzgsMTQuMzY5ODQzNyAxMi45NzY3NTc4LDEyLjQ2MDY2NDEgWiIgaWQ9InBhdGgtMSI+PC9wYXRoPgogICAgPC9kZWZzPgogICAgPGcgaWQ9IlN5bWJvbHMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSIyNHgyNC9TdWJ0aXRsZUFjdGl2ZSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIC0zLjAwMDAwMCkiPgogICAgICAgICAgICA8ZyBpZD0iSWNvbnMvMjR4MjQvU3VidGl0bGVBY3RpdmUiPgogICAgICAgICAgICAgICAgPG1hc2sgaWQ9Im1hc2stMiIgZmlsbD0id2hpdGUiPgogICAgICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgICAgICA8L21hc2s+CiAgICAgICAgICAgICAgICA8dXNlIGlkPSJpY29uIiBmaWxsPSIjRkZGRkZGIiB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgIDxnIGlkPSJDb2xvdXJzL0B3aGl0ZSIgbWFzaz0idXJsKCNtYXNrLTIpIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJTaGFwZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48L3JlY3Q+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",subtitlesOffImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT4yNHgyNC9TdWJ0aXRsZUluYWN0aXZlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+CiAgICAgICAgPHBhdGggZD0iTTIyLDUgTDIsNSBMMiwxOSBMMjIsMTkgTDIyLDUgWiBNMjQsNCBMMjQsMjAgQzI0LDIwLjU1MjI4NDcgMjMuNTUyMjg0NywyMSAyMywyMSBMMSwyMSBDMC40NDc3MTUyNSwyMSA2Ljc2MzUzNzUxZS0xNywyMC41NTIyODQ3IDAsMjAgTDAsNCBDLTYuNzYzNTM3NTFlLTE3LDMuNDQ3NzE1MjUgMC40NDc3MTUyNSwzIDEsMyBMMjMsMyBDMjMuNTUyMjg0NywzIDI0LDMuNDQ3NzE1MjUgMjQsNCBaIE01LjgsMTIuNDYwNjY0MSBMNS44LDExLjUwODUxNTYgQzUuOCw5LjYzODM5ODQ0IDYuNzg2MzI4MTMsOC41MyA4LjUwMDE5NTMxLDguNTMgQzkuMzMwMjczNDQsOC41MyAxMC4wMDg5ODQ0LDguNzgzOTA2MjUgMTAuNDgyNjE3Miw5LjI2MjQyMTg3IEMxMC44MDk3NjU2LDkuNTg5NTcwMzEgMTEuMDE0ODQzOCwxMC4wMDQ2MDk0IDExLjAxNDg0MzgsMTAuMjk3NTc4MSBDMTEuMDE0ODQzOCwxMC41ODU2NjQxIDEwLjgyNDQxNDEsMTAuNzY2MzI4MSAxMC41NDYwOTM4LDEwLjc2NjMyODEgQzEwLjMzMTI1LDEwLjc2NjMyODEgMTAuMTg5NjQ4NCwxMC42ODMzMjAzIDEwLjAxMzg2NzIsMTAuNDI0NTMxMiBDOS42MjgxMjUsOS43ODk3NjU2MiA5LjE3ODkwNjI1LDkuNDk2Nzk2ODcgOC41NTM5MDYyNSw5LjQ5Njc5Njg3IEM3LjQ5OTIxODc1LDkuNDk2Nzk2ODcgNi45MDM1MTU2MywxMC4yMzg5ODQ0IDYuOTAzNTE1NjMsMTEuNTQyNjk1MyBMNi45MDM1MTU2MywxMi40MzEzNjcyIEM2LjkwMzUxNTYzLDEzLjc2NDM3NSA3LjQ5NDMzNTk0LDE0LjUwMTY3OTcgOC41NTM5MDYyNSwxNC41MDE2Nzk3IEM5LjE4ODY3MTg4LDE0LjUwMTY3OTcgOS42NzIwNzAzMSwxNC4yMTM1OTM3IDEwLjAzMzM5ODQsMTMuNTkzNDc2NiBDMTAuMjA5MTc5NywxMy4zMzk1NzAzIDEwLjMzNjEzMjgsMTMuMjQ2Nzk2OSAxMC41NDEyMTA5LDEzLjI0Njc5NjkgQzEwLjgzNDE3OTcsMTMuMjQ2Nzk2OSAxMS4wMTQ4NDM4LDEzLjQzMjM0MzcgMTEuMDE0ODQzOCwxMy43MTU1NDY5IEMxMS4wMTQ4NDM4LDE0LjA0MjY5NTMgMTAuNzg1MzUxNiwxNC40NzcyNjU2IDEwLjQxOTE0MDYsMTQuODA0NDE0MSBDOS45NTUyNzM0NCwxNS4yMzQxMDE2IDkuMzA1ODU5MzgsMTUuNDY4NDc2NiA4LjUwMDE5NTMxLDE1LjQ2ODQ3NjYgQzYuNzc2NTYyNSwxNS40Njg0NzY2IDUuOCwxNC4zNjk4NDM3IDUuOCwxMi40NjA2NjQxIFogTTEyLjk3Njc1NzgsMTIuNDYwNjY0MSBMMTIuOTc2NzU3OCwxMS41MDg1MTU2IEMxMi45NzY3NTc4LDkuNjM4Mzk4NDQgMTMuOTYzMDg1OSw4LjUzIDE1LjY3Njk1MzEsOC41MyBDMTYuNTA3MDMxMyw4LjUzIDE3LjE4NTc0MjIsOC43ODM5MDYyNSAxNy42NTkzNzUsOS4yNjI0MjE4NyBDMTcuOTg2NTIzNCw5LjU4OTU3MDMxIDE4LjE5MTYwMTYsMTAuMDA0NjA5NCAxOC4xOTE2MDE2LDEwLjI5NzU3ODEgQzE4LjE5MTYwMTYsMTAuNTg1NjY0MSAxOC4wMDExNzE5LDEwLjc2NjMyODEgMTcuNzIyODUxNiwxMC43NjYzMjgxIEMxNy41MDgwMDc4LDEwLjc2NjMyODEgMTcuMzY2NDA2MywxMC42ODMzMjAzIDE3LjE5MDYyNSwxMC40MjQ1MzEyIEMxNi44MDQ4ODI4LDkuNzg5NzY1NjIgMTYuMzU1NjY0MSw5LjQ5Njc5Njg3IDE1LjczMDY2NDEsOS40OTY3OTY4NyBDMTQuNjc1OTc2Niw5LjQ5Njc5Njg3IDE0LjA4MDI3MzQsMTAuMjM4OTg0NCAxNC4wODAyNzM0LDExLjU0MjY5NTMgTDE0LjA4MDI3MzQsMTIuNDMxMzY3MiBDMTQuMDgwMjczNCwxMy43NjQzNzUgMTQuNjcxMDkzOCwxNC41MDE2Nzk3IDE1LjczMDY2NDEsMTQuNTAxNjc5NyBDMTYuMzY1NDI5NywxNC41MDE2Nzk3IDE2Ljg0ODgyODEsMTQuMjEzNTkzNyAxNy4yMTAxNTYzLDEzLjU5MzQ3NjYgQzE3LjM4NTkzNzUsMTMuMzM5NTcwMyAxNy41MTI4OTA2LDEzLjI0Njc5NjkgMTcuNzE3OTY4OCwxMy4yNDY3OTY5IEMxOC4wMTA5Mzc1LDEzLjI0Njc5NjkgMTguMTkxNjAxNiwxMy40MzIzNDM3IDE4LjE5MTYwMTYsMTMuNzE1NTQ2OSBDMTguMTkxNjAxNiwxNC4wNDI2OTUzIDE3Ljk2MjEwOTQsMTQuNDc3MjY1NiAxNy41OTU4OTg0LDE0LjgwNDQxNDEgQzE3LjEzMjAzMTMsMTUuMjM0MTAxNiAxNi40ODI2MTcyLDE1LjQ2ODQ3NjYgMTUuNjc2OTUzMSwxNS40Njg0NzY2IEMxMy45NTMzMjAzLDE1LjQ2ODQ3NjYgMTIuOTc2NzU3OCwxNC4zNjk4NDM3IDEyLjk3Njc1NzgsMTIuNDYwNjY0MSBaIiBpZD0icGF0aC0xIj48L3BhdGg+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iMjR4MjQvU3VidGl0bGVJbmFjdGl2ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikljb25zLzI0eDI0L1N1YnRpdGxlSW5hY3RpdmUiPgogICAgICAgICAgICA8Zz4KICAgICAgICAgICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIGZpbGw9IndoaXRlIj4KICAgICAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgICAgICAgICAgPC9tYXNrPgogICAgICAgICAgICAgICAgPGcgaWQ9Imljb24iPjwvZz4KICAgICAgICAgICAgICAgIDxnIGlkPSJDb2xvdXJzL0B3aGl0ZSIgbWFzaz0idXJsKCNtYXNrLTIpIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJTaGFwZSIgeD0iMCIgeT0iMCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48L3JlY3Q+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",buttonIcons$3={subtitlesOn:subtitlesOnImg,subtitlesOff:subtitlesOffImg},defaultValue$4=buttonIcons$3.subtitlesOn,SubtitlesButton=function(){_inherits(n,Component);var i=_createSuper(n);function n(e){var t=e.eventListeners,r=_objectWithoutProperties(e,["eventListeners"]);return _classCallCheck(this,n),i.call(this,_objectSpread2(_objectSpread2({},r),{},{eventListeners:t()}))}return _createClass(n,[{key:"root",value:function(){return jsx("button",{type:"button",className:styles$8.root},jsx(Icon$1,{src:defaultValue$4,ref:createRef(this,"icon")}))}},{key:"update",value:function(e,t){t?(this.refs.icon&&this.refs.icon.setIcon(e?buttonIcons$3.subtitlesOn:buttonIcons$3.subtitlesOff),this.element.classList.remove(styles$8.hide)):this.element.classList.add(styles$8.hide)}}]),n}(),SubtitlesButton$1=createFactory(SubtitlesButton),styles$9={root:"styles_root__1St-T"},defaultValue$5={currentTime:"0:00",duration:"0:00"},MobileTimeDisplay=function(){_inherits(t,Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{className:styles$9.root},jsx("div",{ref:createRef(this,"currentTime"),className:styles$9.currentTime},defaultValue$5.currentTime),jsx("div",{ref:createRef(this,"duration"),className:styles$9.duration},defaultValue$5.duration))}},{key:"update",value:function(e){var t=e.useTimeInMillis,r=e.currentTime,i=e.duration;this.refs.currentTime.getElement().textContent=formatTime(r,t),this.refs.duration.getElement().textContent=formatTime(i,t)}}]),t}(),MobileTimeDisplay$1=createFactory(MobileTimeDisplay),styles$a={root:"styles_root__2SYF6",invisible:"styles_invisible__2uK5s",mobile:"styles_mobile__2-r9_",root2:"styles_root2__2BK34",inner:"styles_inner__UEWWh",display:"styles_display__3_RB0",mobileControlsRow:"styles_mobileControlsRow__2sEeM",mobileProgressBarArea:"styles_mobileProgressBarArea__131Uk",fadeIn:"styles_fadeIn__3k3S4",fadeOut:"styles_fadeOut__2jZKR"},Controls$1=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"setupControlRestrictions",value:function(e){this.allowPlay=e.allowPlay,this.allowMute=e.allowMute,this.allowTime=e.allowTime,this.allowProgress=e.allowProgress,this.allowSubtitles=e.allowSubtitles,this.allowFS=e.allowFS}},{key:"root",value:function(e){var t=this;this.setupControlRestrictions(e.controlCapabilities);var r,i;return jsx("div",{className:classnames(styles$a.root,_defineProperty({},styles$a.mobile,browserDetection.isMobileOrTablet))},jsx("div",{eventListeners:e.eventListeners.container(),className:classnames(styles$a.root2,_defineProperty({},styles$a.mobile,browserDetection.isMobileOrTablet))},browserDetection.isMobileOrTablet&&(i=e.eventListeners,jsx("div",{className:styles$a.mobileControlsRow},t.allowSubtitles&&jsx(SubtitlesButton$1,{eventListeners:i.subtitlesButton,ref:createRef(t,"subtitlesButton")}),t.allowMute&&jsx(MutedButton,{eventListeners:i.mutedButton,ref:createRef(t,"mutedButton")}),t.allowFS&&jsx(FullScreenButton$1,{eventListeners:i.fullScreenButton,ref:createRef(t,"fullScreenButton")}))),jsx("div",{className:classnames(_defineProperty({},styles$a.mobileProgressBarArea,browserDetection.isMobileOrTablet))},browserDetection.isMobileOrTablet&&this.allowTime&&jsx(MobileTimeDisplay$1,{ref:createRef(this,"mobileTimeDisplay")}),this.allowProgress&&jsx(ProgressBar$1,{eventListeners:e.eventListeners.progressBar,ref:createRef(this,"progressBar")}),!browserDetection.isMobileOrTablet&&(r=e.eventListeners,jsx("div",{className:styles$a.inner},jsx("div",{className:styles$a.display},t.allowPlay&&jsx(PlayButton$1,{eventListeners:r.playButton,ref:createRef(t,"playButton")}),t.allowTime&&jsx(TimeDisplay$1,{ref:createRef(t,"timeDisplay")})),jsx("div",null,t.allowSubtitles&&jsx(SubtitlesButton$1,{eventListeners:r.subtitlesButton,ref:createRef(t,"subtitlesButton")}),t.allowMute&&jsx(MutedButton,{eventListeners:r.mutedButton,ref:createRef(t,"mutedButton")}),t.allowFS&&jsx(FullScreenButton$1,{eventListeners:r.fullScreenButton,ref:createRef(t,"fullScreenButton")})))))))}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({controls:t.store.controls,isFullScreen:t.store.isFullScreen,useTimeInMillis:t.store.useTimeInMillis,currentTime:t.store.currentTime,duration:t.store.duration,currentState:t.store.currentState,previousState:t.store.previousState,muted:t.store.muted,showSubtitles:t.store.showSubtitles,displaySubtitlesButton:t.store.displaySubtitlesButton})},autorunConfig)}},{key:"update",value:function(e){var t=e.controls,r=e.isFullScreen,i=e.currentState,n=(e.previousState,e.currentTime),a=e.duration,s=e.useTimeInMillis,o=e.muted,l=e.showSubtitles,u=e.displaySubtitlesButton,c=i!==INITIALISING;c?this.element.classList.remove(styles$a.invisible):this.element.classList.add(styles$a.invisible),c&&t&&(t.showControls?(this.allowProgress&&this.refs.progressBar.update({currentTime:n,duration:a}),browserDetection.isMobileOrTablet?this.allowTime&&this.refs.mobileTimeDisplay.update({useTimeInMillis:s,currentTime:n,duration:a}):(this.allowPlay&&this.refs.playButton.update({currentState:i}),this.allowTime&&this.refs.timeDisplay.update({useTimeInMillis:s,currentTime:n,duration:a})),this.element.classList.contains(styles$a.fadeIn)||(this.element.classList.remove(styles$a.fadeOut),this.element.classList.add(styles$a.fadeIn))):this.element.classList.contains(styles$a.fadeOut)||(this.element.classList.remove(styles$a.fadeIn),this.element.classList.add(styles$a.fadeOut)),this.allowMute&&this.refs.mutedButton.update(o),this.allowSubtitles&&this.refs.subtitlesButton.update(l,u),this.allowFS&&this.refs.fullScreenButton.update(r))}}]),t}(),Controls$2=createFactory(Controls$1),styles$b={root:"styles_root__Doaxf",img:"styles_img__2kLAC"},disposer=null,PosterContainer=function(){_inherits(i,Container);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),(t=r.call(this,e)).store=e.store,t.src=e.src,t}return _createClass(i,[{key:"root",value:function(){return jsx("div",{className:styles$b.root},this.src&&""!==this.src&&jsx("img",{className:styles$b.img,src:this.src}))}},{key:"subscribe",value:function(e){var t=this;disposer=autorun(function(){return e({currentState:t.store.currentState,measurements:t.store.measurements})},autorunConfig)}},{key:"remove",value:function(){this.element.remove(),disposer()}},{key:"setSrc",value:function(e){if(e&&""!==e){this.src=e;var t=jsx("img",{className:styles$b.img,src:e});attachToDOM(this.element,t)}}},{key:"update",value:function(e){var t=e.currentState,r=t===READY||t===INITIALISING;r&&!this.isElementInDOM()?this.element=this.root():!r&&this.isElementInDOM()&&this.remove()}}]),i}(),PosterContainer$1=createFactory(PosterContainer),styles$c={root:"styles_root__Vfmc2",fadeInAndOut:"styles_fadeInAndOut__1rjqp",fadeInOut:"styles_fadeInOut__3r7Nz",fadeInDelayed:"styles_fadeInDelayed__39F41",fadeIn:"styles_fadeIn__1ORSm",fadeOut:"styles_fadeOut__ucpjX"},timeout$1=null,AnimatedIcon=function(){_inherits(i,Component);var r=_createSuper(i);function i(e){var t;return _classCallCheck(this,i),t=r.call(this,e),e.initialDisplay&&t.element.classList.add(styles$c.fadeIn),t}return _createClass(i,[{key:"root",value:function(e){return jsx("div",{className:styles$c.root},jsx(Icon$1,{src:e.icon}))}},{key:"animateInAndOut",value:function(){var e=this;this.element.classList.add(styles$c.fadeInAndOut),setTimeout(function(){e.element.classList.remove(styles$c.fadeInAndOut)},500)}},{key:"animateIn",value:function(){clearTimeout(timeout$1),timeout$1=null,this.element.classList.remove(styles$c.fadeIn),this.element.classList.remove(styles$c.fadeOut),this.element.classList.add(styles$c.fadeIn)}},{key:"animateInWithDelay",value:function(){clearTimeout(timeout$1),timeout$1=null,this.element.classList.remove(styles$c.fadeIn),this.element.classList.remove(styles$c.fadeInDelayed),this.element.classList.remove(styles$c.fadeOut),this.element.classList.add(styles$c.fadeInDelayed)}},{key:"animateOut",value:function(){var e=this;clearTimeout(timeout$1),timeout$1=null,this.element.classList.remove(styles$c.fadeIn),this.element.classList.remove(styles$c.fadeOut),this.element.classList.remove(styles$c.fadeInDelayed),this.element.classList.add(styles$c.fadeOut),timeout$1=setTimeout(function(){e.element.classList.remove(styles$c.fadeIn),e.element.classList.remove(styles$c.fadeOut),e.element.classList.remove(styles$c.fadeInDelayed)},500)}},{key:"isInDOM",value:function(){return this.element.classList.contains(styles$c.fadeIn)||this.element.classList.contains(styles$c.fadeInDelayed)}}]),i}(),AnimatedIcon$1=createFactory(AnimatedIcon),hasHandled$1=!0,hasNotHandled$1=!1,handlePlayingState$1=function(s){return function(i,n,e){var a=e.allowPlay;return function(e,t,r){return e===PLAYING&&t!==PLAYING||e===LOADING$1&&t===PAUSED?(s("handlePlayingState",{currentState:e,previousState:t}),a&&(i.animateOut(),r?n.animateIn():n.animateOut()),hasHandled$1):hasNotHandled$1}}},handlePausedState=function(s){return function(i,n,e){var a=e.allowPlay;return function(e,t,r){return e===PAUSED&&t!==PAUSED&&t!==LOADING$1&&t!==READY?(s("handlePausedState",{currentState:e,previousState:t}),a&&(e===PAUSED&&n.isInDOM()&&!r?n.animateOut():(i.animateOut(),n.animateIn())),hasHandled$1):hasNotHandled$1}}},handleSkippingState=function(){return function(t){return function(e){return e===SKIPPING?(t.animateInAndOut(),hasHandled$1):hasNotHandled$1}}},handleRewindingState=function(r){return function(t){return function(e){return e===REWINDING?(r("handleRewindingState",{currentState:e}),t.animateInAndOut(),hasHandled$1):hasNotHandled$1}}},handleErrorState=function(a){return function(t,r,i,n){return function(e){return isErrorState(e)?(a("handleErrorState",{currentState:e}),[t,r,i,n].forEach(function(e){return e.animateOut()}),hasHandled$1):hasNotHandled$1}}},handleOverlayControlsState=function(e,t,r,i){var n=e.paused,a=e.playing,s=e.rewinding,o=e.skipping,l=t.currentState,u=t.previousState,c=logger({useLogger:!1,label:"handleOverlayControlsState"});return[handlePlayingState$1(c)(a,n,i),handlePausedState(c)(n,a,i),handleRewindingState(c)(s),handleSkippingState()(o),handleErrorState(c)(n,a,s,o)].some(function(e){return e(l,u,r)})},styles$d={root:"styles_root__1n21M",overlay:"styles_overlay__1vhIs",mobile:"styles_mobile__11Clo",left:"styles_left__30H9O",centre:"styles_centre__BIiDC",right:"styles_right__PJId5"},rewind="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzZweCIgaGVpZ2h0PSI0MnB4IiB2aWV3Qm94PSIwIDAgMzYgNDIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5JY29ucy80OHg0OC9SZXdpbmQtMTA8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iVmlkZW8tUGxheWVyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iUGxheWVyLUNvbnRyb2xzLS0tQWR2YW5jZWQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xNzguMDAwMDAwLCAtMTM5LjAwMDAwMCkiIGZpbGw9IiNGRkZGRkYiPgogICAgICAgICAgICA8ZyBpZD0idmlkZW8tY29udHJvbHMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3Mi4wMDAwMDAsIDEzNi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJJY29ucy80OHg0OC9SZXdpbmQtMTAiPgogICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAuMDAwMDAwLCAwLjUwMDAwMCkiIGlkPSJpY29uIj4KICAgICAgICAgICAgICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGV4dCBpZD0iMTAiIGZvbnQtZmFtaWx5PSJTRlByb0Rpc3BsYXktU2VtaWJvbGQsIFNGIFBybyBEaXNwbGF5IiBmb250LXNpemU9IjE2IiBmb250LXdlaWdodD0iNTAwIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dHNwYW4geD0iOS4xNjQwNjI1IiB5PSIyOC41Ij4xMDwvdHNwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3RleHQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iYmciPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOS4wMDUwMDk3LDExLjc5MDAwMjggTDEzLjI2MDAwOTgsNi4wNDUwMDI5NCBMMTkuMDA1MDA5NywwLjMwMDAwMzA1MiBMMTkuMDA1MDA5NywxMS43OTAwMDI4IFoiIGlkPSJDb21iaW5lZC1TaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjAxNzkyMzY2ODYsMjIuMTg5NDYxOSBDMC4wMDYxNTkxMTM3NiwyMi4xMjgxMTU2IDAsMjIuMDY0Nzc3MSAwLDIyIEMwLDIxLjQ0NzcxNTMgMC40NDc3MTUyNSwyMSAxLDIxIEMxLjU1MjI4NDc1LDIxIDIsMjEuNDQ3NzE1MyAyLDIyIEwyLjAzMDc0MTk4LDIyIEMyLjAxMDM0NzgxLDIyLjMzMDcxNTUgMiwyMi42NjQxNDkzIDIsMjMgQzIsMzEuODM2NTU2IDkuMTYzNDQ0LDM5IDE4LDM5IEMyNi44MzY1NTYsMzkgMzQsMzEuODM2NTU2IDM0LDIzIEMzNCwxNC4xNjM0NDQgMjYuODM2NTU2LDcgMTgsNyBDMTcuNjY0MTQ5Myw3IDE3LjMzMDcxNTUsNy4wMTAzNDc4MSAxNyw3LjAzMDc0MTk4IEwxNyw1LjAyNzMwODM4IEMxNy4zMzEwMzA0LDUuMDA5MTgxOTcgMTcuNjY0NDQyOSw1IDE4LDUgQzI3Ljk0MTEyNTUsNSAzNiwxMy4wNTg4NzQ1IDM2LDIzIEMzNiwzMi45NDExMjU1IDI3Ljk0MTEyNTUsNDEgMTgsNDEgQzguMDU4ODc0NSw0MSAwLDMyLjk0MTEyNTUgMCwyMyBDMCwyMi43MjgzNzM0IDAuMDA2MDE2NTU1MywyMi40NTgxNTIgMC4wMTc5MjM2Njg2LDIyLjE4OTQ2MTkgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",skip="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMzZweCIgaGVpZ2h0PSI0MnB4IiB2aWV3Qm94PSIwIDAgMzYgNDIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjIgKDcyNjQzKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5JY29ucy80OHg0OC9Gb3J3YXJkLTEwPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlZpZGVvLVBsYXllciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IlBsYXllci1Db250cm9scy0tLUFkdmFuY2VkIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzU0LjAwMDAwMCwgLTEzOC4wMDAwMDApIiBmaWxsPSIjRkZGRkZGIj4KICAgICAgICAgICAgPGcgaWQ9InZpZGVvLWNvbnRyb2xzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzIuMDAwMDAwLCAxMzYuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSWNvbnMvNDh4NDgvRm9yd2FyZC0xMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc2LjAwMDAwMCwgMC4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iaWNvbiI+CiAgICAgICAgICAgICAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCAyLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRleHQgaWQ9IjEwIiBmb250LWZhbWlseT0iU0ZQcm9EaXNwbGF5LVNlbWlib2xkLCBTRiBQcm8gRGlzcGxheSIgZm9udC1zaXplPSIxNiIgZm9udC13ZWlnaHQ9IjUwMCI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRzcGFuIHg9IjkuMTY0MDYyNSIgeT0iMjkiPjEwPC90c3Bhbj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdGV4dD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxnIGlkPSJiZyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTguMDAwMDAwLCAyMS4wMDAwMDApIHNjYWxlKC0xLCAxKSB0cmFuc2xhdGUoLTE4LjAwMDAwMCwgLTIxLjAwMDAwMCkgdHJhbnNsYXRlKDAuMDAwMDAwLCAwLjUwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xOS4wMDUwMDk3LDExLjc5MDAwMjggTDEzLjI2MDAwOTgsNi4wNDUwMDI5NCBMMTkuMDA1MDA5NywwLjMwMDAwMzA1MiBMMTkuMDA1MDA5NywxMS43OTAwMDI4IFoiIGlkPSJDb21iaW5lZC1TaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjAxNzkyMzY2ODYsMjIuMTg5NDYxOSBDMC4wMDYxNTkxMTM3NiwyMi4xMjgxMTU2IDAsMjIuMDY0Nzc3MSAwLDIyIEMwLDIxLjQ0NzcxNTMgMC40NDc3MTUyNSwyMSAxLDIxIEMxLjU1MjI4NDc1LDIxIDIsMjEuNDQ3NzE1MyAyLDIyIEwyLjAzMDc0MTk4LDIyIEMyLjAxMDM0NzgxLDIyLjMzMDcxNTUgMiwyMi42NjQxNDkzIDIsMjMgQzIsMzEuODM2NTU2IDkuMTYzNDQ0LDM5IDE4LDM5IEMyNi44MzY1NTYsMzkgMzQsMzEuODM2NTU2IDM0LDIzIEMzNCwxNC4xNjM0NDQgMjYuODM2NTU2LDcgMTgsNyBDMTcuNjY0MTQ5Myw3IDE3LjMzMDcxNTUsNy4wMTAzNDc4MSAxNyw3LjAzMDc0MTk4IEwxNyw1LjAyNzMwODM4IEMxNy4zMzEwMzA0LDUuMDA5MTgxOTcgMTcuNjY0NDQyOSw1IDE4LDUgQzI3Ljk0MTEyNTUsNSAzNiwxMy4wNTg4NzQ1IDM2LDIzIEMzNiwzMi45NDExMjU1IDI3Ljk0MTEyNTUsNDEgMTgsNDEgQzguMDU4ODc0NSw0MSAwLDMyLjk0MTEyNTUgMCwyMyBDMCwyMi43MjgzNzM0IDAuMDA2MDE2NTU1MywyMi40NTgxNTIgMC4wMTc5MjM2Njg2LDIyLjE4OTQ2MTkgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",OverlayControls=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(e){var t=e.controlCapabilities;return this.controlCapabilities=t,jsx("div",{className:classnames(styles$d.root,_defineProperty({},styles$d.mobile,browserDetection.isMobileOrTablet))},jsx("div",{className:styles$d.left,eventListeners:e.eventListeners.left},jsx(AnimatedIcon$1,{ref:createRef(this,"rewinding"),icon:rewind})),jsx("div",{className:styles$d.centre,eventListeners:e.eventListeners.centre},t.allowPlay&&jsx(AnimatedIcon$1,{ref:createRef(this,"playing"),icon:play,initialDisplay:!0}),t.allowPlay&&jsx(AnimatedIcon$1,{ref:createRef(this,"paused"),icon:pause})),jsx("div",{className:styles$d.right,eventListeners:e.eventListeners.right},jsx(AnimatedIcon$1,{ref:createRef(this,"skipping"),icon:skip})))}},{key:"subscribe",value:function(e){var t=this;autorun(function(){e({currentState:t.store.currentState,previousState:t.store.previousState,controls:t.store.controls,clientHeight:t.store.clientHeight})},autorunConfig)}},{key:"update",value:function(e){var t=e.currentState,r=e.previousState,i=e.controls,n=e.clientHeight;handleOverlayControlsState({playing:this.refs.playing,paused:this.refs.paused,skipping:this.refs.skipping,rewinding:this.refs.rewinding},{currentState:t,previousState:r},i.showControls,this.controlCapabilities),this.element.style.height="".concat(n-100,"px")}}]),t}(),OverlayControls$1=createFactory(OverlayControls),styles$e={root:"styles_root__34iVl"},OverlayControlsOverlay=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{ref:createRef(this,"root"),className:classnames(styles$e.root)})}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({showControls:t.store.controls.showControls})},autorunConfig)}},{key:"update",value:function(e){e.showControls?this.refs.root.element.setAttribute("style","display: block;"):this.refs.root.element.setAttribute("style","display: none;")}}]),t}(),OverlayControlsOverlay$1=createFactory(OverlayControlsOverlay),styles$f={root:"styles_root__3qXyw",spinner:"styles_spinner__ZW4uJ","sk-stretchdelay":"styles_sk-stretchdelay__2XTHN",rect2:"styles_rect2__2KUBX",rect3:"styles_rect3__3d1iK",rect4:"styles_rect4__39qQA",rect5:"styles_rect5__O38zr"},Loader=function(){_inherits(t,Component);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{className:styles$f.root},jsx("div",{className:styles$f.spinner},new Array(5).fill(0).map(function(e,t){return jsx("div",{className:styles$f["rect".concat(t+1)]})})))}},{key:"remove",value:function(){this.element.remove()}}]),t}(),Loader$1=createFactory(Loader),styles$g={root:"styles_root__2ku8q"},LoaderContainer=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(e){var t=e.showLoaderOnInit,r=jsx(Loader$1,{ref:createRef(this,"loader")});return jsx("div",{className:styles$g.root},t?r:null)}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({currentState:t.store.currentState})},autorunConfig)}},{key:"update",value:function(e){var t=e.currentState,r=t===LOADING$1||t===LAYER_LOADING||t===INITIALISING;r&&!this.refs.loader.isElementInDOM()?this.addElementToSelf(this.refs.loader.getElement()):!r&&this.refs.loader.isElementInDOM()&&this.refs.loader.remove()}}]),t}(),LoaderContainer$1=createFactory(LoaderContainer),styles$h={root:"styles_root__1CWL-",visible:"styles_visible__2g5qd",errorMessage:"styles_errorMessage__3eiyc"},ErrorMessage$1=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({errorMessage:t.store.errorMessage.message,isVisible:t.store.errorMessage.isVisible})},autorunConfig)}},{key:"root",value:function(){return jsx("div",{className:styles$h.root},jsx("div",{ref:createRef(this,"errorMessage")}))}},{key:"update",value:function(e){var t=e.errorMessage;e.isVisible?(this.element.classList.add(styles$h.visible),this.refs.errorMessage.getElement().classList.add(styles$h.errorMessage),this.refs.errorMessage.setTextContent(t)):(this.element.classList.remove(styles$h.visible),this.refs.errorMessage.getElement().classList.remove(styles$h.errorMessage),this.refs.errorMessage.setTextContent(""))}}]),t}(),ErrorMessage$2=createFactory(ErrorMessage$1),styles$i={root:"styles_root__33X8H"},isNotNull=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.some(function(e){return!!e||0===e})},Grid=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(){return jsx("div",{className:styles$i.root})}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({measurements:t.store.measurements,useGrid:t.store.useGrid})},autorunConfig)}},{key:"update",value:function(e){var t=e.measurements.aspectRatioPercent;e.useGrid&&isNotNull(t)?this.element.setAttribute("style",convertStyleMapToInlineStyles({display:"initial","background-size":"".concat(100*t,"px ").concat(100*t,"px")})):this.element.setAttribute("style",convertStyleMapToInlineStyles({display:"none"}))}}]),t}(),Grid$1=createFactory(Grid),styles$j={root:"styles_root__vQYBO",noPointer:"styles_noPointer__1UOqn"},OffsetContainer=function(){_inherits(t,Container);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"root",value:function(e){var t=e.children,r=e.allowPointer,i=void 0!==r&&r;return jsx("div",{className:classnames(styles$j.root,_defineProperty({},styles$j.noPointer,!i))},t)}},{key:"subscribe",value:function(e){var t=this;autorun(function(){return e({measurements:t.store.measurements,isFullScreen:t.store.isFullScreen})},autorunConfig)}},{key:"update",value:function(e){var t=e.measurements,r=t.xOffset,i=t.yOffset,n=t.aspectRatioPercent;isNotNull(r,i,n)&&this.element.setAttribute("style",convertStyleMapToInlineStyles({left:"".concat(r,"px"),right:"".concat(r,"px"),top:"".concat(i,"px"),bottom:"".concat(i,"px")}))}}]),t}(),OffsetContainer$1=createFactory(OffsetContainer),styles$k={videoContainer:"webplayer-styles_videoContainer__2mHcM",videoLayerElementContainer:"webplayer-styles_videoLayerElementContainer__1t0PF"},WebPlayer=function(){function t(e){_classCallCheck(this,t),this.element=this.root(e),e.ref(this)}return _createClass(t,[{key:"getRefs",value:function(){return this.refs}},{key:"getElement",value:function(){return this.element}},{key:"root",value:function(e){var t=e.store,r=e.eventListeners,i=e.muted,n=e.useVideo,a=e.usePoster,s=e.useLoader,o=e.useOverlayControls,l=e.disableAllControls,u=e.controlCapabilities,c=e.useErrorMessage,d=e.showLoaderOnInit,f=e.clientWidth,h=e.clientHeight,p=e.alwaysFillContainer;return jsx(VideoPlayerContainer$1,{store:t,ref:createRef(this,"videoPlayerContainer"),eventListeners:r.videoPlayerContainer,initialWidth:f,initialHeight:h,alwaysFillContainer:p},n&&jsx("div",{id:"videoContainer",className:styles$k.videoContainer},jsx(Video$1,{store:t,eventListeners:r.video,ref:createRef(this,"video"),muted:i})),jsx("div",{id:"videoLayerElementContainer",className:styles$k.videoLayerElementContainer}),!l&&o&&browserDetection.isMobileOrTablet&&jsx(OverlayControlsOverlay$1,{store:t}),jsx(OffsetContainer$1,{store:t,allowPointer:!0},a&&jsx(PosterContainer$1,{store:t,ref:createRef(this,"poster")}),jsx(LayerContainer$1,{store:t,eventListeners:r.layerContainer,linkEventListeners:r.link,triggerEventListeners:r.trigger,videoLayerElementContainerId:"videoLayerElementContainer",ref:createRef(this,"layerContainer")}),jsx(Grid$1,{store:t})),!l&&o&&browserDetection.isMobileOrTablet&&jsx(OverlayControls$1,{eventListeners:r.overlayControls,controlCapabilities:u,store:t}),s&&jsx(LoaderContainer$1,{showLoaderOnInit:d,store:t,eventListeners:r.loader}),!l&&jsx(Controls$2,{store:t,eventListeners:r.controls,controlCapabilities:u}),c&&jsx(OffsetContainer$1,{store:t},jsx(ErrorMessage$2,{ref:createRef(this,"errorMessage"),store:t})))}},{key:"update",value:function(e){var t=e.videos,r=e.videoPoster;this.refs.poster.setSrc(r),this.refs.video.clearClips(),this.refs.video.addClip(_objectSpread2({},t[0]));for(var i=1;i<t.length;i++)this.refs.video.addClip(_objectSpread2({},t[i]),"videoContainer");return this.refs.video}},{key:"addClip",value:function(e){this.refs.video.addClip(e,"videoContainer")}}]),t}(),WebPlayer$1=createFactory(WebPlayer);function calculateControlCapabilities(e){var t=!e,r=t?{}:e.reduce(function(e,t){return _objectSpread2(_objectSpread2({},e),{},_defineProperty({},t,!0))},{});return{allowPlay:t||r.play,allowMute:t||r.mute,allowTime:t||r.time,allowProgress:t||r.progress,allowSubtitles:t||r.subtitles,allowFS:t||r.fullscreen}}var createWebPlayer=function(e){var t,r=e.store,i=e.videoController,n=e.videoPlayerEngine,a=e.clientHeight,s=e.clientWidth,o=e.usePoster,l=e.useOverlayControls,u=e.allowedControls,c=e.useVideo,d=e.useErrorMessage,f=e.useLoader,h=e.projectId,p=e.muted,g=e.onElementClicked,m=e.createControlsEventListeners,y=e.createVideoEventListeners,v=e.createOverlayControlsEventListeners,b=e.createVideoPlayerContainerEventListeners,S=e.createLinkEventListeners,T=e.createTriggerEventListeners,_=e.createLayerContainerEventListeners,I=e.createLoaderEventListeners,M=e.eventCallbacks,A=void 0===M?{}:M,D={},w=u&&0==u.length,E=calculateControlCapabilities(u);return{element:jsx(WebPlayer$1,{clientHeight:a,clientWidth:s,store:r,usePoster:o,useOverlayControls:l,controlCapabilities:E,disableAllControls:w,useVideo:c,useLoader:f,useErrorMessage:d,showLoaderOnInit:!!h,muted:p,eventListeners:{video:c?y(_objectSpread2({store:r,videoController:i,videoPlayerEngine:n},A)):null,overlayControls:!w&&l?v({store:r,playerEngine:n,controlCapabilities:E}):null,controls:!w&&m({store:r,playerEngine:n}),videoPlayerContainer:b({store:r,playerEngine:n,disableAllControls:w,controlCapabilities:E}),link:S({store:r,playerEngine:n,onElementClicked:g}),trigger:T({store:r,playerEngine:n,onElementClicked:g}),layerContainer:_({store:r}),loader:I({store:r})},ref:createRef(D,"webPlayer")}),layerContainerRef:(t=(D=D.refs.webPlayer).getRefs()).layerContainer,videoPlayerContainerRef:t.videoPlayerContainer,videoRef:t.video,webPlayerRef:D}};window.ResizeObserver||ResizeObserver_3();var create=function(e){var g=e.store,m=e.loadingPromise,y=e.videoController,n=e.videoPlayerEngine,a=e.updateLayers,s=e.createVideoEventListeners,o=e.createControlsEventListeners,l=e.createOverlayControlsEventListeners,u=e.createVideoPlayerContainerEventListeners,c=e.createLinkEventListeners,d=e.createTriggerEventListeners,v=e.createLayerContainerEventListeners,b=e.createLoaderEventListeners,t=e.useOverlayControls,S=void 0===t||t,r=e.allowedControls,T=void 0===r?null:r,i=e.usePoster,_=void 0===i||i,f=e.useVideo,I=void 0===f||f,h=e.useLoader,M=void 0===h||h,p=e.useErrorMessage,A=void 0===p||p,D=e.enabledLayerIds,w=e.disabledLayerIds,E=e.projectId,C=e.onLoad,L=void 0===C?function(){}:C,O=e.onReady,N=void 0===O?function(){}:O,k=e.onElementClicked,x=void 0===k?function(){}:k,R=e.layers,j=e.projectJSON,P=e.duration,z=e.type,F=e.service,U=e.transformProjectJson,B=void 0===U?function(e){return e}:U,Y=e.muted,G=void 0!==Y&&Y,V=e.mobileLandscapeOnFullscreen,W=void 0!==V&&V,H=e.showSubtitles,$=void 0===H||H,Q=e.clientHeight,K=e.clientWidth,Z=e.serviceQueryParams,X=e.data,J=void 0===X?null:X;return new Promise(function(e){var t=createWebPlayer({store:g,videoController:y,videoPlayerEngine:n,clientHeight:Q,clientWidth:K,usePoster:_,useOverlayControls:S,allowedControls:T,useVideo:I,useErrorMessage:A,useLoader:M,projectId:E,muted:G,onElementClicked:x,createControlsEventListeners:o,createVideoEventListeners:s,createOverlayControlsEventListeners:l,createVideoPlayerContainerEventListeners:u,createLinkEventListeners:c,createTriggerEventListeners:d,createLayerContainerEventListeners:v,createLoaderEventListeners:b,eventCallbacks:{onReady:N}}),r=t.element,i=t.layerContainerRef,f=t.videoPlayerContainerRef,h=t.webPlayerRef,p=t.videoRef;E||j?fetchProject({service:F,projectId:E,preloadedProjectJSON:j,clientHeight:Q,clientWidth:K,transformProjectJson:B,serviceQueryParams:Z,data:J}).then(function(e){var n=e.videoPoster,a=e.videos,s=e.videoStartOffsetTime,o=e.videoEndOffsetTime,l=e.mappedLayers,t=e.projectJson,r=e.projectName,u=e.projectDuration,c=e.bumperBeginTime,d=e.displaySubtitlesButton;!function(){if(I){var e=a.reduce(function(e,t){return e+t.duration},0);y.setProps({startOffsetTime:s,endOffsetTime:o,video:p,videoDurationFromJson:e})}else y.setProps({startOffsetTime:s});var i=loadAssets({service:F,imageMapFromStore:g.imageMap,fontMapFromStore:g.fontMap,projectJson:t});i.promise.then(function(e){var t=e.imageMap,r=e.fontMap;g.init({state:INITIALISING,videoStartOffsetTime:s,videoEndOffsetTime:o,enabledLayerIds:D,disabledLayerIds:w,layersJson:l,video:p,videoPlayerContainer:f,duration:u,imageMap:i.imageMap,fontMap:i.fontMap,bumperBeginTime:c,clientWidth:K,clientHeight:Q,muted:G,mobileLandscapeOnFullscreen:W,showSubtitles:$,displaySubtitlesButton:d}),g.update({imageMap:t,hasImageMapLoaded:!0,fontMap:r,hasFontMapLoaded:!0}),h.update({videoPoster:n,videos:a}),m.resolve()}),L({projectName:r})}()}).catch(function(e){console.error("The video could not be loaded",e),g.init({state:LOADING_ERROR,isFullScreen:!1,startTime:0,currentTime:0,videoPlayerContainer:f,errorMessage:"The video could not be loaded",clientHeight:Q,clientWidth:K,muted:G,mobileLandscapeOnFullscreen:W,showSubtitles:$,displaySubtitlesButton:!1})}):R?(m.resolve(),g.init({videoPlayerContainer:f,videoState:NOT_USED,state:READY,muted:G,mobileLandscapeOnFullscreen:W,showSubtitles:$,displaySubtitlesButton:!1}),a({layers:R,duration:P,type:z})):(m.resolve(),g.init({videoPlayerContainer:f,clientHeight:Q,clientWidth:K,muted:G,mobileLandscapeOnFullscreen:W,showSubtitles:$,displaySubtitlesButton:!1})),e({element:r,videoPlayerContainerRef:f,layerContainerRef:i,videoRef:p,webPlayerRef:h})})};function performLayerUpdate(e,t,i,r,n,a,s,o){var l=o||i.currentTime,u=i.state===PLAYING;i.state!==INITIALISING&&n.getActions().pause();var c=a?replaceTokensWithData(e,a):e;u&&(t.fontsLoading||t.imagesLoading)&&i.update({state:LOADING$1,hasImageMapLoaded:!1,hasFontMapLoaded:!1}),t.promise.then(function(e){var t=e.imageMap,r=e.fontMap;i.update({state:READY,imageMap:t,hasImageMapLoaded:!0,fontMap:r,hasFontMapLoaded:!0,layersJson:c,duration:s}),n.getActions().setCurrentTime(l),u&&n.getActions().play()})}function mapVideoLayers(e){return e.map(function(e){return{src:e.elements[0].url,srcHLS:e.elements[0].url_hls,duration:e.elements[0].duration,videoClipStart:e.elements[0].beginTime,startTime:e.elements[0].absoluteLayerBeginTime,endTime:e.elements[0].absoluteLayerEndTime}})}function nudgeBumper(e,t){var r=e.duration===t?null:e.absoluteBumperBeginTime-(e.duration-t),i=r-e.absoluteBumperBeginTime,n=null;r&&(e.update({bumperBeginTime:r}),n=e.layersJson.find(function(e){return"company_bumper"===e.layerType}));var a=e.layersJson.filter(function(e){return!n||"company_bumper"!==e.layerType});return n&&a.push(_objectSpread2(_objectSpread2({},n),{},{beginTime:n.beginTime+i,elements:n.elements.map(function(e){return _objectSpread2(_objectSpread2({},e),{},{absoluteBeginTime:e.absoluteBeginTime+i,absoluteEndTime:e.absoluteEndTime+i})})})),a}var addLayers=function(e){var f=e.store,h=e.service,p=e.videoPlayerEngine,g=e.data,m=e.webPlayerRef;return function(e){var t=e.layers,r=(e.type,e.data),i=void 0===r?null:r,n=(f.layersJson,f.measurements),a=n.clientWidth,s=n.clientHeight,o=loadAssets({service:h,imageMapFromStore:f.imageMap,fontMapFromStore:f.fontMap,projectJson:t}),l=mapVideoLayers(t.filter(function(e){return"video"===e.layerType})),u=f.duration+l.reduce(function(e,t){return e+t.duration},0);l.forEach(function(e){return m.addClip(e)});var c=t.filter(function(e){return"video"!==e.layerType}),d=nudgeBumper(f,u);performLayerUpdate([].concat(_toConsumableArray(d),_toConsumableArray(c.map(function(e,t){return _objectSpread2(_objectSpread2({},e),{},{elements:mapLayers(d.length+t)(a,s,e.layerType,e.elements)})}))),o,f,h,p,i||g,u)}},replaceLayers=function(e){var _=e.store,I=e.service,M=e.videoPlayerEngine,A=e.videoController,D=e.data,w=e.webPlayerRef;return function(e){var t=e.layers,r=(e.type,e.data),i=void 0===r?null:r,n=e.duration,a=void 0===n?27:n,s=(_.layersJson,t.filter(function(e){return"video"!==e.layerType})),o=_.measurements,l=o.clientWidth,u=o.clientHeight,c=loadAssets({service:I,imageMapFromStore:_.imageMap,fontMapFromStore:_.fontMap,projectJson:t}),d=_toConsumableArray(s.map(function(e,t){return _objectSpread2(_objectSpread2({},e),{},{elements:mapLayers(t)(l,u,e.layerType,e.elements),states:mapStateElements(l,u,e,mapLayers(t))})})),f=_.currentTime,h=t.filter(function(e){return"video"===e.layerType}),p=mapVideoLayers(h),g=h[0].elements[0].clip_thumbnail_url,m=d.find(function(e){return"company_bumper"===e.layerType}),y=d.find(function(e){return"company_opener"===e.layerType}),v=y?y.duration:0;_.update({bumperBeginTime:m?m.beginTime:a,projectDuration:a,videoStartOffsetTime:v}),_.layerStates.reset();var b=w.update({videoPoster:g,videos:p});A.setProps({startOffsetTime:v,endOffsetTime:m?m.duration:0,video:b,videoDurationFromJson:a});var S=d.filter(function(e){return!!e.elements.find(function(e){return"video"===e.type})}),T=d.filter(function(e){return void 0===e.elements.find(function(e){return"video"===e.type})});mapVideosToBlobs(S).then(function(e){performLayerUpdate([].concat(_toConsumableArray(T),_toConsumableArray(e)),c,_,I,M,i||D,a,f)})}},updateLayers=function(e){var d=e.store,r=e.loadingPromise,f=e.dimensions,h=e.service,p=e.videoPlayerEngine;return function(e){var l=e.duration,u=e.layers,t=e.type,c=void 0===t?"default":t;r.promise.then(function(){var e=d.currentTime,t=d.duration,r=d.currentTime,i=l||t;i<e&&(e=i);var n=[],a={};if(u){var s=[{newDuration:i,layerType:c,elements:u.map(function(e){return _objectSpread2(_objectSpread2({},e),{},{absoluteLayerBeginTime:0,absoluteLayerEndTime:i})})}];n=[_objectSpread2(_objectSpread2({},s[0]),{},{elements:mapLayers(0)(f.clientWidth,f.clientHeight,c,s[0].elements)})];var o=loadAssets({service:h,imageMapFromStore:d.imageMap,fontMapFromStore:d.fontMap,projectJson:s});a={imageMap:o.imageMap,fontMap:o.fontMap},o.promise.then(function(e){var t=e.imageMap,r=e.fontMap;d.update({state:READY,imageMap:t,hasImageMapLoaded:!0,fontMap:r,hasFontMapLoaded:!0})})}d.update(_objectSpread2(_objectSpread2({layersJson:u?n:null,state:u?INITIALISING:READY},f),{},{duration:i},a)),r!==e&&p.getActions().updateCurrentTime(e)})}};window.ResizeObserver||ResizeObserver_3();var getElement=function(e){return"string"==typeof e?document.getElementById(e):e},measureAttachToComponent=function(e){var t=getElement(e).clientWidth;return{clientWidth:t,clientHeight:t/16*9}},createPlayer=function(e){var t=e.projectId,r=e.useOverlayControls,i=void 0===r||r,n=e.usePoster,a=void 0===n||n,s=e.useVideo,u=void 0===s||s,o=e.useLoader,c=void 0===o||o,l=e.useErrorMessage,d=void 0===l||l,f=e.disabledLayerIds,h=e.enabledLayerIds,p=e.attachTo,g=e.useGrid,m=void 0!==g&&g,y=e.logStateChange,v=void 0!==y&&y,b=e.autoLoop,S=void 0!==b&&b,T=e.showMouseCoords,_=void 0!==T&&T,I=e.useTimeInMillis,M=void 0!==I&&I,A=e.controlsAlwaysOn,D=void 0!==A&&A,w=e.allowedControls,E=void 0===w?null:w,C=e.onLoad,L=void 0===C?function(){}:C,O=e.onPlay,N=void 0===O?function(){return null}:O,k=e.onPause,x=void 0===k?function(){return null}:k,R=e.onVideoEnd,j=void 0===R?function(){return null}:R,P=e.onProgress,z=void 0===P?function(){return null}:P,F=e.onFullScreenToggle,U=void 0===F?function(){return null}:F,B=e.onReady,Y=void 0===B?function(){return null}:B,G=e.onElementClicked,V=void 0===G?function(){return null}:G,W=e.progressInterval,H=void 0===W?3:W,$=e.layers,Q=e.projectJSON,K=e.videoBackgroundColour,Z=e.duration,X=e.type,J=e.service,q=e.transformProjectJson,ee=void 0===q?function(e){return e}:q,te=e.showSubtitles,re=void 0===te||te,ie=e.muted,ne=void 0!==ie&&ie,ae=e.mobileLandscapeOnFullscreen,se=void 0!==ae&&ae,oe=e.assetUrl,le=void 0===oe?null:oe,ue=e.serverUrl,ce=void 0===ue?null:ue,de=e.useVideoPlayerEnginerLogger,fe=void 0!==de&&de,he=e.serviceQueryParams,pe=void 0===he?{}:he,ge=e.data,me=void 0===ge?null:ge,ye=e.useKeyboardEvents,ve=void 0===ye||ye,be=createVideoController(j),Se=createVideoPlayerEngine(),Te=new RootStore,_e=measureAttachToComponent(p);window.assetUrl=le,window.serverUrl=ce;var Ie=eventListeners(),Me=Ie.createWindowEventListeners,Ae=_objectWithoutProperties(Ie,["createWindowEventListeners"]),De=createLoadingPromise(),we=updateLayers({store:Te,loadingPromise:De,dimensions:_e,service:J,videoPlayerEngine:Se}),Ee=actions({store:Te,videoController:be});return new Promise(function(l){create(_objectSpread2(_objectSpread2(_objectSpread2({projectId:t,useOverlayControls:i,allowedControls:E,usePoster:a,useVideo:u,useLoader:c,useErrorMessage:d,enabledLayerIds:h,disabledLayerIds:f,autoLoop:S,onLoad:L,onReady:Y,onElementClicked:V,layers:$,projectJSON:Q,videoBackgroundColour:K,duration:Z,type:X,service:J,transformProjectJson:ee,muted:ne,mobileLandscapeOnFullscreen:se,showSubtitles:re,store:Te,videoController:be,videoPlayerEngine:Se,loadingPromise:De,updateLayers:we},_e),Ae),{},{serviceQueryParams:pe,data:me})).then(function(e){var t=e.videoPlayerContainerRef,r=e.videoRef,i=e.layerContainerRef,n=e.element,a=e.webPlayerRef,s=replaceLayers({loadingPromise:De,store:Te,service:J,videoPlayerEngine:Se,videoController:be,data:me,webPlayerRef:a}),o=addLayers({loadingPromise:De,store:Te,service:J,videoPlayerEngine:Se,data:me,webPlayerRef:a});addEventListeners(window,Me({videoPlayerContainer:t,videoController:be,videoPlayerEngine:Se,store:Te,useKeyboardEvents:ve})),Se.setProps({onPlay:N,onPause:x,onProgress:z,onFullScreenToggle:U,progressInterval:H,store:Te,videoController:be,layerContainer:i,videoPlayerContainer:t,useLogger:fe}),p&&attachToDOM(p,n),u||Te.updateMeasurements({}),Ee.updateDevOptions({controlsAlwaysOn:D,logStateChange:v,videoBackgroundColour:K,autoLoop:S,showMouseCoords:_,useGrid:m,useTimeInMillis:M}),l({updateLayers:we,addLayers:o,replaceLayers:s,storeActions:Ee,getVideoActions:Se.getActions,remove:function(){r&&r.clear(),n.remove();var e=new Event("removeAllPlayerEvents");window.dispatchEvent(e)}})})})};module.exports=createPlayer;

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
'use strict';
// For more information about browser field, check out the browser field at https://github.com/substack/browserify-handbook#browser-field.

var styleElementsInsertedAtTop = [];

var insertStyleElement = function(styleElement, options) {
    var head = document.head || document.getElementsByTagName('head')[0];
    var lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];

    options = options || {};
    options.insertAt = options.insertAt || 'bottom';

    if (options.insertAt === 'top') {
        if (!lastStyleElementInsertedAtTop) {
            head.insertBefore(styleElement, head.firstChild);
        } else if (lastStyleElementInsertedAtTop.nextSibling) {
            head.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);
        } else {
            head.appendChild(styleElement);
        }
        styleElementsInsertedAtTop.push(styleElement);
    } else if (options.insertAt === 'bottom') {
        head.appendChild(styleElement);
    } else {
        throw new Error('Invalid value for parameter \'insertAt\'. Must be \'top\' or \'bottom\'.');
    }
};

module.exports = {
    // Create a <link> tag with optional data attributes
    createLink: function(href, attributes) {
        var head = document.head || document.getElementsByTagName('head')[0];
        var link = document.createElement('link');

        link.href = href;
        link.rel = 'stylesheet';

        for (var key in attributes) {
            if ( ! attributes.hasOwnProperty(key)) {
                continue;
            }
            var value = attributes[key];
            link.setAttribute('data-' + key, value);
        }

        head.appendChild(link);
    },
    // Create a <style> tag with optional data attributes
    createStyle: function(cssText, attributes, extraOptions) {
        extraOptions = extraOptions || {};

        var style = document.createElement('style');
        style.type = 'text/css';

        for (var key in attributes) {
            if ( ! attributes.hasOwnProperty(key)) {
                continue;
            }
            var value = attributes[key];
            style.setAttribute('data-' + key, value);
        }

        if (style.sheet) { // for jsdom and IE9+
            style.innerHTML = cssText;
            style.sheet.cssText = cssText;
            insertStyleElement(style, { insertAt: extraOptions.insertAt });
        } else if (style.styleSheet) { // for IE8 and below
            insertStyleElement(style, { insertAt: extraOptions.insertAt });
            style.styleSheet.cssText = cssText;
        } else { // for Chrome, Firefox, and Safari
            style.appendChild(document.createTextNode(cssText));
            insertStyleElement(style, { insertAt: extraOptions.insertAt });
        }
    }
};

},{}]},{},[1]);
